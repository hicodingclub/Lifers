/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component } from '@angular/core';
import { Router, ActivatedRoute } from '@angular/router';
import { FormBuilder, Validators } from '@angular/forms';
import { first } from 'rxjs/operators';
import { AuthenticationService } from '../auth.service';
/** @type {?} */
const validatePasswords = function (form) {
    /** @type {?} */
    const passwordConf = form.controls.password_conf.value;
    /** @type {?} */
    const password = form.controls.password.value;
    if (passwordConf === password) {
        return null;
    }
    else {
        form.controls.password_conf.setErrors({ 'passwordNotSame': true });
        return null;
    }
};
const ɵ0 = validatePasswords;
export class RegisterComponent {
    /**
     * @param {?} formBuilder
     * @param {?} router
     * @param {?} route
     * @param {?} authenticationService
     */
    constructor(formBuilder, router, route, authenticationService) {
        this.formBuilder = formBuilder;
        this.router = router;
        this.route = route;
        this.authenticationService = authenticationService;
        this.loading = false;
        this.submitted = false;
        this.servererror = false;
        this.serverText = '';
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.registerForm = this.formBuilder.group({
            username: ['', Validators.required],
            password: ['', [Validators.required, Validators.minLength(6)]],
            password_conf: ['', [Validators.required, Validators.minLength(6)]]
        }, { validator: validatePasswords });
    }
    // convenience getter for easy access to form fields
    /**
     * @return {?}
     */
    get f() { return this.registerForm.controls; }
    /**
     * @return {?}
     */
    onSubmit() {
        this.submitted = true;
        // stop here if form is invalid
        if (this.registerForm.invalid) {
            return;
        }
        this.loading = true;
        this.authenticationService.register(this.registerForm.value)
            .pipe(first())
            .subscribe(data => {
            // this.alertService.success('Registration successful', true);
            this.router.navigate(['../login'], { relativeTo: this.route, });
            this.servererror = false;
        }, error => {
            // this.alertService.error(error);
            // alert("Error login");
            this.servererror = true;
            this.serverText = error.error.error;
            this.loading = false;
        });
    }
    /**
     * @return {?}
     */
    cancel() {
        /** @type {?} */
        const routedFromUrl = this.authenticationService.getRoutedFromUrl();
        this.router.navigate([routedFromUrl]);
    }
}
RegisterComponent.decorators = [
    { type: Component, args: [{ template: "<h2>Register</h2>\n<form [formGroup]=\"registerForm\" (ngSubmit)=\"onSubmit()\">\n    <div class=\"form-group\">\n        <label for=\"username\">Username</label>\n        <input type=\"text\" formControlName=\"username\" class=\"form-control\" [ngClass]=\"{ 'is-invalid': submitted && f.username.errors }\" />\n        <div *ngIf=\"submitted && f.username.errors\" class=\"invalid-feedback\">\n            <div *ngIf=\"f.username.errors.required\">Username is required</div>\n        </div>\n    </div>\n    <div class=\"form-group\">\n        <label for=\"password\">Password</label>\n        <input type=\"password\" formControlName=\"password\" class=\"form-control\" [ngClass]=\"{ 'is-invalid': submitted && f.password.errors }\" />\n        <div *ngIf=\"submitted && f.password.errors\" class=\"invalid-feedback\">\n            <div *ngIf=\"f.password.errors.required\">Password is required</div>\n            <div *ngIf=\"f.password.errors.minlength\">Password must be at least 6 characters</div>\n        </div>\n    </div>\n    <div class=\"form-group\">\n        <label for=\"password_conf\">Confirm Password</label>\n        <input type=\"password\" formControlName=\"password_conf\" class=\"form-control\" [ngClass]=\"{ 'is-invalid': submitted && f.password_conf.errors }\" />\n        <div *ngIf=\"submitted && f.password_conf.errors\" class=\"invalid-feedback\">\n            <div *ngIf=\"f.password_conf.errors.required\">Password is required</div>\n            <div *ngIf=\"f.password_conf.errors.minlength\">Password must be at least 6 characters</div>\n            <div *ngIf=\"f.password_conf.errors.passwordNotSame\">Password doesn't match.</div>\n        </div>\n    </div>\n    <div class=\"form-group\">\n        <button [disabled]=\"loading\" class=\"btn btn-primary\">Register</button>\n        <img *ngIf=\"loading\" src=\"data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==\" />\n\n        <a [routerLink]=\"['../login']\" class=\"btn btn-link\">Login</a>\n        <button (click)=\"cancel()\" class=\"btn btn-link float-right\">Cancel</button>\n    </div>\n    <div *ngIf=\"servererror\" style=\"display: block;\" class=\"invalid-feedback\">\n  \t\t{{serverText}}\n    </div>\n</form>\n", styles: [".invalid-feedback{width:100%;margin-top:.25rem;font-size:80%;color:#dc3545}"] }] }
];
/** @nocollapse */
RegisterComponent.ctorParameters = () => [
    { type: FormBuilder },
    { type: Router },
    { type: ActivatedRoute },
    { type: AuthenticationService }
];
if (false) {
    /** @type {?} */
    RegisterComponent.prototype.registerForm;
    /** @type {?} */
    RegisterComponent.prototype.loading;
    /** @type {?} */
    RegisterComponent.prototype.submitted;
    /** @type {?} */
    RegisterComponent.prototype.servererror;
    /** @type {?} */
    RegisterComponent.prototype.serverText;
    /**
     * @type {?}
     * @private
     */
    RegisterComponent.prototype.formBuilder;
    /**
     * @type {?}
     * @private
     */
    RegisterComponent.prototype.router;
    /**
     * @type {?}
     * @private
     */
    RegisterComponent.prototype.route;
    /**
     * @type {?}
     * @private
     */
    RegisterComponent.prototype.authenticationService;
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbWRkcy1hbmd1bGFyLWF1dGgvIiwic291cmNlcyI6WyJhdXRoL3JlZ2lzdGVyL3JlZ2lzdGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxNQUFNLGVBQWUsQ0FBQztBQUNsRCxPQUFPLEVBQUUsTUFBTSxFQUFFLGNBQWMsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3pELE9BQU8sRUFBRSxXQUFXLEVBQWEsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXZDLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDOztNQUVsRCxpQkFBaUIsR0FBRyxVQUFTLElBQUk7O1VBQzdCLFlBQVksR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLOztVQUNoRCxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsS0FBSztJQUU3QyxJQUFJLFlBQVksS0FBSyxRQUFRLEVBQUU7UUFDM0IsT0FBTyxJQUFJLENBQUM7S0FDZjtTQUFNO1FBQ0gsSUFBSSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLEVBQUMsaUJBQWlCLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNqRSxPQUFPLElBQUksQ0FBQztLQUNmO0FBQ0wsQ0FBQzs7QUFNRCxNQUFNLE9BQU8saUJBQWlCOzs7Ozs7O0lBTzFCLFlBQ1ksV0FBd0IsRUFDeEIsTUFBYyxFQUNkLEtBQXFCLEVBQ3JCLHFCQUE0QztRQUg1QyxnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4QixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsVUFBSyxHQUFMLEtBQUssQ0FBZ0I7UUFDckIsMEJBQXFCLEdBQXJCLHFCQUFxQixDQUF1QjtRQVR4RCxZQUFPLEdBQUcsS0FBSyxDQUFDO1FBQ2hCLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFDbEIsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFDcEIsZUFBVSxHQUFHLEVBQUUsQ0FBQztJQU00QyxDQUFDOzs7O0lBRzdELFFBQVE7UUFDSixJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDO1lBQ3ZDLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxVQUFVLENBQUMsUUFBUSxDQUFDO1lBQ25DLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlELGFBQWEsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3RFLEVBQUUsRUFBQyxTQUFTLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyxDQUFDO0lBQ3hDLENBQUM7Ozs7O0lBR0QsSUFBSSxDQUFDLEtBQUssT0FBTyxJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7Ozs7SUFFOUMsUUFBUTtRQUNKLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBRXRCLCtCQUErQjtRQUMvQixJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsT0FBTyxFQUFFO1lBQzNCLE9BQU87U0FDVjtRQUVELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUM7YUFDdkQsSUFBSSxDQUFDLEtBQUssRUFBRSxDQUFDO2FBQ2IsU0FBUyxDQUNOLElBQUksQ0FBQyxFQUFFO1lBQ0gsOERBQThEO1lBQzlELElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsVUFBVSxDQUFDLEVBQUUsRUFBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7WUFDL0QsSUFBSSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7UUFDN0IsQ0FBQyxFQUNELEtBQUssQ0FBQyxFQUFFO1lBQ0osa0NBQWtDO1lBQ2xDLHdCQUF3QjtZQUN4QixJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztZQUN4QixJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDO1lBQ3BDLElBQUksQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLENBQUMsQ0FBQyxDQUFDO0lBQ2YsQ0FBQzs7OztJQUNELE1BQU07O2NBQ0UsYUFBYSxHQUFHLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxnQkFBZ0IsRUFBRTtRQUNuRSxJQUFJLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7SUFDeEMsQ0FBQzs7O1lBekRKLFNBQVMsU0FDTixFQUFDLHloR0FBc0MsMkZBRXRDOzs7O1lBcEJJLFdBQVc7WUFEWCxNQUFNO1lBQUUsY0FBYztZQUl0QixxQkFBcUI7Ozs7SUFtQjFCLHlDQUF3Qjs7SUFDeEIsb0NBQWdCOztJQUNoQixzQ0FBa0I7O0lBQ2xCLHdDQUFvQjs7SUFDcEIsdUNBQWdCOzs7OztJQUdaLHdDQUFnQzs7Ozs7SUFDaEMsbUNBQXNCOzs7OztJQUN0QixrQ0FBNkI7Ozs7O0lBQzdCLGtEQUFvRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBSb3V0ZXIsIEFjdGl2YXRlZFJvdXRlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IEZvcm1CdWlsZGVyLCBGb3JtR3JvdXAsIFZhbGlkYXRvcnMgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBmaXJzdCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgQXV0aGVudGljYXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vYXV0aC5zZXJ2aWNlJztcblxuY29uc3QgdmFsaWRhdGVQYXNzd29yZHMgPSBmdW5jdGlvbihmb3JtKSB7XG4gICAgY29uc3QgcGFzc3dvcmRDb25mID0gZm9ybS5jb250cm9scy5wYXNzd29yZF9jb25mLnZhbHVlO1xuICAgIGNvbnN0IHBhc3N3b3JkID0gZm9ybS5jb250cm9scy5wYXNzd29yZC52YWx1ZTtcblxuICAgIGlmIChwYXNzd29yZENvbmYgPT09IHBhc3N3b3JkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcm0uY29udHJvbHMucGFzc3dvcmRfY29uZi5zZXRFcnJvcnMoeydwYXNzd29yZE5vdFNhbWUnOiB0cnVlfSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn07XG5cbkBDb21wb25lbnQoXG4gICAge3RlbXBsYXRlVXJsOiAncmVnaXN0ZXIuY29tcG9uZW50Lmh0bWwnLFxuICAgICBzdHlsZVVybHM6IFsncmVnaXN0ZXIuY29tcG9uZW50LmNzcyddXG4gICAgfSlcbmV4cG9ydCBjbGFzcyBSZWdpc3RlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gICAgcmVnaXN0ZXJGb3JtOiBGb3JtR3JvdXA7XG4gICAgbG9hZGluZyA9IGZhbHNlO1xuICAgIHN1Ym1pdHRlZCA9IGZhbHNlO1xuICAgIHNlcnZlcmVycm9yID0gZmFsc2U7XG4gICAgc2VydmVyVGV4dCA9ICcnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyLFxuICAgICAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxuICAgICAgICBwcml2YXRlIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICAgICAgcHJpdmF0ZSBhdXRoZW50aWNhdGlvblNlcnZpY2U6IEF1dGhlbnRpY2F0aW9uU2VydmljZSkgeyB9XG5cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnJlZ2lzdGVyRm9ybSA9IHRoaXMuZm9ybUJ1aWxkZXIuZ3JvdXAoe1xuICAgICAgICAgICAgdXNlcm5hbWU6IFsnJywgVmFsaWRhdG9ycy5yZXF1aXJlZF0sXG4gICAgICAgICAgICBwYXNzd29yZDogWycnLCBbVmFsaWRhdG9ycy5yZXF1aXJlZCwgVmFsaWRhdG9ycy5taW5MZW5ndGgoNildXSxcbiAgICAgICAgICAgIHBhc3N3b3JkX2NvbmY6IFsnJywgW1ZhbGlkYXRvcnMucmVxdWlyZWQsIFZhbGlkYXRvcnMubWluTGVuZ3RoKDYpXV1cbiAgICAgICAgfSwge3ZhbGlkYXRvcjogdmFsaWRhdGVQYXNzd29yZHMgfSk7XG4gICAgfVxuXG4gICAgLy8gY29udmVuaWVuY2UgZ2V0dGVyIGZvciBlYXN5IGFjY2VzcyB0byBmb3JtIGZpZWxkc1xuICAgIGdldCBmKCkgeyByZXR1cm4gdGhpcy5yZWdpc3RlckZvcm0uY29udHJvbHM7IH1cblxuICAgIG9uU3VibWl0KCkge1xuICAgICAgICB0aGlzLnN1Ym1pdHRlZCA9IHRydWU7XG5cbiAgICAgICAgLy8gc3RvcCBoZXJlIGlmIGZvcm0gaXMgaW52YWxpZFxuICAgICAgICBpZiAodGhpcy5yZWdpc3RlckZvcm0uaW52YWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5hdXRoZW50aWNhdGlvblNlcnZpY2UucmVnaXN0ZXIodGhpcy5yZWdpc3RlckZvcm0udmFsdWUpXG4gICAgICAgICAgICAucGlwZShmaXJzdCgpKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICBkYXRhID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5hbGVydFNlcnZpY2Uuc3VjY2VzcygnUmVnaXN0cmF0aW9uIHN1Y2Nlc3NmdWwnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuLi9sb2dpbiddLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZSwgfSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VydmVyZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5hbGVydFNlcnZpY2UuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAvLyBhbGVydChcIkVycm9yIGxvZ2luXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlcnZlcmVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXJ2ZXJUZXh0ID0gZXJyb3IuZXJyb3IuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICBjYW5jZWwoKSB7XG4gICAgICBjb25zdCByb3V0ZWRGcm9tVXJsID0gdGhpcy5hdXRoZW50aWNhdGlvblNlcnZpY2UuZ2V0Um91dGVkRnJvbVVybCgpO1xuICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3JvdXRlZEZyb21VcmxdKTtcbiAgICB9XG59XG4iXX0=