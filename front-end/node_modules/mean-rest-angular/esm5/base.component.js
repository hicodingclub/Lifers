/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { EventEmitter } from '@angular/core';
import { Modal } from './util.modal';
import { SnackBar } from './util.snackbar';
import { ErrorToast } from './util.errortoast';
import { ServiceError } from './base.service';
import { MraCommonService } from './common.service';
import { Util } from './util.tools';
/** @enum {number} */
var ViewType = {
    LIST: 0,
    DETAIL: 1,
    EDIT: 2,
};
export { ViewType };
ViewType[ViewType.LIST] = 'LIST';
ViewType[ViewType.DETAIL] = 'DETAIL';
ViewType[ViewType.EDIT] = 'EDIT';
export { ServiceError };
var BaseComponent = /** @class */ (function () {
    function BaseComponent(service, injector, router, route, location, view, itemCamelName) {
        this.service = service;
        this.injector = injector;
        this.router = router;
        this.route = route;
        this.location = location;
        this.view = view;
        this.itemCamelName = itemCamelName;
        this.objectKeys = Object.keys;
        this.storage = {};
        //For list and pagination
        this.list = [];
        this.majorUi = true;
        this.eventEmitter = new EventEmitter();
        this.page = 1;
        this.per_page = 25;
        this.total_count = 0;
        this.total_pages = 0;
        this.pages = [];
        this.left_more = false;
        this.right_more = false;
        this.checkAll = false;
        //used to mark deleted items, or items that will show sub-detail, etc.
        this.checkedItem = [];
        //For edit and view details
        this.detail = {};
        this._detail = {}; //a clone and used to send/receive from next work
        //a clone and used to send/receive from next work
        this._extra = {}; //extra info.
        this.subEdit = false; //a edit-sub component
        //a edit-sub component
        //for fields with enum values
        this.enums = {};
        this.stringFields = [];
        this.referenceFields = [];
        this.referenceFieldsMap = {};
        this.dateFields = [];
        this.indexFields = [];
        this.multiSelectionFields = [];
        this.arrayFields = []; //element is [fieldName, elementType]
        //element is [fieldName, elementType]
        this.mapFields = []; //element is [fieldName, elementType, mapKey]
        //element is [fieldName, elementType, mapKey]
        this.dateFormat = "MM/DD/YYYY";
        this.timeFormat = "hh:mm:ss";
        this.hiddenFields = []; //fields hide from view. Currrently used by "Add" view of edit-sub
        this.refreshing = false;
        this.clickedId = null;
        this.selectedId = null;
        this.moreSearchOpened = false;
        //type of QueryList<T>
        this.textEditorMap = {};
        /**
         * Any View - add new component in the current view
         */
        this.isAdding = false;
        this.ItemCamelName = itemCamelName.charAt(0).toUpperCase() + itemCamelName.substr(1);
        this.itemName = itemCamelName.toLowerCase();
        this.parentItem = this.getParentRouteItem();
        this.commonService = injector.get(MraCommonService);
    }
    /**
     * @protected
     * @param {?} error
     * @return {?}
     */
    BaseComponent.prototype.onServiceError = /**
     * @protected
     * @param {?} error
     * @return {?}
     */
    function (error) {
        //clear any pending flags
        this.refreshing = false;
        /** @type {?} */
        var errMsg;
        /** @type {?} */
        var more;
        if (error.clientErrorMsg) {
            errMsg = error.clientErrorMsg;
        }
        else if (error.serverError) {
            if (error.status == 401)
                return; //Don't show unauthorized error
            if (typeof error.serverError === 'object') {
                errMsg = error.status + ": " + JSON.stringify(error.serverError);
            }
            else {
                errMsg = error.status + ": " + error.serverError;
            }
        }
        console.info("Error: " + errMsg);
        if (!errMsg)
            errMsg = "Unknown error.";
        if (errMsg.length > 80) {
            more = errMsg;
            errMsg = errMsg.substring(0, 80) + "...";
        }
        /** @type {?} */
        var errorToastConfig = {
            content: errMsg,
            more: more
        };
        /** @type {?} */
        var errorToast = new ErrorToast(errorToastConfig);
        errorToast.show();
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.populatePages = /**
     * @protected
     * @return {?}
     */
    function () {
        this.pages = [];
        /** @type {?} */
        var SHOW_PAGE = 9;
        /** @type {?} */
        var HALF = (SHOW_PAGE - 1) / 2;
        /** @type {?} */
        var min;
        /** @type {?} */
        var max;
        if (this.total_pages <= SHOW_PAGE) {
            min = 1;
            max = this.total_pages;
            this.left_more = false;
            this.right_more = false;
        }
        else {
            if (this.page - 1 < HALF) {
                min = 1;
                max = SHOW_PAGE - 1;
                this.left_more = false;
                this.right_more = true;
            }
            else if (this.total_pages - this.page < HALF) {
                max = this.total_pages;
                min = (this.total_pages - SHOW_PAGE + 1) + 1;
                this.left_more = true;
                this.right_more = false;
            }
            else {
                min = this.page - HALF + 1;
                max = this.page + HALF - 1;
                this.left_more = true;
                this.right_more = true;
            }
        }
        for (var i = min; i <= max; i++) {
            this.pages.push(i);
        }
    };
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    BaseComponent.prototype.getKey = /**
     * @private
     * @param {?} key
     * @return {?}
     */
    function (key) {
        /** @type {?} */
        var url = this.router.url.split(';')[0].split('?')[0];
        return url + ":" + key;
    };
    /**
     * @private
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    BaseComponent.prototype.putToStorage = /**
     * @private
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    function (key, value) {
        if (this.majorUi) {
            //only major UI we want to cache and recover when user comes back
            this.commonService.putToStorage(this.getKey(key), value);
        }
        else {
            this.storage[key] = value;
        }
    };
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    BaseComponent.prototype.getFromStorage = /**
     * @private
     * @param {?} key
     * @return {?}
     */
    function (key) {
        if (this.majorUi) {
            return this.commonService.getFromStorage(this.getKey(key));
        }
        else {
            return this.storage[key];
        }
    };
    /**
     * @private
     * @param {?} page
     * @return {?}
     */
    BaseComponent.prototype.routeToPage = /**
     * @private
     * @param {?} page
     * @return {?}
     */
    function (page) {
        this.putToStorage("page", page);
        this.populateList();
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.onNextPage = /**
     * @protected
     * @return {?}
     */
    function () {
        if (this.page >= this.total_pages)
            return;
        this.routeToPage(this.page + 1);
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.onPreviousPage = /**
     * @protected
     * @return {?}
     */
    function () {
        if (this.page <= 1)
            return;
        this.routeToPage(this.page - 1);
    };
    /**
     * @protected
     * @param {?} p
     * @return {?}
     */
    BaseComponent.prototype.onGotoPage = /**
     * @protected
     * @param {?} p
     * @return {?}
     */
    function (p) {
        if (p > this.total_pages || p < 1)
            return;
        this.routeToPage(p);
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.goBack = /**
     * @protected
     * @return {?}
     */
    function () {
        this.location.back();
        /*
        // window.history.back();
        if (this.view != ViewType.EDIT)
            this.location.back();
        else {
            let url = this.location.path(); //in EDIT view, the current url is skipped. So get the "previous" one from path.
            this.router.navigateByUrl(url);
        }
        */
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.stringify = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_1, _a;
        /** @type {?} */
        var str = "";
        try {
            for (var _b = tslib_1.__values(this.indexFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fnm = _c.value;
                if (detail[fnm] && typeof detail[fnm] != 'object')
                    str += " " + detail[fnm];
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_1) throw e_1.error; }
        }
        if (!str) {
            for (var prop in detail) {
                if (prop !== '_id' && detail[prop] && typeof detail[prop] != 'object') {
                    str += " " + detail[prop];
                }
            }
        }
        if (!str)
            str = detail["_id"] ? detail["_id"] : "...";
        str = str.replace(/^\s+|\s+$/g, '');
        if (str.length > 30)
            str = str.substr(0, 27) + '...';
        return str;
    };
    /***Start: handle reference fields***/
    /**
     * Start: handle reference fields**
     * @protected
     * @param {?} field
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.formatReferenceField = /**
     * Start: handle reference fields**
     * @protected
     * @param {?} field
     * @param {?} fieldName
     * @return {?}
     */
    function (field, fieldName) {
        /** @type {?} */
        var id;
        /** @type {?} */
        var value;
        if (typeof field == 'string') {
            //assume this is the "_id", let see we have the cached details for this ref from service
            /** @type {?} */
            var refDetail = this.commonService.getFromStorage(field);
            if (refDetail && (typeof refDetail == 'object'))
                field = refDetail;
            else {
                id = field;
                field = { '_id': id };
            }
        }
        else if (field && (typeof field == 'object')) {
            id = field['_id'];
            /** @type {?} */
            var referIndex = '';
            for (var k in field) {
                if (k != '_id')
                    referIndex += " " + field[k];
            }
            referIndex = referIndex.replace(/^\s+|\s+$/g, '');
            if (referIndex.length >= 20)
                referIndex = referIndex.substring(0, 20) + "...";
            field = { '_id': id, 'value': referIndex ? referIndex : fieldName };
        }
        else { //not defined
            field = { '_id': id, 'value': value };
        }
        return field;
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.formatReference = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_2, _a;
        try {
            for (var _b = tslib_1.__values(this.referenceFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fnm = _c.value;
                detail[fnm] = this.formatReferenceField(detail[fnm], fnm);
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.deFormatReference = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_3, _a;
        try {
            for (var _b = tslib_1.__values(this.referenceFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fnm = _c.value;
                if (typeof detail[fnm] !== 'object') { //not defined
                    //let date values undefined
                    delete detail[fnm];
                }
                else {
                    /** @type {?} */
                    var id = detail[fnm]['_id'];
                    if (typeof id !== 'string')
                        delete detail[fnm];
                    else
                        detail[fnm] = id;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_3) throw e_3.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearFieldReference = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        for (var prop in field) {
            field[prop] = undefined;
        }
        return field;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.isDefinedFieldReference = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if ('_id' in field && typeof field['_id'] == 'string')
            return true;
        return false;
    };
    /***Start: handle date fields***/
    /**
     * Start: handle date fields**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.formatDateField = /**
     * Start: handle date fields**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        /** @type {?} */
        var fmt = this.dateFormat;
        /** @type {?} */
        var t_fmt = this.timeFormat;
        /** @type {?} */
        var d;
        /** @type {?} */
        var M;
        /** @type {?} */
        var yyyy;
        /** @type {?} */
        var h;
        /** @type {?} */
        var m;
        /** @type {?} */
        var s;
        /** @type {?} */
        var dt = new Date(field);
        /** @type {?} */
        var dd;
        /** @type {?} */
        var MM;
        /** @type {?} */
        var hh;
        /** @type {?} */
        var mm;
        /** @type {?} */
        var ss;
        d = dt.getDate();
        M = dt.getMonth() + 1;
        yyyy = dt.getFullYear();
        /** @type {?} */
        var yy = yyyy.toString().slice(2);
        h = dt.getHours();
        m = dt.getMinutes();
        s = dt.getSeconds();
        dd = d < 10 ? '0' + d : d.toString();
        MM = M < 10 ? '0' + M : M.toString();
        hh = h < 10 ? '0' + h : h.toString();
        mm = m < 10 ? '0' + m : m.toString();
        ss = s < 10 ? '0' + s : s.toString();
        /** @type {?} */
        var value = fmt.replace(/yyyy/ig, yyyy.toString()).
            replace(/yy/ig, yy.toString()).
            replace(/MM/g, MM.toString()).
            replace(/dd/ig, dd.toString());
        /** @type {?} */
        var t_value = t_fmt.replace(/hh/ig, hh.toString()).
            replace(/mm/g, mm.toString()).
            replace(/ss/ig, ss.toString());
        /*Datepicker uses NgbDateStruct as a model and not the native Date object.
        It's a simple data structure with 3 fields. Also note that months start with 1 (as in ISO 8601).
        
        we add h, m, s here
        */
        //"from" and "to" used for search context. pop: show the selection popup
        return { 'date': { day: d, month: M, year: yyyy }, 'value': value, 'from': undefined, 'to': undefined, 'pop': false,
            'time': { hour: h, minute: m, second: s }, 't_value': value, 't_from': undefined, 't_to': undefined, 't_pop': false };
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.formatDate = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_4, _a;
        try {
            for (var _b = tslib_1.__values(this.dateFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fnm = _c.value;
                /** @type {?} */
                var value = void 0;
                /** @type {?} */
                var date = void 0;
                if (typeof detail[fnm] !== 'string') { //not defined
                    //important: let date values undefined. "from" and "to" used for search context. pop: show the selection popup
                    detail[fnm] = { 'date': undefined, 'value': undefined, 'from': undefined, 'to': undefined, 'pop': false };
                }
                else {
                    detail[fnm] = this.formatDateField(detail[fnm]);
                }
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_4) throw e_4.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} date
     * @return {?}
     */
    BaseComponent.prototype.deFormatDateField = /**
     * @protected
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var d;
        /** @type {?} */
        var M;
        /** @type {?} */
        var yyyy;
        /** @type {?} */
        var h;
        /** @type {?} */
        var m;
        /** @type {?} */
        var s;
        yyyy = date.year;
        M = date.month - 1;
        d = date.day;
        if (typeof yyyy !== 'number' || typeof M !== 'number' || typeof d !== 'number')
            return null;
        else {
            /** @type {?} */
            var dt = new Date(yyyy, M, d, 0, 0, 0, 0);
            return dt.toISOString();
        }
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.deFormatDate = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_5, _a;
        try {
            for (var _b = tslib_1.__values(this.dateFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fnm = _c.value;
                /** @type {?} */
                var value = void 0;
                if (typeof detail[fnm] !== 'object') { //not defined
                    //let date values undefined
                    delete detail[fnm];
                }
                else {
                    if (!detail[fnm].date)
                        delete detail[fnm];
                    else {
                        /** @type {?} */
                        var dateStr = this.deFormatDateField(detail[fnm].date);
                        if (!dateStr)
                            delete detail[fnm];
                        else
                            detail[fnm] = dateStr;
                    }
                }
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_5) throw e_5.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearFieldDate = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        for (var prop in field) {
            field[prop] = undefined;
        }
        return field;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.isDefinedFieldDate = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if (typeof field === 'object') {
            if (typeof field['date'] == 'object')
                return true;
            if (typeof field['from'] == 'object')
                return true;
            if (typeof field['to'] == 'object')
                return true;
        }
        return false;
    };
    /***Start: handle array of multi-selection fields***/
    /**
     * Start: handle array of multi-selection fields**
     * @protected
     * @param {?} field
     * @param {?} enums
     * @return {?}
     */
    BaseComponent.prototype.formatArrayMultiSelectionField = /**
     * Start: handle array of multi-selection fields**
     * @protected
     * @param {?} field
     * @param {?} enums
     * @return {?}
     */
    function (field, enums) {
        var e_6, _a, e_7, _b;
        /** @type {?} */
        var selectObj = {};
        /** @type {?} */
        var value = "";
        try {
            for (var enums_1 = tslib_1.__values(enums), enums_1_1 = enums_1.next(); !enums_1_1.done; enums_1_1 = enums_1.next()) {
                var e = enums_1_1.value;
                selectObj[e] = false; //not exist
            }
        }
        catch (e_6_1) { e_6 = { error: e_6_1 }; }
        finally {
            try {
                if (enums_1_1 && !enums_1_1.done && (_a = enums_1.return)) _a.call(enums_1);
            }
            finally { if (e_6) throw e_6.error; }
        }
        if (Array.isArray(field)) { //not defined
            try {
                for (var field_1 = tslib_1.__values(field), field_1_1 = field_1.next(); !field_1_1.done; field_1_1 = field_1.next()) {
                    var e = field_1_1.value;
                    selectObj[e] = true; //exist.
                }
            }
            catch (e_7_1) { e_7 = { error: e_7_1 }; }
            finally {
                try {
                    if (field_1_1 && !field_1_1.done && (_b = field_1.return)) _b.call(field_1);
                }
                finally { if (e_7) throw e_7.error; }
            }
            value = field.join(" | ");
        }
        return { 'selection': selectObj, value: value };
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.formatArrayMultiSelection = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_8, _a;
        try {
            for (var _b = tslib_1.__values(this.multiSelectionFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fnm = _c.value;
                detail[fnm] = this.formatArrayMultiSelectionField(detail[fnm], this.enums[fnm]);
            }
        }
        catch (e_8_1) { e_8 = { error: e_8_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_8) throw e_8.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.deFormatArrayMultiSelection = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_9, _a, e_10, _b;
        try {
            for (var _c = tslib_1.__values(this.multiSelectionFields), _d = _c.next(); !_d.done; _d = _c.next()) {
                var fnm = _d.value;
                if (typeof detail[fnm] !== 'object') { //not defined
                    delete detail[fnm];
                }
                else {
                    if (!detail[fnm].selection)
                        delete detail[fnm];
                    else {
                        /** @type {?} */
                        var selectArray = [];
                        try {
                            for (var _e = tslib_1.__values(this.enums[fnm]), _f = _e.next(); !_f.done; _f = _e.next()) {
                                var e = _f.value;
                                if (detail[fnm].selection[e])
                                    selectArray.push(e);
                            }
                        }
                        catch (e_10_1) { e_10 = { error: e_10_1 }; }
                        finally {
                            try {
                                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                            }
                            finally { if (e_10) throw e_10.error; }
                        }
                        if (selectArray.length > 0)
                            detail[fnm] = selectArray;
                        else
                            delete detail[fnm];
                    }
                }
            }
        }
        catch (e_9_1) { e_9 = { error: e_9_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_9) throw e_9.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearFieldArrayMultiSelection = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if (!field['selection'])
            return field;
        for (var prop in field['selection']) {
            field['selection'][prop] = false; //not exist
        }
        return field;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.isDefinedFieldArrayMultiSelection = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if ('selection' in field && typeof field['selection'] == 'object') {
            /** @type {?} */
            var keys = Object.keys(field['selection']);
            return keys.some(function (e) { return field['selection'][e]; });
        }
        return false;
    };
    /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.multiselectionSelected = /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    function (fieldName) {
        if (!this.detail[fieldName] || typeof this.detail[fieldName]['selection'] != 'object') {
            return false;
        }
        return this.isDefinedFieldArrayMultiSelection(this.detail[fieldName]);
    };
    /***End: handle array of multi-selection fields***/
    /***Start: handle map fields***/
    /***End: handle array of multi-selection fields***/
    /**
     * Start: handle map fields**
     * @protected
     * @param {?} field
     * @param {?} elementType
     * @return {?}
     */
    BaseComponent.prototype.formatMapField = /***End: handle array of multi-selection fields***/
    /**
     * Start: handle map fields**
     * @protected
     * @param {?} field
     * @param {?} elementType
     * @return {?}
     */
    function (field, elementType) {
        /** @type {?} */
        var selectObj = {};
        /** @type {?} */
        var values = [];
        if (typeof field == 'object') {
            selectObj = field;
            for (var e in field) {
                if (elementType === 'SchemaString') {
                    values.push(e + "(" + field[e] + ")");
                }
            }
        }
        values = values.filter(function (x) { return !!x; });
        /** @type {?} */
        var value = values.join(" | ");
        return { 'selection': selectObj, value: value, keys: [] };
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.formatMapFields = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_11, _a;
        try {
            for (var _b = tslib_1.__values(this.mapFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var f = _c.value;
                //[fieldName, elementType]
                detail[f[0]] = this.formatMapField(detail[f[0]], f[1]);
            }
        }
        catch (e_11_1) { e_11 = { error: e_11_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_11) throw e_11.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.deFormatMapFields = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_12, _a;
        try {
            for (var _b = tslib_1.__values(this.mapFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var f = _c.value;
                //[fieldName, elementType]
                /** @type {?} */
                var fnm = f[0];
                /** @type {?} */
                var elementType = f[1];
                if (typeof detail[fnm] !== 'object') { //not defined
                    delete detail[fnm];
                }
                else {
                    if (!detail[fnm].selection)
                        delete detail[fnm];
                    else {
                        /** @type {?} */
                        var selectMap = detail[fnm].selection;
                        for (var e in detail[fnm].selection) {
                            if (elementType === 'SchemaString') {
                                ;
                            }
                        }
                        if (Object.keys(selectMap).length > 0)
                            detail[fnm] = selectMap;
                        else
                            delete detail[fnm];
                    }
                }
            }
        }
        catch (e_12_1) { e_12 = { error: e_12_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_12) throw e_12.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearFieldMap = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if (!field['selection'])
            return field;
        field['selection'] = {};
        field.value = undefined;
        return field;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.isDefinedFieldMap = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if ('selection' in field && typeof field['selection'] == 'object') {
            return Object.keys(field['selection']).length > 0;
        }
        return false;
    };
    /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.mapSelected = /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    function (fieldName) {
        if (!this.detail[fieldName] || typeof this.detail[fieldName]['selection'] != 'object') {
            return false;
        }
        return this.isDefinedFieldMap(this.detail[fieldName]);
    };
    /***End: handle map fields***/
    /***Start: handle array fields***/
    /***End: handle map fields***/
    /**
     * Start: handle array fields**
     * @protected
     * @param {?} field
     * @param {?} elementType
     * @return {?}
     */
    BaseComponent.prototype.formatArrayField = /***End: handle map fields***/
    /**
     * Start: handle array fields**
     * @protected
     * @param {?} field
     * @param {?} elementType
     * @return {?}
     */
    function (field, elementType) {
        var e_13, _a;
        /** @type {?} */
        var selectArray = [];
        /** @type {?} */
        var values = [];
        if (Array.isArray(field)) { //not defined
            try {
                for (var field_2 = tslib_1.__values(field), field_2_1 = field_2.next(); !field_2_1.done; field_2_1 = field_2.next()) {
                    var e = field_2_1.value;
                    if (elementType === 'ObjectId') {
                        /** @type {?} */
                        var ref = this.formatReferenceField(e, "...");
                        selectArray.push(ref);
                        values.push(ref.value);
                    }
                    else if (elementType === 'SchemaString') {
                        selectArray.push(e);
                        values.push(e);
                    }
                }
            }
            catch (e_13_1) { e_13 = { error: e_13_1 }; }
            finally {
                try {
                    if (field_2_1 && !field_2_1.done && (_a = field_2.return)) _a.call(field_2);
                }
                finally { if (e_13) throw e_13.error; }
            }
        }
        values = values.filter(function (x) { return !!x; });
        /** @type {?} */
        var value = values.join(" | ");
        return { 'selection': selectArray, value: value };
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.formatArrayFields = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_14, _a;
        try {
            for (var _b = tslib_1.__values(this.arrayFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var f = _c.value;
                //[fieldName, elementType]
                detail[f[0]] = this.formatArrayField(detail[f[0]], f[1]);
            }
        }
        catch (e_14_1) { e_14 = { error: e_14_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_14) throw e_14.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.deFormatArrayFields = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        var e_15, _a, e_16, _b;
        try {
            for (var _c = tslib_1.__values(this.arrayFields), _d = _c.next(); !_d.done; _d = _c.next()) {
                var f = _d.value;
                //[fieldName, elementType]
                /** @type {?} */
                var fnm = f[0];
                /** @type {?} */
                var elementType = f[1];
                if (typeof detail[fnm] !== 'object') { //not defined
                    delete detail[fnm];
                }
                else {
                    if (!detail[fnm].selection)
                        delete detail[fnm];
                    else {
                        /** @type {?} */
                        var selectArray = [];
                        try {
                            for (var _e = tslib_1.__values(detail[fnm].selection), _f = _e.next(); !_f.done; _f = _e.next()) {
                                var e = _f.value;
                                if (elementType === 'ObjectId') {
                                    if (e && e['_id'] && typeof e['_id'] === 'string')
                                        selectArray.push(e['_id']);
                                }
                                else if (elementType === 'SchemaString') {
                                    if (e)
                                        selectArray.push(e);
                                }
                            }
                        }
                        catch (e_16_1) { e_16 = { error: e_16_1 }; }
                        finally {
                            try {
                                if (_f && !_f.done && (_b = _e.return)) _b.call(_e);
                            }
                            finally { if (e_16) throw e_16.error; }
                        }
                        if (selectArray.length > 0)
                            detail[fnm] = selectArray;
                        else
                            delete detail[fnm];
                    }
                }
            }
        }
        catch (e_15_1) { e_15 = { error: e_15_1 }; }
        finally {
            try {
                if (_d && !_d.done && (_a = _c.return)) _a.call(_c);
            }
            finally { if (e_15) throw e_15.error; }
        }
        return detail;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearFieldArray = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if (!field['selection'])
            return field;
        field['selection'] = [];
        field.value = undefined;
        return field;
    };
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.isDefinedFieldArray = /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if ('selection' in field && Array.isArray(field['selection'])) {
            return field['selection'].length > 0;
        }
        return false;
    };
    /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.arraySelected = /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    function (fieldName) {
        if (!this.detail[fieldName] || !Array.isArray(this.detail[fieldName]['selection'])) {
            return false;
        }
        return this.isDefinedFieldArray(this.detail[fieldName]);
    };
    /***End: handle array fields***/
    /**
     * End: handle array fields**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.formatDetail = /**
     * End: handle array fields**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        detail = this.formatReference(detail);
        detail = this.formatDate(detail);
        detail = this.formatArrayMultiSelection(detail);
        detail = this.formatArrayFields(detail);
        detail = this.formatMapFields(detail);
        return detail;
    };
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    BaseComponent.prototype.deFormatDetail = /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    function (detail) {
        /** @type {?} */
        var cpy = Util.clone(detail);
        cpy = this.deFormatReference(cpy);
        cpy = this.deFormatDate(cpy);
        cpy = this.deFormatArrayMultiSelection(cpy);
        cpy = this.deFormatArrayFields(cpy);
        cpy = this.deFormatMapFields(cpy);
        return cpy;
    };
    /**
     * @protected
     * @param {?} id
     * @return {?}
     */
    BaseComponent.prototype.populateDetail = /**
     * @protected
     * @param {?} id
     * @return {?}
     */
    function (id) {
        return this.populateDetailForAction(id, null);
    };
    /**
     * @protected
     * @param {?} id
     * @param {?} action
     * @return {?}
     */
    BaseComponent.prototype.populateDetailForAction = /**
     * @protected
     * @param {?} id
     * @param {?} action
     * @return {?}
     */
    function (id, action) {
        var _this = this;
        //action: eg: action=edit  -> get detail for editing purpose 
        this.service.getDetailForAction(id, action).subscribe(function (detail) {
            /** @type {?} */
            var originalDetail = Util.clone(detail);
            if (detail["_id"])
                _this.commonService.putToStorage(detail["_id"], originalDetail); //cache it
            _this.detail = _this.formatDetail(detail);
            _this.extraFieldsUnload(); //unload data to text editors, etc
            if (action == 'edit') {
                _this.extraInfoPopulate(); //collect other info required for edit view
            }
            if (_this.refreshing) {
                _this.refreshing = false;
                /** @type {?} */
                var snackBarConfig = {
                    content: "Detail refreshed"
                };
                /** @type {?} */
                var snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
            }
            _this.eventEmitter.emit(_this.detail);
        }, this.onServiceError);
        return this.eventEmitter;
    };
    /**
     * @protected
     * @param {?} copy_id
     * @return {?}
     */
    BaseComponent.prototype.populateDetailFromCopy = /**
     * @protected
     * @param {?} copy_id
     * @return {?}
     */
    function (copy_id) {
        var _this = this;
        this.service.getDetail(copy_id).subscribe(function (detail) {
            _this.detail = _this.formatDetail(detail);
            delete _this.detail["_id"];
            _this.extraFieldsUnload(); //unload data to text editors, etc
            _this.extraInfoPopulate(); //collect other info required for create view
        }, this.onServiceError);
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.extraInfoPopulate = /**
     * @protected
     * @return {?}
     */
    function () {
        var e_17, _a;
        var _loop_1 = function (fieldDef) {
            //fieldDef: [field.fieldName, field.elementType, keyType, keyRefName, keyRefService, keyRefSubField]
            /** @type {?} */
            var fieldName = fieldDef[0];
            //this.<keyRefName>.<keyRefSubField>
            /** @type {?} */
            var mapKeyType = fieldDef[2];
            //this.<keyRefName>.<keyRefSubField>
            /** @type {?} */
            var keyArray = [];
            if (mapKeyType == "ObjectId") {
                /** @type {?} */
                var keyRefName = fieldDef[3];
                /** @type {?} */
                var recordKey_1 = 'key-id-' + keyRefName;
                /** @type {?} */
                var refService = this_1.injector.get(fieldDef[4]);
                /** @type {?} */
                var id_1 = this_1.detail[keyRefName] ? this_1.detail[keyRefName]['_id'] : undefined;
                if (!id_1)
                    return "continue";
                /** @type {?} */
                var mapField_1 = this_1.detail[fieldName];
                if (mapField_1[recordKey_1] == id_1)
                    return "continue"; //already populated for the same id
                refService.getDetail(id_1).subscribe(function (detail) {
                    var e_18, _a;
                    if (Array.isArray(detail[fieldDef[5]])) {
                        keyArray = detail[fieldDef[5]];
                        mapField_1['keys'] = keyArray;
                        mapField_1[recordKey_1] = id_1; //record that keys is populated from this object
                        if (mapField_1['selection']) {
                            try {
                                for (var keyArray_1 = tslib_1.__values(keyArray), keyArray_1_1 = keyArray_1.next(); !keyArray_1_1.done; keyArray_1_1 = keyArray_1.next()) {
                                    var k = keyArray_1_1.value;
                                    if (!(k in mapField_1['selection']))
                                        mapField_1['selection'][k] = "";
                                }
                            }
                            catch (e_18_1) { e_18 = { error: e_18_1 }; }
                            finally {
                                try {
                                    if (keyArray_1_1 && !keyArray_1_1.done && (_a = keyArray_1.return)) _a.call(keyArray_1);
                                }
                                finally { if (e_18) throw e_18.error; }
                            }
                        }
                    }
                }, this_1.onServiceError);
            }
        };
        var this_1 = this;
        try {
            for (var _b = tslib_1.__values(this.mapFields), _c = _b.next(); !_c.done; _c = _b.next()) {
                var fieldDef = _c.value;
                _loop_1(fieldDef);
            }
        }
        catch (e_17_1) { e_17 = { error: e_17_1 }; }
        finally {
            try {
                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
            }
            finally { if (e_17) throw e_17.error; }
        }
    };
    /**
     * @private
     * @param {?} arr1
     * @param {?} arr2
     * @return {?}
     */
    BaseComponent.prototype.equalTwoSearchContextArrays = /**
     * @private
     * @param {?} arr1
     * @param {?} arr2
     * @return {?}
     */
    function (arr1, arr2) {
        if (!arr1)
            arr1 = [];
        if (!arr2)
            arr2 = [];
        if (arr1.length == 0 && arr2.length == 0)
            return true;
        //all object in array has format of {'field': 'value'} format
        /**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function compareObj(a, b) {
            /** @type {?} */
            var a_s = JSON.stringify(a);
            /** @type {?} */
            var b_s = JSON.stringify(b);
            if (a_s < b_s)
                return -1;
            if (a_s > b_s)
                return 1;
            return 0;
        }
        arr1 = arr1.sort(compareObj);
        arr2 = arr2.sort(compareObj);
        if (JSON.stringify(arr1) == JSON.stringify(arr2))
            return true;
        return false;
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.processSearchContext = /**
     * @protected
     * @return {?}
     */
    function () {
        var e_19, _a, e_20, _b, e_21, _c;
        this.moreSearchOpened = false;
        /** @type {?} */
        var d = this.detail;
        try {
            for (var _d = tslib_1.__values(this.stringFields), _e = _d.next(); !_e.done; _e = _d.next()) {
                var s = _e.value;
                d[s] = this.searchText;
            }
        }
        catch (e_19_1) { e_19 = { error: e_19_1 }; }
        finally {
            try {
                if (_e && !_e.done && (_a = _d.return)) _a.call(_d);
            }
            finally { if (e_19) throw e_19.error; }
        }
        /** @type {?} */
        var orSearchContext = [];
        /** @type {?} */
        var andSearchContext = [];
        for (var field in d) {
            if (typeof d[field] == 'string') {
                /** @type {?} */
                var o = {};
                o[field] = d[field];
                orSearchContext.push(o);
            }
        }
        this.searchMoreDetail = [];
        /** @type {?} */
        var d2 = this.deFormatDetail(d);
        var _loop_2 = function (field) {
            if (this_2.stringFields.indexOf(field) == -1) { //string fields already put to orSearchContext
                //string fields already put to orSearchContext
                /** @type {?} */
                var o = {};
                /** @type {?} */
                var valueToShow = void 0;
                o[field] = d2[field];
                if (this_2.multiSelectionFields.includes(field)) {
                    o[field] = { $in: d2[field] }; //use $in for or, and $all for and
                    //use $in for or, and $all for and
                    /** @type {?} */
                    var t = this_2.formatArrayMultiSelectionField(d2[field], this_2.enums[field]);
                    valueToShow = t.value;
                }
                else if (this_2.arrayFields.some(function (x) { return x[0] == field; })) {
                    o[field] = { $in: d2[field] }; //use $in for or, and $all for and
                    valueToShow = d[field]['value'];
                }
                else if (this_2.dateFields.includes(field)) {
                    /** @type {?} */
                    var t = this_2.formatDateField(d2[field]);
                    valueToShow = t.value;
                }
                else if (this_2.referenceFields.includes(field)) {
                    valueToShow = valueToShow = d[field]['value'];
                }
                else {
                    valueToShow = d[field]; //take directoy from what we get 
                }
                this_2.searchMoreDetail.push([field, valueToShow]);
                andSearchContext.push(o);
            }
        };
        var this_2 = this;
        for (var field in d2) {
            _loop_2(field);
        }
        try {
            //Handle date range selection. These fields are not in d2, because field.date is undefined.
            for (var _f = tslib_1.__values(this.dateFields), _g = _f.next(); !_g.done; _g = _f.next()) {
                var prop = _g.value;
                /** @type {?} */
                var o = {};
                /** @type {?} */
                var valueToShow = "";
                o[prop] = {};
                if (typeof d[prop] !== 'object') { //not defined
                    continue;
                }
                if (!d[prop]['from'] && !d[prop]['to']) { //not range
                    continue;
                }
                if (d[prop]['from']) {
                    o[prop]['from'] = this.deFormatDateField(d[prop]['from']);
                    valueToShow += this.formatDateField(o[prop]['from']).value;
                }
                valueToShow += " ~ ";
                if (d[prop]['to']) {
                    o[prop]['to'] = this.deFormatDateField(d[prop]['to']);
                    valueToShow += this.formatDateField(o[prop]['to']).value;
                }
                this.searchMoreDetail.push([prop, valueToShow]);
                andSearchContext.push(o);
            }
        }
        catch (e_20_1) { e_20 = { error: e_20_1 }; }
        finally {
            try {
                if (_g && !_g.done && (_b = _f.return)) _b.call(_f);
            }
            finally { if (e_20) throw e_20.error; }
        }
        /** @type {?} */
        var searchContext = { '$and': [{ '$or': orSearchContext }, { '$and': andSearchContext }] };
        /* searchContext ={'$and', [{'$or', []},{'$and', []}]}
                */
        /** @type {?} */
        var context = this.getFromStorage("searchContext");
        if (context && context["$and"]) {
            /** @type {?} */
            var cachedOr = void 0;
            /** @type {?} */
            var cachedAnd = void 0;
            try {
                for (var _h = tslib_1.__values(context["$and"]), _j = _h.next(); !_j.done; _j = _h.next()) {
                    var sub = _j.value;
                    if ('$and' in sub)
                        cachedAnd = sub['$and'];
                    else if ('$or' in sub)
                        cachedOr = sub['$or'];
                }
            }
            catch (e_21_1) { e_21 = { error: e_21_1 }; }
            finally {
                try {
                    if (_j && !_j.done && (_c = _h.return)) _c.call(_h);
                }
                finally { if (e_21) throw e_21.error; }
            }
            if (this.equalTwoSearchContextArrays(cachedOr, orSearchContext)
                && this.equalTwoSearchContextArrays(cachedAnd, andSearchContext)) {
                return;
            }
        }
        if (orSearchContext.length == 0 && andSearchContext.length == 0)
            searchContext = null;
        this.putToStorage("searchContext", searchContext);
        this.putToStorage("searchText", this.searchText);
        this.putToStorage("page", 1); //start from 1st page
        this.putToStorage("searchMoreDetail", this.searchMoreDetail);
        this.putToStorage("detail", this.detail);
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.searchList = /**
     * @protected
     * @return {?}
     */
    function () {
        this.processSearchContext();
        //update the URL
        this.router.navigate(['.', {}], { relativeTo: this.route }); //start from 1st page
        this.putToStorage("page", 1); //start from 1st page
        this.populateList();
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.loadUIFromCache = /**
     * @protected
     * @return {?}
     */
    function () {
        //Now let's reload the search condition to UI
        this.searchText = this.getFromStorage("searchText");
        this.searchMoreDetail = this.getFromStorage("searchMoreDetail");
        /** @type {?} */
        var detail = this.getFromStorage("detail");
        if (detail)
            this.detail = detail;
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.populateList = /**
     * @protected
     * @return {?}
     */
    function () {
        var _this = this;
        //First let's handle page
        /** @type {?} */
        var new_page;
        /** @type {?} */
        var searchContext;
        /** @type {?} */
        var searchText;
        /** @type {?} */
        var url_page = parseInt(this.route.snapshot.paramMap.get('page'));
        /** @type {?} */
        var cached_page = parseInt(this.getFromStorage("page"));
        if (cached_page) {
            new_page = cached_page;
            if (cached_page == 1)
                this.router.navigate(['.', {}], { relativeTo: this.route, }); //update the url
            else
                this.router.navigate(['.', { page: cached_page }], { relativeTo: this.route, }); //update the url
        }
        else if (url_page)
            new_page = url_page;
        else
            new_page = 1;
        searchContext = this.getFromStorage("searchContext");
        this.loadUIFromCache();
        this.service.getList(new_page, this.per_page, searchContext).subscribe(function (result) {
            _this.list = result.items.map(function (x) { return _this.formatDetail(x); });
            _this.page = result.page;
            _this.per_page = result.per_page;
            _this.total_count = result.total_count;
            _this.total_pages = result.total_pages;
            _this.populatePages();
            _this.checkedItem =
                Array.apply(null, Array(_this.list.length)).map(Boolean.prototype.valueOf, false);
            _this.checkAll = false;
            if (_this.refreshing) {
                _this.refreshing = false;
                /** @type {?} */
                var snackBarConfig = {
                    content: "List refreshed"
                };
                /** @type {?} */
                var snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
            }
            _this.eventEmitter.emit(_this.list);
        }, this.onServiceError);
        return this.eventEmitter;
    };
    /*UI operations handlers*/
    /*UI operations handlers*/
    /**
     * @return {?}
     */
    BaseComponent.prototype.onRefresh = /*UI operations handlers*/
    /**
     * @return {?}
     */
    function () {
        if (this.view == ViewType.LIST) {
            this.refreshing = true;
            this.populateList();
        }
        else if (this.view == ViewType.DETAIL) {
            this.refreshing = true;
            if (!this.id)
                this.id = this.route.snapshot.paramMap.get('id');
            if (this.id)
                this.populateDetail(this.id);
            else
                console.error("Routing error for detail view... no id...");
        }
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.onCheckAllChange = /**
     * @return {?}
     */
    function () {
        this.checkedItem =
            Array.apply(null, Array(this.list.length)).
                map(Boolean.prototype.valueOf, this.checkAll);
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.isItemSelected = /**
     * @return {?}
     */
    function () {
        return this.checkedItem.some(function (value) { return value; });
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.onDeleteSelected = /**
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var deletedItem = [];
        this.checkedItem.forEach(function (value, index) {
            if (value) {
                deletedItem.push(_this.list[index]["_id"]);
            }
        });
        /** @type {?} */
        var modalConfig = {
            title: "Delete Confirmation",
            content: "Are you sure you want to delete selected items from the system?",
            //list of button text
            buttons: ['Delete', 'Cancel'],
            //list of button returns when clicked
            returns: [true, false],
            callBack: function (result) {
                if (result) {
                    _this.service.deleteManyByIds(deletedItem).subscribe(function (result) {
                        /** @type {?} */
                        var snackBarConfig = {
                            content: _this.ItemCamelName + " deleted"
                        };
                        /** @type {?} */
                        var snackBar = new SnackBar(snackBarConfig);
                        snackBar.show();
                        if (_this.view != ViewType.LIST)
                            _this.router.navigate(['../../list'], { relativeTo: _this.route });
                        else {
                            /** @type {?} */
                            var len = _this.checkedItem.length;
                            for (var i = 0; i < len; i++) {
                                /** @type {?} */
                                var idx = len - 1 - i;
                                /** @type {?} */
                                var value = _this.checkedItem[idx];
                                if (value) {
                                    _this.list.splice(idx, 1);
                                    _this.checkedItem.splice(idx, 1);
                                    _this.total_count -= 1;
                                }
                            }
                            ;
                        }
                    }, _this.onServiceError);
                }
            }
        };
        /** @type {?} */
        var modal = new Modal(modalConfig);
        modal.show();
    };
    /**
     * @param {?} id
     * @param {?} idx
     * @return {?}
     */
    BaseComponent.prototype.onDelete = /**
     * @param {?} id
     * @param {?} idx
     * @return {?}
     */
    function (id, idx) {
        var _this = this;
        /** @type {?} */
        var modalConfig = {
            title: "Delete Confirmation",
            content: "Are you sure you want to delete this " + this.itemCamelName + " from the system?",
            //list of button text
            buttons: ['Delete', 'Cancel'],
            //list of button returns when clicked
            returns: [true, false],
            callBack: function (result) {
                if (result) {
                    _this.service.deleteOne(id).subscribe(function (result) {
                        /** @type {?} */
                        var snackBarConfig = {
                            content: _this.ItemCamelName + " deleted"
                        };
                        /** @type {?} */
                        var snackBar = new SnackBar(snackBarConfig);
                        snackBar.show();
                        if (_this.view != ViewType.LIST)
                            _this.router.navigate(['../../list'], { relativeTo: _this.route });
                        else if (idx != null && _this.list) {
                            _this.list.splice(idx, 1);
                            _this.checkedItem.splice(idx, 1);
                            _this.total_count -= 1;
                        }
                    }, _this.onServiceError);
                }
            }
        };
        /** @type {?} */
        var modal = new Modal(modalConfig);
        modal.show();
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.onSubmit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (!this.extraFieldsLoad())
            return; //error from other non ngModel fields;
        this._detail = this.deFormatDetail(this.detail);
        if (this.id) {
            this.service.updateOne(this.id, this._detail).subscribe(function (result) {
                /** @type {?} */
                var snackBarConfig = {
                    content: _this.ItemCamelName + " updated."
                };
                /** @type {?} */
                var snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
                _this.router.navigate(['../../detail', _this.id], { relativeTo: _this.route });
            }, this.onServiceError);
        }
        else {
            this.service.createOne(this._detail).subscribe(function (result) {
                /** @type {?} */
                var action = _this.subEdit ? " added" : " created.";
                /** @type {?} */
                var snackBarConfig = {
                    content: _this.ItemCamelName + action
                };
                /** @type {?} */
                var snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
                _this.id = result["_id"];
                _this._detail = result;
                if (_this.subEdit) {
                    _this.done.emit(true);
                }
                else {
                    _this.router.navigate(['../detail', _this.id], { relativeTo: _this.route });
                }
            }, this.onServiceError);
        }
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.editCancel = /**
     * @return {?}
     */
    function () {
        if (this.subEdit) {
            this.done.emit(false);
        }
        else {
            this.goBack();
        }
    };
    /**
     * @param {?} fn
     * @param {?} detail
     * @param {?} event
     * @return {?}
     */
    BaseComponent.prototype.onDisplayRefClicked = /**
     * @param {?} fn
     * @param {?} detail
     * @param {?} event
     * @return {?}
     */
    function (fn, detail, event) {
        var e_22, _a;
        /** @type {?} */
        var ref = this.getRefFromField(fn);
        /** @type {?} */
        var d = detail;
        if (d && d['_id']) {
            if (this.list) {
                try {
                    for (var _b = tslib_1.__values(this.list), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var item = _c.value;
                        if (item[fn] == d)
                            this.clickedId = item['_id'];
                    }
                }
                catch (e_22_1) { e_22 = { error: e_22_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_22) throw e_22.error; }
                }
            }
            this.router.navigate([ref, 'detail', d['_id']], { relativeTo: this.getParentActivatedRouter() });
        }
        if (event)
            event.stopPropagation();
    };
    /**
     * @param {?} id
     * @return {?}
     */
    BaseComponent.prototype.onDetailLinkClicked = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        this.clickedId = id;
        this.router.navigate([this.itemName, 'detail', id], { relativeTo: this.getParentActivatedRouter() });
    };
    /**
     * @protected
     * @param {?} fn
     * @return {?}
     */
    BaseComponent.prototype.getRefFromField = /**
     * @protected
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        return this.referenceFieldsMap[fn];
    };
    /**
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearValueFromDetail = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        if (!this.detail.hasOwnProperty(field))
            return;
        if (typeof this.detail[field] == 'undefined')
            return;
        if (typeof this.detail[field] == 'object') { //reference field or date
            if (this.multiSelectionFields.includes(field)) {
                this.detail[field] = this.clearFieldArrayMultiSelection(this.detail[field]);
            }
            else if (this.arrayFields.some(function (x) { return x[0] == field; })) {
                this.detail[field] = this.clearFieldArray(this.detail[field]);
            }
            else if (this.mapFields.some(function (x) { return x[0] == field; })) {
                this.detail[field] = this.clearFieldMap(this.detail[field]);
            }
            else if (this.dateFields.includes(field)) {
                this.detail[field] = this.clearFieldDate(this.detail[field]);
            }
            else if (this.referenceFields.includes(field)) {
                this.detail[field] = this.clearFieldReference(this.detail[field]);
            }
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
        else {
            delete this.detail[field];
        }
    };
    /**
     * @param {?} field
     * @param {?} idx
     * @return {?}
     */
    BaseComponent.prototype.clearValueFromArrayField = /**
     * @param {?} field
     * @param {?} idx
     * @return {?}
     */
    function (field, idx) {
        if (this.detail[field]['selection']) {
            this.detail[field]['selection'] = this.detail[field]['selection'].filter(function (x, i) { return i != idx; });
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
    };
    /**
     * @param {?} field
     * @param {?} key
     * @return {?}
     */
    BaseComponent.prototype.clearValueFromMapField = /**
     * @param {?} field
     * @param {?} key
     * @return {?}
     */
    function (field, key) {
        if (this.detail[field]['selection']) {
            delete this.detail[field]['selection'][key];
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
    };
    /**
     * @param {?} field
     * @param {?} key
     * @return {?}
     */
    BaseComponent.prototype.clearValueFromMapKey = /**
     * @param {?} field
     * @param {?} key
     * @return {?}
     */
    function (field, key) {
        if (this.detail[field]['selection']) {
            this.detail[field]['selection'][key] = undefined;
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
    };
    /**
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.checkValueDefinedFromDetail = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        /** @type {?} */
        var d = this.detail;
        if (!d.hasOwnProperty(field))
            return false;
        if (typeof d[field] == 'undefined')
            return false;
        if (typeof this.detail[field] == 'number'
            || typeof d[field] == 'string'
            || typeof d[field] == 'boolean')
            return true;
        if (typeof d[field] == 'object') {
            if (this.multiSelectionFields.includes(field)) {
                return this.isDefinedFieldArrayMultiSelection(d[field]);
            }
            else if (this.arrayFields.some(function (x) { return x[0] == field; })) {
                return this.isDefinedFieldArray(d[field]);
            }
            else if (this.mapFields.some(function (x) { return x[0] == field; })) {
                return this.isDefinedFieldMap(d[field]);
            }
            else if (this.dateFields.includes(field)) {
                return this.isDefinedFieldDate(d[field]);
            }
            else if (this.referenceFields.includes(field)) {
                return this.isDefinedFieldReference(d[field]);
            }
        }
        return false;
    };
    /**
     * @param {?} field
     * @return {?}
     */
    BaseComponent.prototype.clearValueFromDetailAndSearchList = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        this.clearValueFromDetail(field);
        this.searchList();
    };
    /**
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.onAddArrayItem = /**
     * @param {?} fieldName
     * @return {?}
     */
    function (fieldName) {
        if (this.arrayFields.some(function (x) { return x[0] == fieldName; })) {
            if (this.detail[fieldName]['new']) { //where new added item is stored
                //where new added item is stored
                /** @type {?} */
                var item = this.detail[fieldName]['new'];
                this.detail[fieldName]['new'] = undefined; //clear it
                this.detail[fieldName]['selection'].push(item);
                /** @type {?} */
                var values = [];
                if (this.detail[fieldName]['value'])
                    values = this.detail[fieldName]['value'].split(' | ');
                values.push(item); //display value
                values = values.filter(function (x) { return !!x; });
                this.detail[fieldName]['value'] = values.join(' | ');
                //see if related info needs to change after the change of this value
                this.extraInfoPopulate();
            }
        }
    };
    /**
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.onAddMapItem = /**
     * @param {?} fieldName
     * @return {?}
     */
    function (fieldName) {
        if (this.mapFields.some(function (x) { return x[0] == fieldName; })) {
            if (this.detail[fieldName]['new']) { //where new added item is stored
                //where new added item is stored
                /** @type {?} */
                var item = this.detail[fieldName]['new'];
                this.detail[fieldName]['new'] = undefined; //clear it
                this.detail[fieldName]['selection'][item] = undefined; //move to selection object
                //TODO: this.detail[fieldName]['value'] change
                //see if related info needs to change after the change of this value
                this.extraInfoPopulate();
            }
        }
    };
    /**
     * @param {?} fieldName
     * @return {?}
     */
    BaseComponent.prototype.onRefSelect = /**
     * @param {?} fieldName
     * @return {?}
     */
    function (fieldName) {
        var _this = this;
        if (!this.refSelectDirective) {
            console.warn("No reference directive for field: ", fieldName);
            return;
        }
        /** @type {?} */
        var viewContainerRef = this.refSelectDirective.viewContainerRef;
        viewContainerRef.clear();
        if (!this.selectComponents[fieldName]) {
            console.warn("No reference defined for field: ", fieldName);
            return;
        }
        /** @type {?} */
        var componentRef = this.selectComponents[fieldName]["componentRef"];
        if (!componentRef) {
            /** @type {?} */
            var comType = this.selectComponents[fieldName]["select-type"];
            if (!comType)
                console.warn("No component type found for reference field ", fieldName);
            /** @type {?} */
            var componentFactory = this.componentFactoryResolver.resolveComponentFactory(comType);
            componentRef = viewContainerRef.createComponent(componentFactory); //create and insert in one call
            this.selectComponents[fieldName]["componentRef"] = componentRef; //save it
        }
        else {
            viewContainerRef.insert(componentRef.hostView);
        }
        /** @type {?} */
        var componentInstance = (/** @type {?} */ (componentRef.instance));
        if (this.detail[fieldName]) {
            if (this.referenceFields.includes(fieldName)) {
                componentInstance.inputData = this.detail[fieldName]['_id'];
            }
        }
        componentInstance.setFocus();
        this.componentSubscription = componentInstance.done.subscribe(function (val) {
            if (val) {
                _this.componentSubscription.unsubscribe();
                viewContainerRef.detach(); //only detach. not destroy
            }
            /** @type {?} */
            var outputData = componentInstance.outputData;
            if (outputData) {
                switch (outputData.action) {
                    case "selected":
                        if (_this.arrayFields.some(function (x) { return x[0] == fieldName; })) {
                            _this.detail[fieldName]['selection'].push(outputData.value);
                            /** @type {?} */
                            var values = [];
                            if (_this.detail[fieldName]['value'])
                                values = _this.detail[fieldName]['value'].split(' | ');
                            values.push(outputData.value.value); //display value
                            values = values.filter(function (x) { return !!x; });
                            _this.detail[fieldName]['value'] = values.join(' | ');
                        }
                        else if (_this.referenceFields.includes(fieldName)) {
                            _this.detail[fieldName] = outputData.value;
                        }
                        //trigger extraInfo populate, once reference changed.
                        _this.extraInfoPopulate();
                        break;
                    case "view":
                        _this.onRefShow(fieldName, "select", outputData.value); //value is _id
                        break;
                    default:
                        break;
                }
            }
        });
    };
    /**
     * @param {?} fieldName
     * @param {?} action
     * @param {?} id
     * @return {?}
     */
    BaseComponent.prototype.onRefShow = /**
     * @param {?} fieldName
     * @param {?} action
     * @param {?} id
     * @return {?}
     */
    function (fieldName, action, id) {
        var _this = this;
        if (!id && this.detail[fieldName])
            id = this.detail[fieldName]['_id'];
        if (!id) {
            console.error('Show reference but no id is given.');
            return;
        }
        /** @type {?} */
        var viewContainerRef = this.refSelectDirective.viewContainerRef;
        viewContainerRef.clear();
        /** @type {?} */
        var detailType = action + "-detail-type";
        //eg: select-detail-type, pop-detail-type
        /** @type {?} */
        var comType = this.selectComponents[fieldName][detailType];
        if (!comType) {
            console.error("No component type found for: %s", detailType);
            return;
        }
        /** @type {?} */
        var componentFactory = this.componentFactoryResolver.resolveComponentFactory(comType);
        /** @type {?} */
        var componentRef = viewContainerRef.createComponent(componentFactory);
        //create and insert in one call
        /** @type {?} */
        var componentInstance = (/** @type {?} */ (componentRef.instance));
        componentInstance.inputData = id;
        componentInstance.setFocus();
        componentInstance.done.subscribe(function (val) {
            if (val) {
                componentInstance.done.unsubscribe();
                viewContainerRef.clear();
            }
            /** @type {?} */
            var outputData = componentInstance.outputData;
            if (outputData) {
                switch (outputData.action) {
                    case "selected":
                        if (_this.arrayFields.some(function (x) { return x[0] == fieldName; })) {
                            _this.detail[fieldName]['selection'].push(outputData.value);
                            /** @type {?} */
                            var values = [];
                            if (_this.detail[fieldName]['value'])
                                values = _this.detail[fieldName]['value'].split(' | ');
                            values.push(outputData.value.value); //display value
                            values = values.filter(function (x) { return !!x; });
                            _this.detail[fieldName]['value'] = values.join(' | ');
                        }
                        else if (_this.referenceFields.includes(fieldName)) {
                            _this.detail[fieldName] = outputData.value;
                        }
                        //trigger extraInfo populate, once reference changed.
                        _this.extraInfoPopulate();
                        break;
                    case "back":
                        _this.onRefSelect(fieldName);
                        break;
                    default:
                        break;
                }
            }
        });
    };
    //ElementRef
    /**
     * @return {?}
     */
    BaseComponent.prototype.setFocus = 
    //ElementRef
    /**
     * @return {?}
     */
    function () {
        if (this.focusEl)
            this.focusEl.nativeElement.focus();
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.uiCloseModal = /**
     * @return {?}
     */
    function () {
        this.outputData = null;
        this.done.emit(true);
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.uiOnEscapeKey = /**
     * @return {?}
     */
    function () {
        this.uiCloseModal();
    };
    /**
     * @param {?} num
     * @return {?}
     */
    BaseComponent.prototype.selectItemSelected = /**
     * @param {?} num
     * @return {?}
     */
    function (num) {
        /** @type {?} */
        var detail = this.list[num];
        this.selectedId = detail['_id'];
        this.clickedId = detail['_id'];
        this.outputData = { action: "selected",
            value: { "_id": detail["_id"], "value": this.stringify(detail) },
            detail: detail
        };
        this.done.emit(true);
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.detailSelSelected = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var detail = this.detail;
        this.outputData = { action: "selected",
            value: { "_id": detail["_id"], "value": this.stringify(detail) },
            detail: detail
        };
        this.done.emit(true);
    };
    /**
     * @param {?} num
     * @return {?}
     */
    BaseComponent.prototype.selectViewDetail = /**
     * @param {?} num
     * @return {?}
     */
    function (num) {
        /** @type {?} */
        var detail = this.list[num];
        this.clickedId = detail['_id'];
        this.outputData = { action: "view",
            value: detail["_id"]
        };
        this.done.emit(true);
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.detailSelBack = /**
     * @return {?}
     */
    function () {
        this.outputData = { action: "back",
            value: null
        };
        this.done.emit(true);
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.toggleMoreSearch = /**
     * @return {?}
     */
    function () {
        this.moreSearchOpened = !this.moreSearchOpened;
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.onSearchTextClear = /**
     * @return {?}
     */
    function () {
        this.searchText = undefined;
        if (!this.moreSearchOpened)
            this.searchList();
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.onSearchClear = /**
     * @return {?}
     */
    function () {
        this.searchText = undefined;
        /** @type {?} */
        var detail = {};
        this.detail = this.formatDetail(detail);
        this.searchList();
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.extraFieldsUnload = /**
     * @protected
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.textEditors) {
            this.textEditors.forEach(function (editor) {
                /** @type {?} */
                var fieldName = editor.name;
                /** @type {?} */
                var validatorObj = _this.textEditorMap[fieldName];
                if (!validatorObj)
                    return;
                /** @type {?} */
                var content = _this.detail[validatorObj.fieldName];
                if (content)
                    editor.setContent(content);
            });
        }
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.extraFieldsLoad = /**
     * @protected
     * @return {?}
     */
    function () {
        var e_23, _a;
        //to server
        /** @type {?} */
        var result = true;
        if (this.textEditors) {
            /** @type {?} */
            var array = this.textEditors.toArray();
            try {
                for (var array_1 = tslib_1.__values(array), array_1_1 = array_1.next(); !array_1_1.done; array_1_1 = array_1.next()) {
                    var editor = array_1_1.value;
                    /** @type {?} */
                    var fieldName = editor.name;
                    var _b = tslib_1.__read(editor.getContent(), 2), content = _b[0], text = _b[1];
                    /** @type {?} */
                    var validatorObj = this.textEditorMap[fieldName];
                    if (!validatorObj)
                        continue;
                    /** @type {?} */
                    var fieldState = validatorObj.fieldState;
                    fieldState.errors = {};
                    if (!content) {
                        if (validatorObj.required) {
                            fieldState.errors.required = true;
                            fieldState.valid = false;
                            result = false;
                        }
                        continue;
                    }
                    if ('minlength' in validatorObj && text.length < validatorObj.minlength) {
                        fieldState.valid = false;
                        fieldState.errors.minlength = true;
                        result = false;
                        continue;
                    }
                    if ('maxlength' in validatorObj && text.length > validatorObj.maxlength) {
                        fieldState.valid = false;
                        fieldState.errors.maxlength = true;
                        result = false;
                        continue;
                    }
                    if ('validators' in validatorObj) {
                        /** @type {?} */
                        var error = validatorObj['validators'].validateValue(text);
                        if (error) {
                            fieldState.valid = false;
                            fieldState.errors = error;
                            result = false;
                            continue;
                        }
                    }
                    fieldState.valid = true;
                    fieldState.errors = undefined;
                    this.detail[validatorObj.fieldName] = content;
                }
            }
            catch (e_23_1) { e_23 = { error: e_23_1 }; }
            finally {
                try {
                    if (array_1_1 && !array_1_1.done && (_a = array_1.return)) _a.call(array_1);
                }
                finally { if (e_23) throw e_23.error; }
            }
        }
        return result;
    };
    /**
     * @param {?} editorName
     * @return {?}
     */
    BaseComponent.prototype.onEdtiorPreview = /**
     * @param {?} editorName
     * @return {?}
     */
    function (editorName) {
        if (this.textEditors)
            this.textEditors.forEach(function (editor) {
                if (editor.name == editorName)
                    editor.preview();
            });
    };
    /*Parent router related*/
    /*Parent router related*/
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.getParentRouteItem = /*Parent router related*/
    /**
     * @protected
     * @return {?}
     */
    function () {
        /** @type {?} */
        var routeSnapshot = this.route.snapshot;
        /** @type {?} */
        var parentItem;
        do {
            if (routeSnapshot.data && routeSnapshot.data.mraLevel == 1) {
                parentItem = routeSnapshot.data.item;
                break;
            }
            routeSnapshot = routeSnapshot.parent;
        } while (routeSnapshot);
        return parentItem;
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.getParentRouteItemId = /**
     * @protected
     * @return {?}
     */
    function () {
        /** @type {?} */
        var routeSnapshot = this.route.snapshot;
        /** @type {?} */
        var parentItemId;
        do {
            if (routeSnapshot.data && routeSnapshot.data.mraLevel == 1 && ('id' in routeSnapshot.params)) {
                parentItemId = routeSnapshot.params.id;
                break;
            }
            routeSnapshot = routeSnapshot.parent;
        } while (routeSnapshot);
        return parentItemId;
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.getParentRouteRefField = /**
     * @protected
     * @return {?}
     */
    function () {
        /** @type {?} */
        var mp = this.referenceFieldsMap;
        for (var prop in mp) {
            if (mp.hasOwnProperty(prop) && mp[prop] == this.parentItem) {
                return prop;
            }
        }
    };
    /**
     * @protected
     * @return {?}
     */
    BaseComponent.prototype.getParentActivatedRouter = /**
     * @protected
     * @return {?}
     */
    function () {
        /** @type {?} */
        var route = this.route;
        do {
            /** @type {?} */
            var data = route.snapshot.data;
            //all route inside the mra system will have mraLevel data item
            if (!data.mraLevel)
                return route;
            route = route.parent;
        } while (route);
        return this.route.root;
    };
    /*Sub detail show flag*/
    /*Sub detail show flag*/
    /**
     * @param {?} i
     * @return {?}
     */
    BaseComponent.prototype.toggleCheckedItem = /*Sub detail show flag*/
    /**
     * @param {?} i
     * @return {?}
     */
    function (i) {
        this.checkedItem[i] = !this.checkedItem[i];
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.onAdd = /**
     * @return {?}
     */
    function () {
        this.isAdding = true;
    };
    /**
     * @return {?}
     */
    BaseComponent.prototype.toggleAdd = /**
     * @return {?}
     */
    function () {
        this.isAdding = !this.isAdding;
    };
    /**
     * @param {?} result
     * @return {?}
     */
    BaseComponent.prototype.onAddDone = /**
     * @param {?} result
     * @return {?}
     */
    function (result) {
        this.isAdding = false;
        if (result) { //add successful. Re-populate the current list
            if (this.view == ViewType.LIST) {
                this.populateList();
            }
        }
        else {
            ; //do nothing
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    BaseComponent.prototype.onDateSelectionToggle = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.detail[fn]['pop'] = !this.detail[fn]['pop'];
    };
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    BaseComponent.prototype.onDateSelection = /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    function (fn, date) {
        if (!this.detail[fn]['from'] && !this.detail[fn]['to']) {
            this.detail[fn]['from'] = date;
        }
        else if (this.detail[fn]['from'] && !this.detail[fn]['to'] && date.after(this.detail[fn]['from'])) {
            this.detail[fn]['to'] = date;
            this.detail[fn]['pop'] = false; //Finished. hide the selection 
        }
        else {
            this.detail[fn]['to'] = null;
            this.detail[fn]['from'] = date;
        }
    };
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    BaseComponent.prototype.isHovered = /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    function (fn, date) {
        return this.detail[fn]['from'] && !this.detail[fn]['to'] && this.hoveredDate && date.after(this.detail[fn]['from']) && date.before(this.hoveredDate);
    };
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    BaseComponent.prototype.isInside = /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    function (fn, date) {
        return date.after(this.detail[fn]['from']) && date.before(this.detail[fn]['to']);
    };
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    BaseComponent.prototype.isRange = /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    function (fn, date) {
        return date.equals(this.detail[fn]['from']) || date.equals(this.detail[fn]['to']) || this.isInside(fn, date) || this.isHovered(fn, date);
    };
    return BaseComponent;
}());
export { BaseComponent };
if (false) {
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.objectKeys;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype.storage;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.list;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.majorUi;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.eventEmitter;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.page;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.per_page;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.total_count;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.total_pages;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype.new_page;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.pages;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.left_more;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.right_more;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.checkAll;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.checkedItem;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.detail;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype._detail;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype._extra;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.id;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.subEdit;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.enums;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.stringFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.referenceFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.referenceFieldsMap;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.dateFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.indexFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.multiSelectionFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.arrayFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.mapFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.dateFormat;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.timeFormat;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.hiddenFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.ItemCamelName;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.itemName;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.parentItem;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.refreshing;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.commonService;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.clickedId;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.refSelectDirective;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.selectComponents;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.componentFactoryResolver;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype.componentSubscription;
    /** @type {?} */
    BaseComponent.prototype.inputData;
    /** @type {?} */
    BaseComponent.prototype.outputData;
    /** @type {?} */
    BaseComponent.prototype.done;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.focusEl;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.selectedId;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.searchText;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.searchMoreDetail;
    /** @type {?} */
    BaseComponent.prototype.moreSearchOpened;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.textEditors;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.textEditorMap;
    /**
     * Any View - add new component in the current view
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.isAdding;
    /** @type {?} */
    BaseComponent.prototype.hoveredDate;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.service;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.injector;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.router;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.route;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.location;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.view;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.itemCamelName;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9tZWFuLXJlc3QtYW5ndWxhci8iLCJzb3VyY2VzIjpbImJhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsT0FBTyxFQUFZLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQU92RCxPQUFPLEVBQWUsS0FBSyxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBQ2pELE9BQU8sRUFBa0IsUUFBUSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDMUQsT0FBTyxFQUFvQixVQUFVLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUVoRSxPQUFPLEVBQWUsWUFBWSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0QsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFFcEQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLGNBQWMsQ0FBQzs7O0lBR2hDLE9BQUk7SUFDSixTQUFNO0lBQ04sT0FBSTs7Ozs7O0FBR1IsT0FBTyxFQUFDLFlBQVksRUFBQyxDQUFDO0FBRXRCO0lBdURJLHVCQUNjLE9BQW9CLEVBQ3BCLFFBQWtCLEVBQ2xCLE1BQWMsRUFDZCxLQUFxQixFQUNyQixRQUFrQixFQUNsQixJQUFjLEVBQ2QsYUFBcUI7UUFOckIsWUFBTyxHQUFQLE9BQU8sQ0FBYTtRQUNwQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLFdBQU0sR0FBTixNQUFNLENBQVE7UUFDZCxVQUFLLEdBQUwsS0FBSyxDQUFnQjtRQUNyQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLFNBQUksR0FBSixJQUFJLENBQVU7UUFDZCxrQkFBYSxHQUFiLGFBQWEsQ0FBUTtRQTdEekIsZUFBVSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFFM0IsWUFBTyxHQUFPLEVBQUUsQ0FBQzs7UUFHZixTQUFJLEdBQVMsRUFBRSxDQUFDO1FBRWhCLFlBQU8sR0FBRyxJQUFJLENBQUM7UUFDZixp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Ozs7OztJQUMxQixzQ0FBaUM7Ozs7OztJQTRIakMsaUNBQW9DOztJQW1CcEMsb0NBQWlCOzs7OztJQXI2Q2IsZ0NBQThCOzs7OztJQUM5QixpQ0FBNEI7Ozs7O0lBQzVCLCtCQUF3Qjs7Ozs7SUFDeEIsOEJBQStCOzs7OztJQUMvQixpQ0FBNEI7Ozs7O0lBQzVCLDZCQUF3Qjs7Ozs7SUFDeEIsc0NBQStCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm91dGVyLCBBY3RpdmF0ZWRSb3V0ZSwgUGFyYW1NYXAgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgSW5qZWN0b3IsIEV2ZW50RW1pdHRlciB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuaW1wb3J0IHsgTW9kYWxDb25maWcsIE1vZGFsfSBmcm9tICcuL3V0aWwubW9kYWwnO1xuaW1wb3J0IHsgU25hY2tCYXJDb25maWcsIFNuYWNrQmFyfSBmcm9tICcuL3V0aWwuc25hY2tiYXInO1xuaW1wb3J0IHsgRXJyb3JUb2FzdENvbmZpZywgRXJyb3JUb2FzdH0gZnJvbSAnLi91dGlsLmVycm9ydG9hc3QnO1xuXG5pbXBvcnQgeyBCYXNlU2VydmljZSwgU2VydmljZUVycm9yIH0gZnJvbSAnLi9iYXNlLnNlcnZpY2UnO1xuaW1wb3J0IHsgTXJhQ29tbW9uU2VydmljZSB9IGZyb20gJy4vY29tbW9uLnNlcnZpY2UnO1xuaW1wb3J0IHsgQmFzZUNvbXBvbmVudEludGVyZmFjZSB9IGZyb20gJy4vYmFzZS5pbnRlcmZhY2UnO1xuaW1wb3J0IHsgVXRpbCB9IGZyb20gJy4vdXRpbC50b29scyc7XG5cbmV4cG9ydCBlbnVtIFZpZXdUeXBlIHtcbiAgICBMSVNULFxuICAgIERFVEFJTCxcbiAgICBFRElULFxufVxuXG5leHBvcnQge1NlcnZpY2VFcnJvcn07XG5cbmV4cG9ydCBjbGFzcyBCYXNlQ29tcG9uZW50IGltcGxlbWVudHMgQmFzZUNvbXBvbmVudEludGVyZmFjZSB7XG4gICAgcHJvdGVjdGVkIG9iamVjdEtleXMgPSBPYmplY3Qua2V5cztcbiAgXG4gICAgcHJpdmF0ZSBzdG9yYWdlOmFueSA9IHt9O1xuXG4gICAgLy9Gb3IgbGlzdCBhbmQgcGFnaW5hdGlvblxuICAgIHByb3RlY3RlZCBsaXN0OmFueVtdID0gW107XG4gICAgICAgIFxuICAgIHByb3RlY3RlZCBtYWpvclVpID0gdHJ1ZTtcbiAgICBwcm90ZWN0ZWQgZXZlbnRFbWl0dGVyOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBcbiAgICBwcm90ZWN0ZWQgcGFnZTogbnVtYmVyID0gMTtcbiAgICBwcm90ZWN0ZWQgcGVyX3BhZ2U6IG51bWJlciA9IDI1O1xuICAgIHByb3RlY3RlZCB0b3RhbF9jb3VudDogbnVtYmVyID0gMDtcbiAgICBwcm90ZWN0ZWQgdG90YWxfcGFnZXM6IG51bWJlciA9IDA7XG4gICAgXG4gICAgcHJpdmF0ZSBuZXdfcGFnZTtcbiAgICBcbiAgICBwcm90ZWN0ZWQgcGFnZXM6IG51bWJlcltdID0gW107XG4gICAgcHJvdGVjdGVkIGxlZnRfbW9yZTpib29sZWFuID0gZmFsc2U7XG4gICAgcHJvdGVjdGVkIHJpZ2h0X21vcmU6Ym9vbGVhbiA9IGZhbHNlO1xuXG4gICAgcHJvdGVjdGVkIGNoZWNrQWxsID0gZmFsc2U7XG4gICAgLy91c2VkIHRvIG1hcmsgZGVsZXRlZCBpdGVtcywgb3IgaXRlbXMgdGhhdCB3aWxsIHNob3cgc3ViLWRldGFpbCwgZXRjLlxuICAgIHByb3RlY3RlZCBjaGVja2VkSXRlbTpib29sZWFuW10gPSBbXTtcbiAgICBcbiAgICAvL0ZvciBlZGl0IGFuZCB2aWV3IGRldGFpbHNcbiAgICBwcm90ZWN0ZWQgZGV0YWlsOmFueSA9IHt9O1xuICAgIHByaXZhdGUgX2RldGFpbDphbnkgPSB7fTsgLy9hIGNsb25lIGFuZCB1c2VkIHRvIHNlbmQvcmVjZWl2ZSBmcm9tIG5leHQgd29ya1xuICAgIHByaXZhdGUgX2V4dHJhOmFueSA9IHt9OyAvL2V4dHJhIGluZm8uXG4gICAgcHJvdGVjdGVkIGlkOnN0cmluZztcbiAgICBwcm90ZWN0ZWQgc3ViRWRpdCA9IGZhbHNlOyAvL2EgZWRpdC1zdWIgY29tcG9uZW50XG4gICAgLy9mb3IgZmllbGRzIHdpdGggZW51bSB2YWx1ZXNcbiAgICBwcm90ZWN0ZWQgZW51bXM6YW55ID0ge307XG4gICAgcHJvdGVjdGVkIHN0cmluZ0ZpZWxkcyA9IFtdO1xuICAgIHByb3RlY3RlZCByZWZlcmVuY2VGaWVsZHM6IHN0cmluZ1tdID0gW107XG4gICAgcHJvdGVjdGVkIHJlZmVyZW5jZUZpZWxkc01hcCA9IHt9O1xuICAgIHByb3RlY3RlZCBkYXRlRmllbGRzID0gW107XG4gICAgcHJvdGVjdGVkIGluZGV4RmllbGRzID0gW107XG4gICAgcHJvdGVjdGVkIG11bHRpU2VsZWN0aW9uRmllbGRzID0gW107XG4gICAgcHJvdGVjdGVkIGFycmF5RmllbGRzID0gW107IC8vZWxlbWVudCBpcyBbZmllbGROYW1lLCBlbGVtZW50VHlwZV1cbiAgICBwcm90ZWN0ZWQgbWFwRmllbGRzID0gW107IC8vZWxlbWVudCBpcyBbZmllbGROYW1lLCBlbGVtZW50VHlwZSwgbWFwS2V5XVxuICAgIHByb3RlY3RlZCBkYXRlRm9ybWF0ID0gXCJNTS9ERC9ZWVlZXCI7XG4gICAgcHJvdGVjdGVkIHRpbWVGb3JtYXQgPSBcImhoOm1tOnNzXCI7XG5cbiAgICBwcm90ZWN0ZWQgaGlkZGVuRmllbGRzID0gW107IC8vZmllbGRzIGhpZGUgZnJvbSB2aWV3LiBDdXJycmVudGx5IHVzZWQgYnkgXCJBZGRcIiB2aWV3IG9mIGVkaXQtc3ViXG5cbiAgICBwcm90ZWN0ZWQgSXRlbUNhbWVsTmFtZTogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBpdGVtTmFtZTogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBwYXJlbnRJdGVtOiBzdHJpbmc7XG4gIFxuICAgIHByb3RlY3RlZCByZWZyZXNoaW5nOiBib29sZWFuID0gZmFsc2U7XG4gIFxuICAgIHByb3RlY3RlZCBjb21tb25TZXJ2aWNlOiBNcmFDb21tb25TZXJ2aWNlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByb3RlY3RlZCBzZXJ2aWNlOiBCYXNlU2VydmljZSxcbiAgICAgICAgcHJvdGVjdGVkIGluamVjdG9yOiBJbmplY3RvcixcbiAgICAgICAgcHJvdGVjdGVkIHJvdXRlcjogUm91dGVyLFxuICAgICAgICBwcm90ZWN0ZWQgcm91dGU6IEFjdGl2YXRlZFJvdXRlLFxuICAgICAgICBwcm90ZWN0ZWQgbG9jYXRpb246IExvY2F0aW9uLFxuICAgICAgICBwcm90ZWN0ZWQgdmlldzogVmlld1R5cGUsXG4gICAgICAgIHByb3RlY3RlZCBpdGVtQ2FtZWxOYW1lOiBzdHJpbmcpIHtcbiAgICAgIFxuICAgICAgICB0aGlzLkl0ZW1DYW1lbE5hbWUgPSBpdGVtQ2FtZWxOYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgaXRlbUNhbWVsTmFtZS5zdWJzdHIoMSk7XG4gICAgICAgIHRoaXMuaXRlbU5hbWUgPSBpdGVtQ2FtZWxOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHRoaXMucGFyZW50SXRlbSA9IHRoaXMuZ2V0UGFyZW50Um91dGVJdGVtKCk7XG4gICAgICAgIHRoaXMuY29tbW9uU2VydmljZSA9IGluamVjdG9yLmdldChNcmFDb21tb25TZXJ2aWNlKTtcbiAgICAgICAgXG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBvblNlcnZpY2VFcnJvcihlcnJvcjpTZXJ2aWNlRXJyb3IpOnZvaWQge1xuICAgICAgICAvL2NsZWFyIGFueSBwZW5kaW5nIGZsYWdzXG4gICAgICAgIHRoaXMucmVmcmVzaGluZyA9IGZhbHNlO1xuICAgICAgXG4gICAgICAgIGxldCBlcnJNc2c6c3RyaW5nO1xuICAgICAgICBsZXQgbW9yZTpzdHJpbmc7XG4gICAgICAgIGlmIChlcnJvci5jbGllbnRFcnJvck1zZykge1xuICAgICAgICAgICAgZXJyTXNnID0gZXJyb3IuY2xpZW50RXJyb3JNc2c7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoZXJyb3Iuc2VydmVyRXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvci5zdGF0dXMgPT0gNDAxKSAgcmV0dXJuOyAvL0Rvbid0IHNob3cgdW5hdXRob3JpemVkIGVycm9yXG4gICAgICAgICAgICBpZiAodHlwZW9mIGVycm9yLnNlcnZlckVycm9yID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGVyck1zZyA9IGVycm9yLnN0YXR1cyArIFwiOiBcIiArIEpTT04uc3RyaW5naWZ5KGVycm9yLnNlcnZlckVycm9yKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZXJyTXNnID0gZXJyb3Iuc3RhdHVzICsgXCI6IFwiICtlcnJvci5zZXJ2ZXJFcnJvcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmluZm8oXCJFcnJvcjogXCIgKyBlcnJNc2cpO1xuICAgICAgICBpZiAoIWVyck1zZykgZXJyTXNnID0gXCJVbmtub3duIGVycm9yLlwiO1xuICAgICAgICBpZiAoZXJyTXNnLmxlbmd0aCA+IDgwKSB7XG4gICAgICAgICAgICBtb3JlID0gZXJyTXNnO1xuICAgICAgICAgICAgZXJyTXNnID0gZXJyTXNnLnN1YnN0cmluZygwLCA4MCkgKyBcIi4uLlwiO1xuICAgICAgICB9XG4gICAgICAgIGxldCBlcnJvclRvYXN0Q29uZmlnOiBFcnJvclRvYXN0Q29uZmlnID0ge1xuICAgICAgICAgICAgY29udGVudDogZXJyTXNnLFxuICAgICAgICAgICAgbW9yZTogbW9yZVxuICAgICAgICB9XG4gICAgICAgIGxldCBlcnJvclRvYXN0ID0gbmV3IEVycm9yVG9hc3QoZXJyb3JUb2FzdENvbmZpZyk7XG4gICAgICAgIGVycm9yVG9hc3Quc2hvdygpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBwb3B1bGF0ZVBhZ2VzKCk6dm9pZCB7ICAgICAgICBcbiAgICAgICAgdGhpcy5wYWdlcyA9IFtdXG4gICAgICAgIGNvbnN0IFNIT1dfUEFHRSA9IDk7XG4gICAgICAgIGNvbnN0IEhBTEYgPSAoU0hPV19QQUdFLTEpLzI7XG4gICAgICAgIFxuICAgICAgICBsZXQgbWluLCBtYXg7XG4gICAgICAgIGlmICh0aGlzLnRvdGFsX3BhZ2VzIDw9IFNIT1dfUEFHRSkge1xuICAgICAgICAgICAgbWluID0gMTtcbiAgICAgICAgICAgIG1heCA9IHRoaXMudG90YWxfcGFnZXM7XG4gICAgICAgICAgICB0aGlzLmxlZnRfbW9yZSA9IGZhbHNlOyBcbiAgICAgICAgICAgIHRoaXMucmlnaHRfbW9yZSA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFnZSAtIDEgPCBIQUxGKSB7XG4gICAgICAgICAgICAgICAgbWluID0gMTtcbiAgICAgICAgICAgICAgICBtYXggPSBTSE9XX1BBR0UtMTtcbiAgICAgICAgICAgICAgICB0aGlzLmxlZnRfbW9yZSA9IGZhbHNlOyBcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0X21vcmUgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRvdGFsX3BhZ2VzIC0gdGhpcy5wYWdlIDwgSEFMRikge1xuICAgICAgICAgICAgICAgIG1heCA9IHRoaXMudG90YWxfcGFnZXM7XG4gICAgICAgICAgICAgICAgbWluID0gKHRoaXMudG90YWxfcGFnZXMgLSBTSE9XX1BBR0UgKyAxKSArIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0X21vcmUgPSB0cnVlOyBcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0X21vcmUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWluID0gdGhpcy5wYWdlIC0gSEFMRiArIDE7XG4gICAgICAgICAgICAgICAgbWF4ID0gdGhpcy5wYWdlICsgSEFMRiAtIDE7XG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0X21vcmUgPSB0cnVlOyBcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0X21vcmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSBtaW47IGkgPD0gbWF4OyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMucGFnZXMucHVzaChpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBwcml2YXRlIGdldEtleShrZXk6c3RyaW5nKTpzdHJpbmcge1xuICAgICAgICBsZXQgdXJsID0gdGhpcy5yb3V0ZXIudXJsLnNwbGl0KCc7JylbMF0uc3BsaXQoJz8nKVswXTtcbiAgICAgICAgcmV0dXJuIHVybCsgXCI6XCIgKyBrZXk7XG4gICAgfVxuICAgIHByaXZhdGUgcHV0VG9TdG9yYWdlKGtleTpzdHJpbmcsIHZhbHVlOmFueSk6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLm1ham9yVWkpIHtcbiAgICAgICAgICAgIC8vb25seSBtYWpvciBVSSB3ZSB3YW50IHRvIGNhY2hlIGFuZCByZWNvdmVyIHdoZW4gdXNlciBjb21lcyBiYWNrXG4gICAgICAgICAgICB0aGlzLmNvbW1vblNlcnZpY2UucHV0VG9TdG9yYWdlKHRoaXMuZ2V0S2V5KGtleSksIHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcmFnZVtrZXldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJpdmF0ZSBnZXRGcm9tU3RvcmFnZShrZXk6c3RyaW5nKTphbnkge1xuICAgICAgICBpZiAodGhpcy5tYWpvclVpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb21tb25TZXJ2aWNlLmdldEZyb21TdG9yYWdlKHRoaXMuZ2V0S2V5KGtleSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RvcmFnZVtrZXldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgcm91dGVUb1BhZ2UocGFnZTpudW1iZXIpOnZvaWQge1xuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcInBhZ2VcIiwgcGFnZSk7XG4gICAgICAgIHRoaXMucG9wdWxhdGVMaXN0KCk7XG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBvbk5leHRQYWdlKCk6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnBhZ2UgPj0gdGhpcy50b3RhbF9wYWdlcykgcmV0dXJuO1xuICAgICAgICB0aGlzLnJvdXRlVG9QYWdlKHRoaXMucGFnZSArIDEpO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgb25QcmV2aW91c1BhZ2UoKTp2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMucGFnZSA8PSAxKSByZXR1cm47XG4gICAgICAgIHRoaXMucm91dGVUb1BhZ2UodGhpcy5wYWdlIC0gMSk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG9uR290b1BhZ2UocDpudW1iZXIpOnZvaWQge1xuICAgICAgICBpZiAocCA+IHRoaXMudG90YWxfcGFnZXMgfHwgcCA8IDEpIHJldHVybjtcbiAgICAgICAgdGhpcy5yb3V0ZVRvUGFnZShwKVxuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgZ29CYWNrKCkge1xuICAgICAgICB0aGlzLmxvY2F0aW9uLmJhY2soKTtcbiAgICAgICAgLypcbiAgICAgICAgLy8gd2luZG93Lmhpc3RvcnkuYmFjaygpO1xuICAgICAgICBpZiAodGhpcy52aWV3ICE9IFZpZXdUeXBlLkVESVQpXG4gICAgICAgICAgICB0aGlzLmxvY2F0aW9uLmJhY2soKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZXQgdXJsID0gdGhpcy5sb2NhdGlvbi5wYXRoKCk7IC8vaW4gRURJVCB2aWV3LCB0aGUgY3VycmVudCB1cmwgaXMgc2tpcHBlZC4gU28gZ2V0IHRoZSBcInByZXZpb3VzXCIgb25lIGZyb20gcGF0aC5cbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwodXJsKTtcbiAgICAgICAgfVxuICAgICAgICAqL1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgc3RyaW5naWZ5KGRldGFpbDphbnkpOiBzdHJpbmcge1xuICAgICAgICBsZXQgc3RyID0gXCJcIjtcbiAgICAgICAgZm9yIChsZXQgZm5tIG9mIHRoaXMuaW5kZXhGaWVsZHMpIHtcbiAgICAgICAgICAgIGlmIChkZXRhaWxbZm5tXSAmJiB0eXBlb2YgZGV0YWlsW2ZubV0gIT0gJ29iamVjdCcpIHN0ciArPSBcIiBcIiArIGRldGFpbFtmbm1dO1xuICAgICAgICB9XG4gICAgICAgIGlmICghc3RyKSAge1xuICAgICAgICAgICAgZm9yIChsZXQgcHJvcCBpbiBkZXRhaWwpIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvcCAhPT0gJ19pZCcgJiYgZGV0YWlsW3Byb3BdICYmIHR5cGVvZiBkZXRhaWxbcHJvcF0gIT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgc3RyICs9IFwiIFwiICsgZGV0YWlsW3Byb3BdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0cikgc3RyID0gZGV0YWlsW1wiX2lkXCJdP2RldGFpbFtcIl9pZFwiXTpcIi4uLlwiXG4gICAgICAgIHN0ciA9IHN0ci5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJylcbiAgICAgICAgaWYgKHN0ci5sZW5ndGggPiAzMCkgc3RyID0gc3RyLnN1YnN0cigwLCAyNykgKyAnLi4uJztcbiAgICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gIFxuICAgIC8qKipTdGFydDogaGFuZGxlIHJlZmVyZW5jZSBmaWVsZHMqKiovXG4gICAgcHJvdGVjdGVkIGZvcm1hdFJlZmVyZW5jZUZpZWxkKGZpZWxkOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nICk6YW55IHtcbiAgICAgICAgbGV0IGlkLCB2YWx1ZTtcbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgLy9hc3N1bWUgdGhpcyBpcyB0aGUgXCJfaWRcIiwgbGV0IHNlZSB3ZSBoYXZlIHRoZSBjYWNoZWQgZGV0YWlscyBmb3IgdGhpcyByZWYgZnJvbSBzZXJ2aWNlXG4gICAgICAgICAgICBsZXQgcmVmRGV0YWlsID0gdGhpcy5jb21tb25TZXJ2aWNlLmdldEZyb21TdG9yYWdlKGZpZWxkKTtcbiAgICAgICAgICAgIGlmIChyZWZEZXRhaWwgJiYgKHR5cGVvZiByZWZEZXRhaWwgPT0gJ29iamVjdCcpKSBmaWVsZCA9IHJlZkRldGFpbDtcbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlkID0gZmllbGQ7XG4gICAgICAgICAgICAgICAgZmllbGQgPSB7J19pZCc6IGlkfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChmaWVsZCAmJiAodHlwZW9mIGZpZWxkID09ICdvYmplY3QnKSApIHtcbiAgICAgICAgICAgIGlkID0gZmllbGRbJ19pZCddO1xuICAgICAgICAgICAgbGV0IHJlZmVySW5kZXggPSAnJztcbiAgICAgICAgICAgIGZvciAobGV0IGsgaW4gIGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGsgIT0gJ19pZCcpIHJlZmVySW5kZXggKz0gXCIgXCIgKyBmaWVsZFtrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlZmVySW5kZXggPSByZWZlckluZGV4LnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcbiAgICAgICAgICAgIGlmIChyZWZlckluZGV4Lmxlbmd0aCA+PSAyMCkgcmVmZXJJbmRleCA9IHJlZmVySW5kZXguc3Vic3RyaW5nKDAsIDIwKSArIFwiLi4uXCI7XG4gICAgICAgICAgICBmaWVsZCA9IHsnX2lkJzogaWQsICd2YWx1ZSc6IHJlZmVySW5kZXg/IHJlZmVySW5kZXg6IGZpZWxkTmFtZX07XG4gICAgICAgIH0gZWxzZSB7Ly9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgZmllbGQgPSB7J19pZCc6IGlkLCAndmFsdWUnOiB2YWx1ZX07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgZm9ybWF0UmVmZXJlbmNlKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBmbm0gb2YgdGhpcy5yZWZlcmVuY2VGaWVsZHMpIHtcbiAgICAgICAgICAgIGRldGFpbFtmbm1dID0gdGhpcy5mb3JtYXRSZWZlcmVuY2VGaWVsZChkZXRhaWxbZm5tXSwgZm5tKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgZGVGb3JtYXRSZWZlcmVuY2UoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IGZubSBvZiB0aGlzLnJlZmVyZW5jZUZpZWxkcykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXRhaWxbZm5tXSAhPT0gJ29iamVjdCcpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgICAgIC8vbGV0IGRhdGUgdmFsdWVzIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IGlkID0gZGV0YWlsW2ZubV1bJ19pZCddO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaWQgIT09ICdzdHJpbmcnKSBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICAgICAgZWxzZSBkZXRhaWxbZm5tXSA9IGlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXRhaWw7XG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBjbGVhckZpZWxkUmVmZXJlbmNlKGZpZWxkOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IHByb3AgaW4gZmllbGQpIHtcbiAgICAgICAgICAgIGZpZWxkW3Byb3BdID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaXNEZWZpbmVkRmllbGRSZWZlcmVuY2UoZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKCdfaWQnIGluIGZpZWxkICYmIHR5cGVvZiBmaWVsZFsnX2lkJ10gPT0gJ3N0cmluZycpIHJldHVybiB0cnVlO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKipTdGFydDogaGFuZGxlIGRhdGUgZmllbGRzKioqLyAgICBcbiAgICBwcm90ZWN0ZWQgZm9ybWF0RGF0ZUZpZWxkKGZpZWxkOnN0cmluZyk6YW55IHtcbiAgICAgICAgbGV0IGZtdCA9IHRoaXMuZGF0ZUZvcm1hdDtcbiAgICAgICAgbGV0IHRfZm10ID0gdGhpcy50aW1lRm9ybWF0O1xuICAgICAgICBsZXQgZCwgTSwgeXl5eSwgaCwgbSwgcztcblxuICAgICAgICBsZXQgZHQgPSBuZXcgRGF0ZShmaWVsZCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGQsIE1NLCBoaCwgbW0sIHNzO1xuICAgICAgICBkID0gZHQuZ2V0RGF0ZSgpO1xuICAgICAgICBNID0gZHQuZ2V0TW9udGgoKSsxOyBcbiAgICAgICAgeXl5eSA9IGR0LmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgeXkgPSB5eXl5LnRvU3RyaW5nKCkuc2xpY2UoMik7XG4gICAgICAgIGggPSBkdC5nZXRIb3VycygpO1xuICAgICAgICBtID0gZHQuZ2V0TWludXRlcygpO1xuICAgICAgICBzID0gZHQuZ2V0U2Vjb25kcygpO1xuICAgICAgICBcbiAgICAgICAgZGQ9IGQ8MTA/ICcwJytkOiBkLnRvU3RyaW5nKCk7XG4gICAgICAgIE1NPSBNPDEwPyAnMCcrTTogTS50b1N0cmluZygpO1xuICAgICAgICBoaD0gaDwxMD8gJzAnK2g6IGgudG9TdHJpbmcoKTtcbiAgICAgICAgbW09IG08MTA/ICcwJyttOiBtLnRvU3RyaW5nKCk7XG4gICAgICAgIHNzPSBzPDEwPyAnMCcrczogcy50b1N0cmluZygpO1xuICAgICAgICBcbiAgICAgICAgbGV0IHZhbHVlID0gZm10LnJlcGxhY2UoL3l5eXkvaWcsIHl5eXkudG9TdHJpbmcoKSkuXG4gICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoL3l5L2lnLCB5eS50b1N0cmluZygpKS5cbiAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZSgvTU0vZywgTU0udG9TdHJpbmcoKSkuXG4gICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoL2RkL2lnLCBkZC50b1N0cmluZygpKTtcbiAgICAgIFxuICAgICAgICBsZXQgdF92YWx1ZSA9IHRfZm10LnJlcGxhY2UoL2hoL2lnLCBoaC50b1N0cmluZygpKS5cbiAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZSgvbW0vZywgbW0udG9TdHJpbmcoKSkuXG4gICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoL3NzL2lnLCBzcy50b1N0cmluZygpKTtcbiAgICAgICAgLypEYXRlcGlja2VyIHVzZXMgTmdiRGF0ZVN0cnVjdCBhcyBhIG1vZGVsIGFuZCBub3QgdGhlIG5hdGl2ZSBEYXRlIG9iamVjdC4gXG4gICAgICAgIEl0J3MgYSBzaW1wbGUgZGF0YSBzdHJ1Y3R1cmUgd2l0aCAzIGZpZWxkcy4gQWxzbyBub3RlIHRoYXQgbW9udGhzIHN0YXJ0IHdpdGggMSAoYXMgaW4gSVNPIDg2MDEpLlxuICAgICAgICBcbiAgICAgICAgd2UgYWRkIGgsIG0sIHMgaGVyZVxuICAgICAgICAqL1xuICAgICAgICAvL1wiZnJvbVwiIGFuZCBcInRvXCIgdXNlZCBmb3Igc2VhcmNoIGNvbnRleHQuIHBvcDogc2hvdyB0aGUgc2VsZWN0aW9uIHBvcHVwXG4gICAgICAgIHJldHVybiB7J2RhdGUnOnsgZGF5OiBkLCBtb250aDogTSwgeWVhcjogeXl5eX0sICd2YWx1ZSc6IHZhbHVlLCAnZnJvbSc6IHVuZGVmaW5lZCwgJ3RvJzogdW5kZWZpbmVkLCAncG9wJzpmYWxzZSxcbiAgICAgICAgICAgICAgICAndGltZSc6eyBob3VyOiBoLCBtaW51dGU6IG0sIHNlY29uZDogc30sICd0X3ZhbHVlJzogdmFsdWUsICd0X2Zyb20nOiB1bmRlZmluZWQsICd0X3RvJzogdW5kZWZpbmVkLCAndF9wb3AnOmZhbHNlfVxuXG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBmb3JtYXREYXRlKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBmbm0gb2YgdGhpcy5kYXRlRmllbGRzKSB7XG4gICAgICAgICAgICBsZXQgdmFsdWUsIGRhdGU7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRldGFpbFtmbm1dICE9PSAnc3RyaW5nJykgeyAvL25vdCBkZWZpbmVkXG4gICAgICAgICAgICAgICAgLy9pbXBvcnRhbnQ6IGxldCBkYXRlIHZhbHVlcyB1bmRlZmluZWQuIFwiZnJvbVwiIGFuZCBcInRvXCIgdXNlZCBmb3Igc2VhcmNoIGNvbnRleHQuIHBvcDogc2hvdyB0aGUgc2VsZWN0aW9uIHBvcHVwXG4gICAgICAgICAgICAgICAgZGV0YWlsW2ZubV0gPSB7J2RhdGUnOnVuZGVmaW5lZCwgJ3ZhbHVlJzogdW5kZWZpbmVkLCAnZnJvbSc6IHVuZGVmaW5lZCwgJ3RvJzogdW5kZWZpbmVkLCAncG9wJzpmYWxzZX07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZXRhaWxbZm5tXSA9IHRoaXMuZm9ybWF0RGF0ZUZpZWxkKGRldGFpbFtmbm1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgZGVGb3JtYXREYXRlRmllbGQoZGF0ZTphbnkpOnN0cmluZyB7XG4gICAgICAgIGxldCBkLCBNLCB5eXl5LCBoLCBtLCBzO1xuICAgICAgICBcbiAgICAgICAgeXl5eSA9IGRhdGUueWVhcjtcbiAgICAgICAgTSA9IGRhdGUubW9udGggLSAxO1xuICAgICAgICBkID0gZGF0ZS5kYXk7XG4gICAgICAgIFxuICAgICAgICBpZiAodHlwZW9mIHl5eXkgIT09ICdudW1iZXInIHx8IHR5cGVvZiBNICE9PSAnbnVtYmVyJyB8fCB0eXBlb2YgZCAhPT0gJ251bWJlcicpIHJldHVybiBudWxsO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGxldCBkdCA9IG5ldyBEYXRlKHl5eXksIE0sIGQsIDAsIDAsIDAsIDApO1xuICAgICAgICAgICAgcmV0dXJuIGR0LnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIGRlRm9ybWF0RGF0ZShkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZm5tIG9mIHRoaXMuZGF0ZUZpZWxkcykge1xuICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXRhaWxbZm5tXSAhPT0gJ29iamVjdCcpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgICAgIC8vbGV0IGRhdGUgdmFsdWVzIHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghIGRldGFpbFtmbm1dLmRhdGUpIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGVTdHIgPSB0aGlzLmRlRm9ybWF0RGF0ZUZpZWxkKGRldGFpbFtmbm1dLmRhdGUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWRhdGVTdHIpIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBkZXRhaWxbZm5tXSA9IGRhdGVTdHI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXRhaWw7XG4gICAgfVxuICAgIHByb3RlY3RlZCBjbGVhckZpZWxkRGF0ZShmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBwcm9wIGluIGZpZWxkKSB7XG4gICAgICAgICAgICBmaWVsZFtwcm9wXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxuICAgIHByb3RlY3RlZCBpc0RlZmluZWRGaWVsZERhdGUoZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZpZWxkWydkYXRlJ10gPT0gJ29iamVjdCcpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGRbJ2Zyb20nXSA9PSAnb2JqZWN0JykgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZFsndG8nXSA9PSAnb2JqZWN0JykgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKipTdGFydDogaGFuZGxlIGFycmF5IG9mIG11bHRpLXNlbGVjdGlvbiBmaWVsZHMqKiovXG4gICAgcHJvdGVjdGVkIGZvcm1hdEFycmF5TXVsdGlTZWxlY3Rpb25GaWVsZChmaWVsZDogYW55LCBlbnVtczogYW55KTogYW55IHtcbiAgICAgICAgbGV0IHNlbGVjdE9iaiA9IHt9O1xuICAgICAgICBsZXQgdmFsdWUgPSBcIlwiO1xuICAgICAgICBmb3IgKGxldCBlIG9mIGVudW1zKSB7XG4gICAgICAgICAgICBzZWxlY3RPYmpbZV0gPSBmYWxzZTsgLy9ub3QgZXhpc3RcbiAgICAgICAgfVxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWVsZCkpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgZm9yIChsZXQgZSBvZiBmaWVsZCkge1xuICAgICAgICAgICAgICAgIHNlbGVjdE9ialtlXSA9IHRydWU7ICAvL2V4aXN0LlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWUgPSBmaWVsZC5qb2luKFwiIHwgXCIpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsnc2VsZWN0aW9uJzogc2VsZWN0T2JqLCB2YWx1ZTogdmFsdWV9O1xuXG4gICAgfVxuICAgIHByb3RlY3RlZCBmb3JtYXRBcnJheU11bHRpU2VsZWN0aW9uKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBmbm0gb2YgdGhpcy5tdWx0aVNlbGVjdGlvbkZpZWxkcykge1xuICAgICAgICAgICAgZGV0YWlsW2ZubV0gPSB0aGlzLmZvcm1hdEFycmF5TXVsdGlTZWxlY3Rpb25GaWVsZChkZXRhaWxbZm5tXSwgdGhpcy5lbnVtc1tmbm1dKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgZGVGb3JtYXRBcnJheU11bHRpU2VsZWN0aW9uKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBmbm0gb2YgdGhpcy5tdWx0aVNlbGVjdGlvbkZpZWxkcykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXRhaWxbZm5tXSAhPT0gJ29iamVjdCcpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgICAgIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghIGRldGFpbFtmbm1dLnNlbGVjdGlvbikgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0QXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSBvZiB0aGlzLmVudW1zW2ZubV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZXRhaWxbZm5tXS5zZWxlY3Rpb25bZV0pIHNlbGVjdEFycmF5LnB1c2goZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0QXJyYXkubGVuZ3RoID4gMCkgZGV0YWlsW2ZubV0gPSBzZWxlY3RBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXRhaWw7XG4gICAgfVxuICAgIHByb3RlY3RlZCBjbGVhckZpZWxkQXJyYXlNdWx0aVNlbGVjdGlvbihmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBpZiAoIWZpZWxkWydzZWxlY3Rpb24nXSkgcmV0dXJuIGZpZWxkO1xuICAgICAgICBmb3IgKGxldCBwcm9wIGluIGZpZWxkWydzZWxlY3Rpb24nXSkge1xuICAgICAgICAgICAgZmllbGRbJ3NlbGVjdGlvbiddW3Byb3BdID0gZmFsc2U7IC8vbm90IGV4aXN0XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBpc0RlZmluZWRGaWVsZEFycmF5TXVsdGlTZWxlY3Rpb24oZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKCdzZWxlY3Rpb24nIGluIGZpZWxkICYmIHR5cGVvZiBmaWVsZFsnc2VsZWN0aW9uJ10gPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMoZmllbGRbJ3NlbGVjdGlvbiddKTtcbiAgICAgICAgICAgIHJldHVybiBrZXlzLnNvbWUoZT0+e3JldHVybiBmaWVsZFsnc2VsZWN0aW9uJ11bZV19KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHByb3RlY3RlZCBtdWx0aXNlbGVjdGlvblNlbGVjdGVkKGZpZWxkTmFtZSkge1xuICAgICAgICBpZiAoIXRoaXMuZGV0YWlsW2ZpZWxkTmFtZV0gfHwgdHlwZW9mIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3NlbGVjdGlvbiddICE9ICdvYmplY3QnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuaXNEZWZpbmVkRmllbGRBcnJheU11bHRpU2VsZWN0aW9uKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV0pO1xuICAgIH1cbiAgICAvKioqRW5kOiBoYW5kbGUgYXJyYXkgb2YgbXVsdGktc2VsZWN0aW9uIGZpZWxkcyoqKi9cbiAgICAvKioqU3RhcnQ6IGhhbmRsZSBtYXAgZmllbGRzKioqL1xuICAgIHByb3RlY3RlZCBmb3JtYXRNYXBGaWVsZChmaWVsZDogYW55LCBlbGVtZW50VHlwZTogc3RyaW5nKTogYW55IHtcbiAgICAgICAgbGV0IHNlbGVjdE9iaiA9IHt9O1xuICAgICAgICBsZXQgdmFsdWVzID0gW107XG4gICAgICAgIGlmICh0eXBlb2YgZmllbGQgPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHNlbGVjdE9iaiA9IGZpZWxkO1xuICAgICAgICAgICAgZm9yIChsZXQgZSBpbiBmaWVsZCkge1xuICAgICAgICAgICAgICBpZiAoZWxlbWVudFR5cGUgPT09ICdTY2hlbWFTdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2goZSArIFwiKFwiICsgZmllbGRbZV0gKyBcIilcIik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YWx1ZXMgPSB2YWx1ZXMuZmlsdGVyKHg9PiEheCk7XG4gICAgICAgIGxldCB2YWx1ZSA9IHZhbHVlcy5qb2luKFwiIHwgXCIpXG4gICAgICAgIHJldHVybiB7J3NlbGVjdGlvbic6IHNlbGVjdE9iaiwgdmFsdWU6IHZhbHVlLCBrZXlzOiBbXX07XG5cbiAgICB9XG4gICAgcHJvdGVjdGVkIGZvcm1hdE1hcEZpZWxkcyhkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZiBvZiB0aGlzLm1hcEZpZWxkcykge1xuICAgICAgICAgICAgLy9bZmllbGROYW1lLCBlbGVtZW50VHlwZV1cbiAgICAgICAgICAgIGRldGFpbFtmWzBdXSA9IHRoaXMuZm9ybWF0TWFwRmllbGQoZGV0YWlsW2ZbMF1dLCBmWzFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBkZUZvcm1hdE1hcEZpZWxkcyhkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZiBvZiB0aGlzLm1hcEZpZWxkcykge1xuICAgICAgICAgICAgLy9bZmllbGROYW1lLCBlbGVtZW50VHlwZV1cbiAgICAgICAgICAgIGxldCBmbm0gPSBmWzBdO1xuICAgICAgICAgICAgbGV0IGVsZW1lbnRUeXBlID0gZlsxXTtcbiAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGV0YWlsW2ZubV0gIT09ICdvYmplY3QnKSB7IC8vbm90IGRlZmluZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoISBkZXRhaWxbZm5tXS5zZWxlY3Rpb24pIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdE1hcCA9IGRldGFpbFtmbm1dLnNlbGVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSBpbiBkZXRhaWxbZm5tXS5zZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudFR5cGUgPT09ICdTY2hlbWFTdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHNlbGVjdE1hcCkubGVuZ3RoID4gMCkgZGV0YWlsW2ZubV0gPSBzZWxlY3RNYXA7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBjbGVhckZpZWxkTWFwKGZpZWxkOmFueSApOmFueSB7XG4gICAgICAgIGlmICghZmllbGRbJ3NlbGVjdGlvbiddKSByZXR1cm4gZmllbGQ7XG4gICAgICAgIGZpZWxkWydzZWxlY3Rpb24nXSA9IHt9O1xuICAgICAgICBmaWVsZC52YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBpc0RlZmluZWRGaWVsZE1hcChmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBpZiAoJ3NlbGVjdGlvbicgaW4gZmllbGQgJiYgdHlwZW9mIGZpZWxkWydzZWxlY3Rpb24nXSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKGZpZWxkWydzZWxlY3Rpb24nXSkubGVuZ3RoID4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHByb3RlY3RlZCBtYXBTZWxlY3RlZChmaWVsZE5hbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRldGFpbFtmaWVsZE5hbWVdIHx8IHR5cGVvZiB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWydzZWxlY3Rpb24nXSAhPSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmlzRGVmaW5lZEZpZWxkTWFwKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV0pO1xuICAgIH1cbiAgICAvKioqRW5kOiBoYW5kbGUgbWFwIGZpZWxkcyoqKi9cbiAgICAvKioqU3RhcnQ6IGhhbmRsZSBhcnJheSBmaWVsZHMqKiovXG4gICAgcHJvdGVjdGVkIGZvcm1hdEFycmF5RmllbGQoZmllbGQ6IGFueSwgZWxlbWVudFR5cGU6IHN0cmluZyk6IGFueSB7XG4gICAgICAgIGxldCBzZWxlY3RBcnJheSA9IFtdO1xuICAgICAgICBsZXQgdmFsdWVzID0gW107XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGZpZWxkKSkgeyAvL25vdCBkZWZpbmVkXG4gICAgICAgICAgICBmb3IgKGxldCBlIG9mIGZpZWxkKSB7XG4gICAgICAgICAgICAgIGlmIChlbGVtZW50VHlwZSA9PT0gJ09iamVjdElkJykge1xuICAgICAgICAgICAgICAgIGxldCByZWYgPSB0aGlzLmZvcm1hdFJlZmVyZW5jZUZpZWxkKGUsIFwiLi4uXCIpO1xuICAgICAgICAgICAgICAgIHNlbGVjdEFycmF5LnB1c2gocmVmKTtcbiAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChyZWYudmFsdWUpO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnRUeXBlID09PSAnU2NoZW1hU3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHNlbGVjdEFycmF5LnB1c2goZSk7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2goZSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YWx1ZXMgPSB2YWx1ZXMuZmlsdGVyKHg9PiEheCk7XG4gICAgICAgIGxldCB2YWx1ZSA9IHZhbHVlcy5qb2luKFwiIHwgXCIpXG4gICAgICAgIHJldHVybiB7J3NlbGVjdGlvbic6IHNlbGVjdEFycmF5LCB2YWx1ZTogdmFsdWV9O1xuXG4gICAgfVxuICAgIHByb3RlY3RlZCBmb3JtYXRBcnJheUZpZWxkcyhkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZiBvZiB0aGlzLmFycmF5RmllbGRzKSB7XG4gICAgICAgICAgICAvL1tmaWVsZE5hbWUsIGVsZW1lbnRUeXBlXVxuICAgICAgICAgICAgZGV0YWlsW2ZbMF1dID0gdGhpcy5mb3JtYXRBcnJheUZpZWxkKGRldGFpbFtmWzBdXSwgZlsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZGVGb3JtYXRBcnJheUZpZWxkcyhkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZiBvZiB0aGlzLmFycmF5RmllbGRzKSB7XG4gICAgICAgICAgICAvL1tmaWVsZE5hbWUsIGVsZW1lbnRUeXBlXVxuICAgICAgICAgICAgbGV0IGZubSA9IGZbMF07XG4gICAgICAgICAgICBsZXQgZWxlbWVudFR5cGUgPSBmWzFdO1xuICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXRhaWxbZm5tXSAhPT0gJ29iamVjdCcpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgICAgIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICghIGRldGFpbFtmbm1dLnNlbGVjdGlvbikgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0QXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgZSBvZiBkZXRhaWxbZm5tXS5zZWxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudFR5cGUgPT09ICdPYmplY3RJZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlICYmIGVbJ19pZCddICYmIHR5cGVvZiBlWydfaWQnXSA9PT0gJ3N0cmluZycpIHNlbGVjdEFycmF5LnB1c2goZVsnX2lkJ10pO1xuICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudFR5cGUgPT09ICdTY2hlbWFTdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkgc2VsZWN0QXJyYXkucHVzaChlKTtcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0QXJyYXkubGVuZ3RoID4gMCkgZGV0YWlsW2ZubV0gPSBzZWxlY3RBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXRhaWw7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNsZWFyRmllbGRBcnJheShmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBpZiAoIWZpZWxkWydzZWxlY3Rpb24nXSkgcmV0dXJuIGZpZWxkO1xuICAgICAgICBmaWVsZFsnc2VsZWN0aW9uJ10gPSBbXTtcbiAgICAgICAgZmllbGQudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaXNEZWZpbmVkRmllbGRBcnJheShmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBpZiAoJ3NlbGVjdGlvbicgaW4gZmllbGQgJiYgQXJyYXkuaXNBcnJheShmaWVsZFsnc2VsZWN0aW9uJ10pKSB7XG4gICAgICAgICAgICByZXR1cm4gZmllbGRbJ3NlbGVjdGlvbiddLmxlbmd0aCA+IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgYXJyYXlTZWxlY3RlZChmaWVsZE5hbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRldGFpbFtmaWVsZE5hbWVdIHx8ICFBcnJheS5pc0FycmF5KHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3NlbGVjdGlvbiddKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmlzRGVmaW5lZEZpZWxkQXJyYXkodGhpcy5kZXRhaWxbZmllbGROYW1lXSk7XG4gICAgfVxuICAgIC8qKipFbmQ6IGhhbmRsZSBhcnJheSBmaWVsZHMqKiovXG4gIFxuICAgIHByb3RlY3RlZCBmb3JtYXREZXRhaWwoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGRldGFpbCA9IHRoaXMuZm9ybWF0UmVmZXJlbmNlKGRldGFpbCk7XG4gICAgICAgIGRldGFpbCA9IHRoaXMuZm9ybWF0RGF0ZShkZXRhaWwpO1xuICAgICAgICBkZXRhaWwgPSB0aGlzLmZvcm1hdEFycmF5TXVsdGlTZWxlY3Rpb24oZGV0YWlsKTtcbiAgICAgICAgZGV0YWlsID0gdGhpcy5mb3JtYXRBcnJheUZpZWxkcyhkZXRhaWwpO1xuICAgICAgICBkZXRhaWwgPSB0aGlzLmZvcm1hdE1hcEZpZWxkcyhkZXRhaWwpO1xuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH0gICAgXG4gICAgXG4gICAgcHJvdGVjdGVkIGRlRm9ybWF0RGV0YWlsKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBsZXQgY3B5ID0gVXRpbC5jbG9uZShkZXRhaWwpO1xuICAgICAgICBcbiAgICAgICAgY3B5ID0gdGhpcy5kZUZvcm1hdFJlZmVyZW5jZShjcHkpO1xuICAgICAgICBjcHkgPSB0aGlzLmRlRm9ybWF0RGF0ZShjcHkpO1xuICAgICAgICBjcHkgPSB0aGlzLmRlRm9ybWF0QXJyYXlNdWx0aVNlbGVjdGlvbihjcHkpO1xuICAgICAgICBjcHkgPSB0aGlzLmRlRm9ybWF0QXJyYXlGaWVsZHMoY3B5KTtcbiAgICAgICAgY3B5ID0gdGhpcy5kZUZvcm1hdE1hcEZpZWxkcyhjcHkpO1xuICAgICAgICByZXR1cm4gY3B5O1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgcG9wdWxhdGVEZXRhaWwoaWQ6IHN0cmluZyk6RXZlbnRFbWl0dGVyPGFueT4ge1xuICAgICAgcmV0dXJuIHRoaXMucG9wdWxhdGVEZXRhaWxGb3JBY3Rpb24oaWQsIG51bGwpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBwb3B1bGF0ZURldGFpbEZvckFjdGlvbihpZDogc3RyaW5nLCBhY3Rpb246IHN0cmluZyk6RXZlbnRFbWl0dGVyPGFueT4ge1xuICAgICAgLy9hY3Rpb246IGVnOiBhY3Rpb249ZWRpdCAgLT4gZ2V0IGRldGFpbCBmb3IgZWRpdGluZyBwdXJwb3NlIFxuICAgICAgdGhpcy5zZXJ2aWNlLmdldERldGFpbEZvckFjdGlvbihpZCwgYWN0aW9uKS5zdWJzY3JpYmUoXG4gICAgICAgIGRldGFpbCA9PiB7XG4gICAgICAgICAgICBsZXQgb3JpZ2luYWxEZXRhaWwgPSBVdGlsLmNsb25lKGRldGFpbCk7XG4gICAgICAgICAgICBpZiAoZGV0YWlsW1wiX2lkXCJdKSB0aGlzLmNvbW1vblNlcnZpY2UucHV0VG9TdG9yYWdlKGRldGFpbFtcIl9pZFwiXSwgb3JpZ2luYWxEZXRhaWwpOy8vY2FjaGUgaXRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5kZXRhaWwgPSB0aGlzLmZvcm1hdERldGFpbChkZXRhaWwpO1xuICAgICAgICAgICAgdGhpcy5leHRyYUZpZWxkc1VubG9hZCgpOy8vdW5sb2FkIGRhdGEgdG8gdGV4dCBlZGl0b3JzLCBldGNcbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT0gJ2VkaXQnKSB7XG4gICAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTsvL2NvbGxlY3Qgb3RoZXIgaW5mbyByZXF1aXJlZCBmb3IgZWRpdCB2aWV3XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5yZWZyZXNoaW5nKSB7XG4gICAgICAgICAgICAgIHRoaXMucmVmcmVzaGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICBsZXQgc25hY2tCYXJDb25maWc6IFNuYWNrQmFyQ29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgY29udGVudDogXCJEZXRhaWwgcmVmcmVzaGVkXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBsZXQgc25hY2tCYXIgPSBuZXcgU25hY2tCYXIoc25hY2tCYXJDb25maWcpO1xuICAgICAgICAgICAgICBzbmFja0Jhci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmV2ZW50RW1pdHRlci5lbWl0KHRoaXMuZGV0YWlsKTtcbiAgICAgICAgfSxcbiAgICAgICAgdGhpcy5vblNlcnZpY2VFcnJvclxuICAgICAgKTtcbiAgICAgIHJldHVybiB0aGlzLmV2ZW50RW1pdHRlcjtcbiAgICB9XG4gICAgXG5cbiAgICBwcm90ZWN0ZWQgcG9wdWxhdGVEZXRhaWxGcm9tQ29weShjb3B5X2lkOnN0cmluZyk6dm9pZCB7XG4gICAgICB0aGlzLnNlcnZpY2UuZ2V0RGV0YWlsKGNvcHlfaWQpLnN1YnNjcmliZShcbiAgICAgICAgZGV0YWlsID0+IHsgICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsID0gdGhpcy5mb3JtYXREZXRhaWwoZGV0YWlsKTtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmRldGFpbFtcIl9pZFwiXTtcbiAgICAgICAgICAgIHRoaXMuZXh0cmFGaWVsZHNVbmxvYWQoKTsvL3VubG9hZCBkYXRhIHRvIHRleHQgZWRpdG9ycywgZXRjXG4gICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7Ly9jb2xsZWN0IG90aGVyIGluZm8gcmVxdWlyZWQgZm9yIGNyZWF0ZSB2aWV3XG4gICAgICAgIH0sXG4gICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGV4dHJhSW5mb1BvcHVsYXRlKCkge1xuICAgICAgICBmb3IgKGxldCBmaWVsZERlZiBvZiB0aGlzLm1hcEZpZWxkcykgeyBcbiAgICAgICAgICAvL2ZpZWxkRGVmOiBbZmllbGQuZmllbGROYW1lLCBmaWVsZC5lbGVtZW50VHlwZSwga2V5VHlwZSwga2V5UmVmTmFtZSwga2V5UmVmU2VydmljZSwga2V5UmVmU3ViRmllbGRdXG4gICAgICAgICAgbGV0IGZpZWxkTmFtZSA9IGZpZWxkRGVmWzBdOyAvL3RoaXMuPGtleVJlZk5hbWU+LjxrZXlSZWZTdWJGaWVsZD5cbiAgICAgICAgICBsZXQgbWFwS2V5VHlwZSA9IGZpZWxkRGVmWzJdOyAvL3RoaXMuPGtleVJlZk5hbWU+LjxrZXlSZWZTdWJGaWVsZD5cbiAgICAgICAgICBsZXQga2V5QXJyYXkgPSBbXTtcbiAgICAgICAgICBpZiAobWFwS2V5VHlwZSA9PSBcIk9iamVjdElkXCIpIHtcbiAgICAgICAgICAgIGxldCBrZXlSZWZOYW1lID0gZmllbGREZWZbM107XG4gICAgICAgICAgICBsZXQgcmVjb3JkS2V5ID0gJ2tleS1pZC0nICsga2V5UmVmTmFtZTtcbiAgICAgICAgICAgIGxldCByZWZTZXJ2aWNlID0gdGhpcy5pbmplY3Rvci5nZXQoZmllbGREZWZbNF0pO1xuICAgICAgICAgICAgbGV0IGlkID0gdGhpcy5kZXRhaWxba2V5UmVmTmFtZV0/dGhpcy5kZXRhaWxba2V5UmVmTmFtZV1bJ19pZCddIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgaWYgKCFpZCkgY29udGludWU7XG4gICAgICAgICAgICBsZXQgbWFwRmllbGQgPSB0aGlzLmRldGFpbFtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgaWYgKG1hcEZpZWxkW3JlY29yZEtleV0gPT0gaWQpIGNvbnRpbnVlOyAvL2FscmVhZHkgcG9wdWxhdGVkIGZvciB0aGUgc2FtZSBpZFxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZWZTZXJ2aWNlLmdldERldGFpbChpZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICBkZXRhaWwgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRldGFpbFtmaWVsZERlZls1XV0pKSB7XG4gICAgICAgICAgICAgICAgICBrZXlBcnJheSA9IGRldGFpbFtmaWVsZERlZls1XV07XG4gICAgICAgICAgICAgICAgICBtYXBGaWVsZFsna2V5cyddID0ga2V5QXJyYXk7XG4gICAgICAgICAgICAgICAgICBtYXBGaWVsZFtyZWNvcmRLZXldID0gaWQ7IC8vcmVjb3JkIHRoYXQga2V5cyBpcyBwb3B1bGF0ZWQgZnJvbSB0aGlzIG9iamVjdFxuICAgICAgICAgICAgICAgICAgaWYgKG1hcEZpZWxkWydzZWxlY3Rpb24nXSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBrIG9mIGtleUFycmF5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKCEoayBpbiBtYXBGaWVsZFsnc2VsZWN0aW9uJ10pKSBtYXBGaWVsZFsnc2VsZWN0aW9uJ11ba10gPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0aGlzLm9uU2VydmljZUVycm9yXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gICAgICAgICAgXG4gICAgICAgIH1cbiAgICB9XG4gIFxuICAgIHByaXZhdGUgZXF1YWxUd29TZWFyY2hDb250ZXh0QXJyYXlzIChhcnIxLCBhcnIyKSB7XG4gICAgICBpZiAoIWFycjEpIGFycjEgPSBbXTtcbiAgICAgIGlmICghYXJyMikgYXJyMiA9IFtdO1xuICAgICAgaWYgKGFycjEubGVuZ3RoID09IDAgJiYgYXJyMi5sZW5ndGggPT0gMCkgcmV0dXJuIHRydWU7XG4gICAgICAvL2FsbCBvYmplY3QgaW4gYXJyYXkgaGFzIGZvcm1hdCBvZiB7J2ZpZWxkJzogJ3ZhbHVlJ30gZm9ybWF0XG4gICAgICBmdW5jdGlvbiBjb21wYXJlT2JqKGEsIGIpIHtcbiAgICAgICAgICBsZXQgYV9zID0gSlNPTi5zdHJpbmdpZnkoYSksIGJfcyA9IEpTT04uc3RyaW5naWZ5KGIpXG4gICAgICAgICAgaWYgKGFfcyA8IGJfcylcbiAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgIGlmIChhX3MgPiBiX3MpXG4gICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgfVxuICAgICAgYXJyMSA9IGFycjEuc29ydChjb21wYXJlT2JqKTtcbiAgICAgIGFycjIgPSBhcnIyLnNvcnQoY29tcGFyZU9iaik7XG4gICAgICBpZiAoSlNPTi5zdHJpbmdpZnkoYXJyMSkgPT0gSlNPTi5zdHJpbmdpZnkoYXJyMikpIHJldHVybiB0cnVlO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBwcm9jZXNzU2VhcmNoQ29udGV4dCgpIHtcbiAgICAgICAgdGhpcy5tb3JlU2VhcmNoT3BlbmVkID0gZmFsc2U7XG4gICAgICAgIGxldCBkID0gdGhpcy5kZXRhaWw7XG4gICAgICAgIGZvciAobGV0IHMgb2YgdGhpcy5zdHJpbmdGaWVsZHMpIHtcbiAgICAgICAgICAgIGRbc10gPSB0aGlzLnNlYXJjaFRleHQ7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG9yU2VhcmNoQ29udGV4dCA9IFtdLCBhbmRTZWFyY2hDb250ZXh0ID0gW107XG4gICAgICAgIGZvciAobGV0IGZpZWxkIGluIGQpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZFtmaWVsZF0gPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBsZXQgbyA9IHt9XG4gICAgICAgICAgICAgICAgb1tmaWVsZF0gPSBkW2ZpZWxkXTtcbiAgICAgICAgICAgICAgICBvclNlYXJjaENvbnRleHQucHVzaChvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhpcy5zZWFyY2hNb3JlRGV0YWlsID0gW11cbiAgICAgICAgbGV0IGQyID0gdGhpcy5kZUZvcm1hdERldGFpbChkKTsvL3VuZGVmaW5lZCBmaWVsZCBpcyBkZWxldGVkIGFmdGVyIHRoaXMgc3RlcFxuICAgICAgICBmb3IgKGxldCBmaWVsZCBpbiBkMikge1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RyaW5nRmllbGRzLmluZGV4T2YoZmllbGQpID09IC0xKSB7Ly9zdHJpbmcgZmllbGRzIGFscmVhZHkgcHV0IHRvIG9yU2VhcmNoQ29udGV4dFxuICAgICAgICAgICAgICAgIGxldCBvID0ge31cbiAgICAgICAgICAgICAgICBsZXQgdmFsdWVUb1Nob3c7XG5cbiAgICAgICAgICAgICAgICBvW2ZpZWxkXSA9IGQyW2ZpZWxkXTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLm11bHRpU2VsZWN0aW9uRmllbGRzLmluY2x1ZGVzKGZpZWxkKSkge1xuICAgICAgICAgICAgICAgICAgICBvW2ZpZWxkXSA9IHskaW46IGQyW2ZpZWxkXX07IC8vdXNlICRpbiBmb3Igb3IsIGFuZCAkYWxsIGZvciBhbmRcblxuICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IHRoaXMuZm9ybWF0QXJyYXlNdWx0aVNlbGVjdGlvbkZpZWxkKGQyW2ZpZWxkXSwgdGhpcy5lbnVtc1tmaWVsZF0pO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZVRvU2hvdyA9IHQudmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFycmF5RmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZCkpIHsgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgb1tmaWVsZF0gPSB7JGluOiBkMltmaWVsZF19OyAvL3VzZSAkaW4gZm9yIG9yLCBhbmQgJGFsbCBmb3IgYW5kXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVUb1Nob3cgPSBkW2ZpZWxkXVsndmFsdWUnXTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0ZUZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHQgPSB0aGlzLmZvcm1hdERhdGVGaWVsZChkMltmaWVsZF0pO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZVRvU2hvdyA9IHQudmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlZmVyZW5jZUZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVUb1Nob3cgPSB2YWx1ZVRvU2hvdyA9IGRbZmllbGRdWyd2YWx1ZSddO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlVG9TaG93ID0gZFtmaWVsZF07Ly90YWtlIGRpcmVjdG95IGZyb20gd2hhdCB3ZSBnZXQgXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hNb3JlRGV0YWlsLnB1c2goW2ZpZWxkLCB2YWx1ZVRvU2hvd10pO1xuICAgICAgICAgICAgICAgIGFuZFNlYXJjaENvbnRleHQucHVzaChvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvL0hhbmRsZSBkYXRlIHJhbmdlIHNlbGVjdGlvbi4gVGhlc2UgZmllbGRzIGFyZSBub3QgaW4gZDIsIGJlY2F1c2UgZmllbGQuZGF0ZSBpcyB1bmRlZmluZWQuXG4gICAgICAgIGZvciAobGV0IHByb3Agb2YgdGhpcy5kYXRlRmllbGRzKSB7XG4gICAgICAgICAgICBsZXQgbyA9IHt9O1xuICAgICAgICAgICAgbGV0IHZhbHVlVG9TaG93ID0gXCJcIjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgb1twcm9wXSA9IHt9O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkW3Byb3BdICE9PSAnb2JqZWN0JykgeyAvL25vdCBkZWZpbmVkXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWRbcHJvcF1bJ2Zyb20nXSAmJiAhZFtwcm9wXVsndG8nXSkgeyAvL25vdCByYW5nZVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGRbcHJvcF1bJ2Zyb20nXSkge1xuICAgICAgICAgICAgICAgIG9bcHJvcF1bJ2Zyb20nXSA9IHRoaXMuZGVGb3JtYXREYXRlRmllbGQoZFtwcm9wXVsnZnJvbSddKTtcbiAgICAgICAgICAgICAgICB2YWx1ZVRvU2hvdyArPSB0aGlzLmZvcm1hdERhdGVGaWVsZChvW3Byb3BdWydmcm9tJ10pLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVUb1Nob3cgKz0gXCIgfiBcIjtcbiAgICAgICAgICAgIGlmIChkW3Byb3BdWyd0byddKSB7XG4gICAgICAgICAgICAgICAgb1twcm9wXVsndG8nXSA9IHRoaXMuZGVGb3JtYXREYXRlRmllbGQoZFtwcm9wXVsndG8nXSk7XG4gICAgICAgICAgICAgICAgdmFsdWVUb1Nob3cgKz0gdGhpcy5mb3JtYXREYXRlRmllbGQob1twcm9wXVsndG8nXSkudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnNlYXJjaE1vcmVEZXRhaWwucHVzaChbcHJvcCwgdmFsdWVUb1Nob3ddKTtcbiAgICAgICAgICAgIGFuZFNlYXJjaENvbnRleHQucHVzaChvKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzZWFyY2hDb250ZXh0ID0geyckYW5kJzogW3snJG9yJzogb3JTZWFyY2hDb250ZXh0fSx7JyRhbmQnOiBhbmRTZWFyY2hDb250ZXh0fV19O1xuICAgICAgICAvKiBzZWFyY2hDb250ZXh0ID17JyRhbmQnLCBbeyckb3InLCBbXX0seyckYW5kJywgW119XX1cbiAgICAgICAgKi9cbiAgICAgICAgbGV0IGNvbnRleHQgPSB0aGlzLmdldEZyb21TdG9yYWdlKFwic2VhcmNoQ29udGV4dFwiKTtcbiAgICAgICAgaWYgKGNvbnRleHQgJiYgY29udGV4dFtcIiRhbmRcIl0pIHtcbiAgICAgICAgICAgIGxldCBjYWNoZWRPciwgY2FjaGVkQW5kO1xuICAgICAgICAgICAgZm9yIChsZXQgc3ViIG9mIGNvbnRleHRbXCIkYW5kXCJdKSB7XG4gICAgICAgICAgICAgICAgaWYgKCckYW5kJyBpbiBzdWIpIGNhY2hlZEFuZCA9IHN1YlsnJGFuZCddO1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCckb3InIGluIHN1YikgY2FjaGVkT3IgPSBzdWJbJyRvciddO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuZXF1YWxUd29TZWFyY2hDb250ZXh0QXJyYXlzKGNhY2hlZE9yLCBvclNlYXJjaENvbnRleHQpIFxuICAgICAgICAgICAgICAgICYmIHRoaXMuZXF1YWxUd29TZWFyY2hDb250ZXh0QXJyYXlzKGNhY2hlZEFuZCwgYW5kU2VhcmNoQ29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gXG4gICAgICAgIFxuICAgICAgICBpZiAob3JTZWFyY2hDb250ZXh0Lmxlbmd0aCA9PSAwICYmIGFuZFNlYXJjaENvbnRleHQubGVuZ3RoID09IDApIHNlYXJjaENvbnRleHQgPSBudWxsO1xuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcInNlYXJjaENvbnRleHRcIiwgc2VhcmNoQ29udGV4dCk7XG4gICAgICAgIHRoaXMucHV0VG9TdG9yYWdlKFwic2VhcmNoVGV4dFwiLCB0aGlzLnNlYXJjaFRleHQpO1xuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcInBhZ2VcIiwgMSk7Ly9zdGFydCBmcm9tIDFzdCBwYWdlXG4gICAgICAgIHRoaXMucHV0VG9TdG9yYWdlKFwic2VhcmNoTW9yZURldGFpbFwiLCB0aGlzLnNlYXJjaE1vcmVEZXRhaWwpO1xuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcImRldGFpbFwiLCB0aGlzLmRldGFpbCk7XG4gICAgfVxuICAgIHByb3RlY3RlZCBzZWFyY2hMaXN0KCk6dm9pZCB7XG4gICAgICAgIHRoaXMucHJvY2Vzc1NlYXJjaENvbnRleHQoKTtcbiAgICAgICAgLy91cGRhdGUgdGhlIFVSTFxuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy4nLCB7fV0sIHtyZWxhdGl2ZVRvOiB0aGlzLnJvdXRlfSk7Ly9zdGFydCBmcm9tIDFzdCBwYWdlXG4gICAgICAgIHRoaXMucHV0VG9TdG9yYWdlKFwicGFnZVwiLCAxKTsvL3N0YXJ0IGZyb20gMXN0IHBhZ2VcbiAgICAgICAgdGhpcy5wb3B1bGF0ZUxpc3QoKTtcbiAgICB9XG4gICAgcHJvdGVjdGVkIGxvYWRVSUZyb21DYWNoZSgpOnZvaWQge1xuICAgICAgICAvL05vdyBsZXQncyByZWxvYWQgdGhlIHNlYXJjaCBjb25kaXRpb24gdG8gVUlcbiAgICAgICAgdGhpcy5zZWFyY2hUZXh0ID0gdGhpcy5nZXRGcm9tU3RvcmFnZShcInNlYXJjaFRleHRcIik7XG4gICAgICAgIHRoaXMuc2VhcmNoTW9yZURldGFpbCA9IHRoaXMuZ2V0RnJvbVN0b3JhZ2UoXCJzZWFyY2hNb3JlRGV0YWlsXCIpO1xuICAgICAgICBsZXQgZGV0YWlsID0gdGhpcy5nZXRGcm9tU3RvcmFnZShcImRldGFpbFwiKTtcbiAgICAgICAgaWYgKGRldGFpbCkgdGhpcy5kZXRhaWwgPSBkZXRhaWw7XG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBwb3B1bGF0ZUxpc3QoKTpFdmVudEVtaXR0ZXI8YW55PiB7XG4gICAgICAgIC8vRmlyc3QgbGV0J3MgaGFuZGxlIHBhZ2VcbiAgICAgICAgbGV0IG5ld19wYWdlO1xuICAgICAgICBsZXQgc2VhcmNoQ29udGV4dCwgc2VhcmNoVGV4dDtcblxuICAgICAgICBsZXQgdXJsX3BhZ2UgPSBwYXJzZUludCh0aGlzLnJvdXRlLnNuYXBzaG90LnBhcmFtTWFwLmdldCgncGFnZScpKTtcbiAgICAgICAgbGV0IGNhY2hlZF9wYWdlID0gcGFyc2VJbnQodGhpcy5nZXRGcm9tU3RvcmFnZShcInBhZ2VcIikpO1xuICAgICAgICAgICAgXG4gICAgICAgIGlmIChjYWNoZWRfcGFnZSkgeyBcbiAgICAgICAgICAgIG5ld19wYWdlID0gY2FjaGVkX3BhZ2U7XG4gICAgICAgICAgICBpZiAoY2FjaGVkX3BhZ2UgPT0gMSlcbiAgICAgICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy4nLCB7fV0sIHtyZWxhdGl2ZVRvOiB0aGlzLnJvdXRlLCB9KTsvL3VwZGF0ZSB0aGUgdXJsXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuJywge3BhZ2U6IGNhY2hlZF9wYWdlfV0sIHtyZWxhdGl2ZVRvOiB0aGlzLnJvdXRlLCB9KTsvL3VwZGF0ZSB0aGUgdXJsXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodXJsX3BhZ2UpIG5ld19wYWdlID0gdXJsX3BhZ2U7XG4gICAgICAgIGVsc2UgbmV3X3BhZ2UgPSAxO1xuXG4gICAgICAgIHNlYXJjaENvbnRleHQgPSB0aGlzLmdldEZyb21TdG9yYWdlKFwic2VhcmNoQ29udGV4dFwiKTtcbiAgICAgICAgdGhpcy5sb2FkVUlGcm9tQ2FjaGUoKTsgICAgICBcblxuICAgICAgICB0aGlzLnNlcnZpY2UuZ2V0TGlzdChuZXdfcGFnZSwgdGhpcy5wZXJfcGFnZSwgc2VhcmNoQ29udGV4dCkuc3Vic2NyaWJlKFxuICAgICAgICAgIHJlc3VsdCA9PiB7IFxuICAgICAgICAgICAgdGhpcy5saXN0ID0gcmVzdWx0Lml0ZW1zLm1hcCh4PT50aGlzLmZvcm1hdERldGFpbCh4KSk7XG4gICAgICAgICAgICB0aGlzLnBhZ2UgPSByZXN1bHQucGFnZTtcbiAgICAgICAgICAgIHRoaXMucGVyX3BhZ2UgPSByZXN1bHQucGVyX3BhZ2U7XG4gICAgICAgICAgICB0aGlzLnRvdGFsX2NvdW50ID0gcmVzdWx0LnRvdGFsX2NvdW50O1xuICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlcyA9IHJlc3VsdC50b3RhbF9wYWdlcztcbiAgICAgICAgICAgIHRoaXMucG9wdWxhdGVQYWdlcygpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWRJdGVtID0gXG4gICAgICAgICAgICAgICAgQXJyYXkuYXBwbHkobnVsbCwgQXJyYXkodGhpcy5saXN0Lmxlbmd0aCkpLm1hcChCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLGZhbHNlKTtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tBbGwgPSBmYWxzZTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHRoaXMucmVmcmVzaGluZykge1xuICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgbGV0IHNuYWNrQmFyQ29uZmlnOiBTbmFja0JhckNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwiTGlzdCByZWZyZXNoZWRcIlxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGxldCBzbmFja0JhciA9IG5ldyBTbmFja0JhcihzbmFja0JhckNvbmZpZyk7XG4gICAgICAgICAgICAgIHNuYWNrQmFyLnNob3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZXZlbnRFbWl0dGVyLmVtaXQodGhpcy5saXN0KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICAgKTtcbiAgICAgIHJldHVybiB0aGlzLmV2ZW50RW1pdHRlcjtcbiAgICB9XG4gICAgXG4gICAgXG4gICAgLypVSSBvcGVyYXRpb25zIGhhbmRsZXJzKi9cbiAgICBwdWJsaWMgb25SZWZyZXNoKCk6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcgPT0gVmlld1R5cGUuTElTVCkge1xuICAgICAgICAgIHRoaXMucmVmcmVzaGluZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5wb3B1bGF0ZUxpc3QoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZpZXcgPT0gVmlld1R5cGUuREVUQUlMKSB7XG4gICAgICAgICAgdGhpcy5yZWZyZXNoaW5nID0gdHJ1ZTtcbiAgICAgICAgICBpZiAoIXRoaXMuaWQpIHRoaXMuaWQgPSB0aGlzLnJvdXRlLnNuYXBzaG90LnBhcmFtTWFwLmdldCgnaWQnKTtcbiAgICAgICAgICBpZiAodGhpcy5pZCkgdGhpcy5wb3B1bGF0ZURldGFpbCh0aGlzLmlkKTtcbiAgICAgICAgICBlbHNlIGNvbnNvbGUuZXJyb3IoXCJSb3V0aW5nIGVycm9yIGZvciBkZXRhaWwgdmlldy4uLiBubyBpZC4uLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgb25DaGVja0FsbENoYW5nZSgpOnZvaWQge1xuICAgICAgICB0aGlzLmNoZWNrZWRJdGVtID0gXG4gICAgICAgICAgICAgQXJyYXkuYXBwbHkobnVsbCwgQXJyYXkodGhpcy5saXN0Lmxlbmd0aCkpLlxuICAgICAgICAgICAgICAgIG1hcChCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLHRoaXMuY2hlY2tBbGwpO1xuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgaXNJdGVtU2VsZWN0ZWQoKTpib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tlZEl0ZW0uc29tZSgodmFsdWUpPT57cmV0dXJuIHZhbHVlO30pXG4gICAgfVxuXG4gICAgcHVibGljIG9uRGVsZXRlU2VsZWN0ZWQoKTp2b2lkIHtcbiAgICAgICAgbGV0IGRlbGV0ZWRJdGVtID0gW107XG4gICAgICAgIHRoaXMuY2hlY2tlZEl0ZW0uZm9yRWFjaCgodmFsdWUsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZWRJdGVtLnB1c2godGhpcy5saXN0W2luZGV4XVtcIl9pZFwiXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBsZXQgbW9kYWxDb25maWc6IE1vZGFsQ29uZmlnID0ge1xuICAgICAgICB0aXRsZTogXCJEZWxldGUgQ29uZmlybWF0aW9uXCIsXG4gICAgICAgIGNvbnRlbnQ6IFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSBzZWxlY3RlZCBpdGVtcyBmcm9tIHRoZSBzeXN0ZW0/XCIsXG4gICAgICAgIC8vbGlzdCBvZiBidXR0b24gdGV4dFxuICAgICAgICBidXR0b25zOiBbJ0RlbGV0ZScsICdDYW5jZWwnXSxcbiAgICAgICAgLy9saXN0IG9mIGJ1dHRvbiByZXR1cm5zIHdoZW4gY2xpY2tlZFxuICAgICAgICByZXR1cm5zOiBbdHJ1ZSwgZmFsc2VdLFxuICAgICAgICBjYWxsQmFjazogKHJlc3VsdCkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VydmljZS5kZWxldGVNYW55QnlJZHMoZGVsZXRlZEl0ZW0pLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzbmFja0JhckNvbmZpZzogU25hY2tCYXJDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogdGhpcy5JdGVtQ2FtZWxOYW1lICsgXCIgZGVsZXRlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc25hY2tCYXIgPSBuZXcgU25hY2tCYXIoc25hY2tCYXJDb25maWcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc25hY2tCYXIuc2hvdygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52aWV3ICE9IFZpZXdUeXBlLkxJU1QpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuLi8uLi9saXN0J10sIHtyZWxhdGl2ZVRvOiB0aGlzLnJvdXRlfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbGVuID0gdGhpcy5jaGVja2VkSXRlbS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlkeCA9IGxlbiAtIDEgLSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWUgPSB0aGlzLmNoZWNrZWRJdGVtW2lkeF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGVja2VkSXRlbS5zcGxpY2UoaWR4LDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9jb3VudCAtPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblNlcnZpY2VFcnJvclxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBsZXQgbW9kYWwgPSBuZXcgTW9kYWwobW9kYWxDb25maWcpO1xuICAgICAgbW9kYWwuc2hvdygpO1xuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgb25EZWxldGUoaWQ6c3RyaW5nLCBpZHg6IG51bWJlcik6dm9pZCB7ICAgICAgXG4gICAgICBsZXQgbW9kYWxDb25maWc6IE1vZGFsQ29uZmlnID0ge1xuICAgICAgICB0aXRsZTogXCJEZWxldGUgQ29uZmlybWF0aW9uXCIsXG4gICAgICAgIGNvbnRlbnQ6IFwiQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIFwiICsgdGhpcy5pdGVtQ2FtZWxOYW1lICsgXCIgZnJvbSB0aGUgc3lzdGVtP1wiLFxuICAgICAgICAvL2xpc3Qgb2YgYnV0dG9uIHRleHRcbiAgICAgICAgYnV0dG9uczogWydEZWxldGUnLCAnQ2FuY2VsJ10sXG4gICAgICAgIC8vbGlzdCBvZiBidXR0b24gcmV0dXJucyB3aGVuIGNsaWNrZWRcbiAgICAgICAgcmV0dXJuczogW3RydWUsIGZhbHNlXSxcbiAgICAgICAgY2FsbEJhY2s6IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2UuZGVsZXRlT25lKGlkKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc25hY2tCYXJDb25maWc6IFNuYWNrQmFyQ29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuSXRlbUNhbWVsTmFtZSArIFwiIGRlbGV0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNuYWNrQmFyID0gbmV3IFNuYWNrQmFyKHNuYWNrQmFyQ29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNuYWNrQmFyLnNob3coKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmlldyAhPSBWaWV3VHlwZS5MSVNUKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnLi4vLi4vbGlzdCddLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaWR4IT1udWxsICYmIHRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3Quc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZEl0ZW0uc3BsaWNlKGlkeCwxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9jb3VudCAtPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vblNlcnZpY2VFcnJvclxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgbGV0IG1vZGFsID0gbmV3IE1vZGFsKG1vZGFsQ29uZmlnKTtcbiAgICAgIG1vZGFsLnNob3coKTtcbiAgICB9XG4gICAgXG4gICAgcHVibGljIG9uU3VibWl0KCk6dm9pZCB7XG4gICAgICBpZiAoIXRoaXMuZXh0cmFGaWVsZHNMb2FkKCkpIHJldHVybjsgLy9lcnJvciBmcm9tIG90aGVyIG5vbiBuZ01vZGVsIGZpZWxkcztcbiAgICAgICAgXG4gICAgICB0aGlzLl9kZXRhaWwgPSB0aGlzLmRlRm9ybWF0RGV0YWlsKHRoaXMuZGV0YWlsKTtcbiAgICAgIGlmICh0aGlzLmlkKSB7XG4gICAgICAgICAgdGhpcy5zZXJ2aWNlLnVwZGF0ZU9uZSh0aGlzLmlkLCB0aGlzLl9kZXRhaWwpLnN1YnNjcmliZShcbiAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIHNuYWNrQmFyQ29uZmlnOiBTbmFja0JhckNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogdGhpcy5JdGVtQ2FtZWxOYW1lICsgXCIgdXBkYXRlZC5cIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc25hY2tCYXIgPSBuZXcgU25hY2tCYXIoc25hY2tCYXJDb25maWcpO1xuICAgICAgICAgICAgICAgIHNuYWNrQmFyLnNob3coKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy4uLy4uL2RldGFpbCcsIHRoaXMuaWRdLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZX0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICAgICApO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpcy5zZXJ2aWNlLmNyZWF0ZU9uZSh0aGlzLl9kZXRhaWwpLnN1YnNjcmliZShcbiAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGFjdGlvbiA9IHRoaXMuc3ViRWRpdD8gXCIgYWRkZWRcIjpcIiBjcmVhdGVkLlwiO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNuYWNrQmFyQ29uZmlnOiBTbmFja0JhckNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogdGhpcy5JdGVtQ2FtZWxOYW1lICsgYWN0aW9uXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzbmFja0JhciA9IG5ldyBTbmFja0JhcihzbmFja0JhckNvbmZpZyk7XG4gICAgICAgICAgICAgICAgc25hY2tCYXIuc2hvdygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuaWQgPSByZXN1bHRbXCJfaWRcIl07XG4gICAgICAgICAgICAgICAgdGhpcy5fZGV0YWlsID0gcmVzdWx0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3ViRWRpdCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbmUuZW1pdCh0cnVlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy4uL2RldGFpbCcsIHRoaXMuaWRdLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZX0pO1xuICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5vblNlcnZpY2VFcnJvclxuICAgICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHB1YmxpYyBlZGl0Q2FuY2VsKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5zdWJFZGl0KSB7XG4gICAgICAgICAgICB0aGlzLmRvbmUuZW1pdChmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmdvQmFjaygpO1xuICAgICAgICB9IFxuICAgIH1cblxuICAgIHByb3RlY3RlZCBjbGlja2VkSWQgPSBudWxsO1xuICAgIHB1YmxpYyBvbkRpc3BsYXlSZWZDbGlja2VkKGZuOnN0cmluZywgZGV0YWlsOmFueSwgZXZlbnQ6YW55KTp2b2lkIHtcbiAgICAgICAgbGV0IHJlZiA9IHRoaXMuZ2V0UmVmRnJvbUZpZWxkKGZuKTtcbiAgICAgICAgbGV0IGQgPSBkZXRhaWw7XG4gICAgICAgIFxuICAgICAgICBpZiAoZCAmJiBkWydfaWQnXSkge1xuICAgICAgICAgICAgaWYgKHRoaXMubGlzdCkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGl0ZW0gb2YgdGhpcy5saXN0KXtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1bZm5dID09IGQpIHRoaXMuY2xpY2tlZElkID0gaXRlbVsnX2lkJ107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3JlZiwgJ2RldGFpbCcsIGRbJ19pZCddXSwge3JlbGF0aXZlVG86IHRoaXMuZ2V0UGFyZW50QWN0aXZhdGVkUm91dGVyKCkgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGV2ZW50KSBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25EZXRhaWxMaW5rQ2xpY2tlZChpZDpzdHJpbmcpOnZvaWQge1xuICAgICAgICB0aGlzLmNsaWNrZWRJZCA9IGlkOyBcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW3RoaXMuaXRlbU5hbWUsICdkZXRhaWwnLCBpZF0sIHtyZWxhdGl2ZVRvOiB0aGlzLmdldFBhcmVudEFjdGl2YXRlZFJvdXRlcigpIH0pO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgZ2V0UmVmRnJvbUZpZWxkKGZuOnN0cmluZyk6c3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRmllbGRzTWFwW2ZuXTtcbiAgICB9XG5cbiAgICBwdWJsaWMgY2xlYXJWYWx1ZUZyb21EZXRhaWwoZmllbGQ6c3RyaW5nKTp2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmRldGFpbC5oYXNPd25Qcm9wZXJ0eShmaWVsZCkpIHJldHVybjtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmRldGFpbFtmaWVsZF0gPT0gJ3VuZGVmaW5lZCcpIHJldHVybjtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmRldGFpbFtmaWVsZF0gPT0gJ29iamVjdCcpIHsvL3JlZmVyZW5jZSBmaWVsZCBvciBkYXRlXG4gICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdGlvbkZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZF0gPSB0aGlzLmNsZWFyRmllbGRBcnJheU11bHRpU2VsZWN0aW9uKHRoaXMuZGV0YWlsW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYXJyYXlGaWVsZHMuc29tZSh4PT54WzBdID09IGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkXSA9IHRoaXMuY2xlYXJGaWVsZEFycmF5KHRoaXMuZGV0YWlsW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubWFwRmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZF0gPSB0aGlzLmNsZWFyRmllbGRNYXAodGhpcy5kZXRhaWxbZmllbGRdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXRlRmllbGRzLmluY2x1ZGVzKGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkXSA9IHRoaXMuY2xlYXJGaWVsZERhdGUodGhpcy5kZXRhaWxbZmllbGRdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5yZWZlcmVuY2VGaWVsZHMuaW5jbHVkZXMoZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGRdID0gdGhpcy5jbGVhckZpZWxkUmVmZXJlbmNlKHRoaXMuZGV0YWlsW2ZpZWxkXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2NoZWNrIGlmIGFueSBpbmZvIG5lZWRzIHRvIGNoYW5nZSBhZnRlciBjbGVhciBjZXJ0YWluIHZhbHVlcztcbiAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmRldGFpbFtmaWVsZF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHVibGljIGNsZWFyVmFsdWVGcm9tQXJyYXlGaWVsZChmaWVsZDogc3RyaW5nLCBpZHg6IG51bWJlcik6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZF1bJ3NlbGVjdGlvbiddKSB7XG4gICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZF1bJ3NlbGVjdGlvbiddID0gdGhpcy5kZXRhaWxbZmllbGRdWydzZWxlY3Rpb24nXS5maWx0ZXIoKHgsaSk9PiBpICE9IGlkeCApO1xuICAgICAgICAgICAgLy9jaGVjayBpZiBhbnkgaW5mbyBuZWVkcyB0byBjaGFuZ2UgYWZ0ZXIgY2xlYXIgY2VydGFpbiB2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHVibGljIGNsZWFyVmFsdWVGcm9tTWFwRmllbGQoZmllbGQ6IHN0cmluZywga2V5OiBzdHJpbmcpOnZvaWQge1xuICAgICAgICBpZiAodGhpcy5kZXRhaWxbZmllbGRdWydzZWxlY3Rpb24nXSkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuZGV0YWlsW2ZpZWxkXVsnc2VsZWN0aW9uJ11ba2V5XTtcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgYW55IGluZm8gbmVlZHMgdG8gY2hhbmdlIGFmdGVyIGNsZWFyIGNlcnRhaW4gdmFsdWVzO1xuICAgICAgICAgICAgdGhpcy5leHRyYUluZm9Qb3B1bGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBjbGVhclZhbHVlRnJvbU1hcEtleShmaWVsZDogc3RyaW5nLCBrZXk6IHN0cmluZyk6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZF1bJ3NlbGVjdGlvbiddKSB7XG4gICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZF1bJ3NlbGVjdGlvbiddW2tleV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAvL2NoZWNrIGlmIGFueSBpbmZvIG5lZWRzIHRvIGNoYW5nZSBhZnRlciBjbGVhciBjZXJ0YWluIHZhbHVlcztcbiAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgXG4gICAgcHVibGljIGNoZWNrVmFsdWVEZWZpbmVkRnJvbURldGFpbChmaWVsZDpzdHJpbmcpOmJvb2xlYW4ge1xuICAgICAgICBsZXQgZCA9IHRoaXMuZGV0YWlsO1xuICAgICAgICBpZiAoIWQuaGFzT3duUHJvcGVydHkoZmllbGQpKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh0eXBlb2YgZFtmaWVsZF0gPT0gJ3VuZGVmaW5lZCcpIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmRldGFpbFtmaWVsZF0gPT0gJ251bWJlcicgXG4gICAgICAgICAgICB8fCB0eXBlb2YgZFtmaWVsZF0gPT0gJ3N0cmluZydcbiAgICAgICAgICAgIHx8IHR5cGVvZiBkW2ZpZWxkXSA9PSAnYm9vbGVhbicpIHJldHVybiB0cnVlO1xuICAgICAgICBpZiAodHlwZW9mIGRbZmllbGRdID09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdGlvbkZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZEFycmF5TXVsdGlTZWxlY3Rpb24oZFtmaWVsZF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFycmF5RmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZEFycmF5KGRbZmllbGRdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5tYXBGaWVsZHMuc29tZSh4PT54WzBdID09IGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRGVmaW5lZEZpZWxkTWFwKGRbZmllbGRdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5kYXRlRmllbGRzLmluY2x1ZGVzKGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRGVmaW5lZEZpZWxkRGF0ZShkW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVmZXJlbmNlRmllbGRzLmluY2x1ZGVzKGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlzRGVmaW5lZEZpZWxkUmVmZXJlbmNlKGRbZmllbGRdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcHVibGljIGNsZWFyVmFsdWVGcm9tRGV0YWlsQW5kU2VhcmNoTGlzdChmaWVsZDpzdHJpbmcpOnZvaWQge1xuICAgICAgICB0aGlzLmNsZWFyVmFsdWVGcm9tRGV0YWlsKGZpZWxkKTtcbiAgICAgICAgdGhpcy5zZWFyY2hMaXN0KCk7XG4gICAgfVxuICAgIFxuICAgIHB1YmxpYyBvbkFkZEFycmF5SXRlbShmaWVsZE5hbWU6c3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLmFycmF5RmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgaWYgKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ25ldyddKSB7IC8vd2hlcmUgbmV3IGFkZGVkIGl0ZW0gaXMgc3RvcmVkXG4gICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ25ldyddO1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnbmV3J10gPSB1bmRlZmluZWQ7IC8vY2xlYXIgaXRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnc2VsZWN0aW9uJ10ucHVzaChpdGVtKTtcbiAgICAgICAgICBcbiAgICAgICAgICAgIGxldCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyd2YWx1ZSddKSB2YWx1ZXMgPSB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyd2YWx1ZSddLnNwbGl0KCcgfCAnKVxuICAgICAgICAgICAgdmFsdWVzLnB1c2goaXRlbSk7IC8vZGlzcGxheSB2YWx1ZVxuICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLmZpbHRlcih4PT4hIXgpO1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXSA9IHZhbHVlcy5qb2luKCcgfCAnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy9zZWUgaWYgcmVsYXRlZCBpbmZvIG5lZWRzIHRvIGNoYW5nZSBhZnRlciB0aGUgY2hhbmdlIG9mIHRoaXMgdmFsdWVcbiAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gICAgICAgICAgICAgICAgICAgIFxuICAgIH1cbiAgICBwdWJsaWMgb25BZGRNYXBJdGVtKGZpZWxkTmFtZTpzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMubWFwRmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgaWYgKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ25ldyddKSB7IC8vd2hlcmUgbmV3IGFkZGVkIGl0ZW0gaXMgc3RvcmVkXG4gICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ25ldyddO1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnbmV3J10gPSB1bmRlZmluZWQ7IC8vY2xlYXIgaXRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnc2VsZWN0aW9uJ11baXRlbV0gPSB1bmRlZmluZWQ7IC8vbW92ZSB0byBzZWxlY3Rpb24gb2JqZWN0XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vVE9ETzogdGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXSBjaGFuZ2VcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy9zZWUgaWYgcmVsYXRlZCBpbmZvIG5lZWRzIHRvIGNoYW5nZSBhZnRlciB0aGUgY2hhbmdlIG9mIHRoaXMgdmFsdWVcbiAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gICAgICAgICAgICAgICAgICAgIFxuICAgIH1cbiAgICAvLyoqKiogRm9yIHBhcmVudCBjb21wb25lbnQgb2YgbW9kYWwgVUlcbiAgICBwcm90ZWN0ZWQgcmVmU2VsZWN0RGlyZWN0aXZlOmFueTtcbiAgICBwcm90ZWN0ZWQgc2VsZWN0Q29tcG9uZW50czphbnk7IC8ve2ZpZWxkTmFtZTogY29tcG9uZW50LXR5cGV9IGZvcm1hdFxuICAgIHByb3RlY3RlZCBjb21wb25lbnRGYWN0b3J5UmVzb2x2ZXI6IGFueTsgLy9pbmplY3RlZCBieSBleHRlbmRlZCBjbGFzcywgaWYgbmVlZGVkLlxuICAgIHByaXZhdGUgY29tcG9uZW50U3Vic2NyaXB0aW9uXG4gICAgcHVibGljIG9uUmVmU2VsZWN0KGZpZWxkTmFtZTpzdHJpbmcpIHtcbiAgICAgICAgaWYgKCF0aGlzLnJlZlNlbGVjdERpcmVjdGl2ZSkge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIk5vIHJlZmVyZW5jZSBkaXJlY3RpdmUgZm9yIGZpZWxkOiBcIiwgZmllbGROYW1lKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHZpZXdDb250YWluZXJSZWYgPSB0aGlzLnJlZlNlbGVjdERpcmVjdGl2ZS52aWV3Q29udGFpbmVyUmVmO1xuICAgICAgICB2aWV3Q29udGFpbmVyUmVmLmNsZWFyKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRoaXMuc2VsZWN0Q29tcG9uZW50c1tmaWVsZE5hbWVdKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFwiTm8gcmVmZXJlbmNlIGRlZmluZWQgZm9yIGZpZWxkOiBcIiwgZmllbGROYW1lKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNvbXBvbmVudFJlZiA9IHRoaXMuc2VsZWN0Q29tcG9uZW50c1tmaWVsZE5hbWVdW1wiY29tcG9uZW50UmVmXCJdO1xuICAgICAgICBpZiAoIWNvbXBvbmVudFJlZikge1xuICAgICAgICAgICAgbGV0IGNvbVR5cGUgPSB0aGlzLnNlbGVjdENvbXBvbmVudHNbZmllbGROYW1lXVtcInNlbGVjdC10eXBlXCJdXG4gICAgICAgICAgICBpZiAoIWNvbVR5cGUpIGNvbnNvbGUud2FybihcIk5vIGNvbXBvbmVudCB0eXBlIGZvdW5kIGZvciByZWZlcmVuY2UgZmllbGQgXCIsIGZpZWxkTmFtZSk7XG5cbiAgICAgICAgICAgIGxldCBjb21wb25lbnRGYWN0b3J5ID0gdGhpcy5jb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoY29tVHlwZSk7XG4gICAgICAgICAgICBjb21wb25lbnRSZWYgPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTsvL2NyZWF0ZSBhbmQgaW5zZXJ0IGluIG9uZSBjYWxsXG4gICAgICAgICAgICB0aGlzLnNlbGVjdENvbXBvbmVudHNbZmllbGROYW1lXVtcImNvbXBvbmVudFJlZlwiXSA9IGNvbXBvbmVudFJlZjsvL3NhdmUgaXRcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZpZXdDb250YWluZXJSZWYuaW5zZXJ0KGNvbXBvbmVudFJlZi5ob3N0Vmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGxldCBjb21wb25lbnRJbnN0YW5jZSA9IDxCYXNlQ29tcG9uZW50SW50ZXJmYWNlPmNvbXBvbmVudFJlZi5pbnN0YW5jZTtcbiAgICAgICAgaWYgKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV0pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlZmVyZW5jZUZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50SW5zdGFuY2UuaW5wdXREYXRhID0gdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnX2lkJ107XG4gICAgICAgICAgICB9ICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgY29tcG9uZW50SW5zdGFuY2Uuc2V0Rm9jdXMoKTtcbiAgICAgICAgXG4gXG4gICAgICAgIHRoaXMuY29tcG9uZW50U3Vic2NyaXB0aW9uID0gY29tcG9uZW50SW5zdGFuY2UuZG9uZS5zdWJzY3JpYmUoICh2YWwpID0+IHtcbiAgICAgICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgIHZpZXdDb250YWluZXJSZWYuZGV0YWNoKCk7IC8vb25seSBkZXRhY2guIG5vdCBkZXN0cm95XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsZXQgb3V0cHV0RGF0YSA9IGNvbXBvbmVudEluc3RhbmNlLm91dHB1dERhdGE7XG4gICAgICAgICAgICBpZiAob3V0cHV0RGF0YSkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAob3V0cHV0RGF0YS5hY3Rpb24pe1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2VsZWN0ZWRcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmFycmF5RmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnc2VsZWN0aW9uJ10ucHVzaCggb3V0cHV0RGF0YS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXSkgdmFsdWVzID0gdGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXS5zcGxpdCgnIHwgJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChvdXRwdXREYXRhLnZhbHVlLnZhbHVlKTsgLy9kaXNwbGF5IHZhbHVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzID0gdmFsdWVzLmZpbHRlcih4PT4hIXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10gPSB2YWx1ZXMuam9pbignIHwgJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVmZXJlbmNlRmllbGRzLmluY2x1ZGVzKGZpZWxkTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZE5hbWVdID0gb3V0cHV0RGF0YS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy90cmlnZ2VyIGV4dHJhSW5mbyBwb3B1bGF0ZSwgb25jZSByZWZlcmVuY2UgY2hhbmdlZC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwidmlld1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vblJlZlNob3coZmllbGROYW1lLCBcInNlbGVjdFwiLCBvdXRwdXREYXRhLnZhbHVlKTsvL3ZhbHVlIGlzIF9pZFxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcHVibGljIG9uUmVmU2hvdyhmaWVsZE5hbWU6c3RyaW5nLCBhY3Rpb246c3RyaW5nLCBpZDpzdHJpbmcpIHtcbiAgICAgICAgaWYgKCFpZCAmJiB0aGlzLmRldGFpbFtmaWVsZE5hbWVdKSBpZCA9IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ19pZCddO1xuICAgICAgICBpZiAoIWlkKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignU2hvdyByZWZlcmVuY2UgYnV0IG5vIGlkIGlzIGdpdmVuLicpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdmlld0NvbnRhaW5lclJlZiA9IHRoaXMucmVmU2VsZWN0RGlyZWN0aXZlLnZpZXdDb250YWluZXJSZWY7XG4gICAgICAgIHZpZXdDb250YWluZXJSZWYuY2xlYXIoKTtcbiAgICAgICAgXG4gICAgICAgIGxldCBkZXRhaWxUeXBlID0gYWN0aW9uICsgXCItZGV0YWlsLXR5cGVcIjsgLy9lZzogc2VsZWN0LWRldGFpbC10eXBlLCBwb3AtZGV0YWlsLXR5cGVcbiAgICAgICAgbGV0IGNvbVR5cGUgPSB0aGlzLnNlbGVjdENvbXBvbmVudHNbZmllbGROYW1lXVtkZXRhaWxUeXBlXVxuICAgICAgICBpZiAoIWNvbVR5cGUpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiTm8gY29tcG9uZW50IHR5cGUgZm91bmQgZm9yOiAlc1wiLCBkZXRhaWxUeXBlKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNvbXBvbmVudEZhY3RvcnkgPSB0aGlzLmNvbXBvbmVudEZhY3RvcnlSZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShjb21UeXBlKTtcbiAgICAgICAgbGV0IGNvbXBvbmVudFJlZiA9IHZpZXdDb250YWluZXJSZWYuY3JlYXRlQ29tcG9uZW50KGNvbXBvbmVudEZhY3RvcnkpOy8vY3JlYXRlIGFuZCBpbnNlcnQgaW4gb25lIGNhbGxcblxuICAgICAgICBsZXQgY29tcG9uZW50SW5zdGFuY2UgPSA8QmFzZUNvbXBvbmVudEludGVyZmFjZT5jb21wb25lbnRSZWYuaW5zdGFuY2U7XG4gICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmlucHV0RGF0YSA9IGlkO1xuICAgICAgICBjb21wb25lbnRJbnN0YW5jZS5zZXRGb2N1cygpO1xuICAgICAgIFxuICAgICAgICBjb21wb25lbnRJbnN0YW5jZS5kb25lLnN1YnNjcmliZSggKHZhbCkgPT4ge1xuICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICBjb21wb25lbnRJbnN0YW5jZS5kb25lLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgICAgICAgICB2aWV3Q29udGFpbmVyUmVmLmNsZWFyKCk7XG4gICAgICAgICAgIH1cbiAgICAgICAgICAgbGV0IG91dHB1dERhdGEgPSBjb21wb25lbnRJbnN0YW5jZS5vdXRwdXREYXRhO1xuICAgICAgICAgICAgaWYgKG91dHB1dERhdGEpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG91dHB1dERhdGEuYWN0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNlbGVjdGVkXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hcnJheUZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3NlbGVjdGlvbiddLnB1c2goIG91dHB1dERhdGEudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10pIHZhbHVlcyA9IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10uc3BsaXQoJyB8ICcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gob3V0cHV0RGF0YS52YWx1ZS52YWx1ZSk7IC8vZGlzcGxheSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5maWx0ZXIoeD0+ISF4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyd2YWx1ZSddID0gdmFsdWVzLmpvaW4oJyB8ICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlZmVyZW5jZUZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXSA9IG91dHB1dERhdGEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciBleHRyYUluZm8gcG9wdWxhdGUsIG9uY2UgcmVmZXJlbmNlIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImJhY2tcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25SZWZTZWxlY3QoZmllbGROYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vRm9sbG93aW5nIGhhdm4ndCBiZWVuIHVzZWQgeWV0XG4gICAgLypcbiAgICBwcml2YXRlIHR5cGluZ1RpbWVyO1xuICAgIHB1YmxpYyBvbktleVVwKGZpZWxkTmFtZTpzdHJpbmcsIHZhbHVlOnN0cmluZyk6dm9pZCB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnR5cGluZ1RpbWVyKTtcbiAgICBcbiAgICAgICAgdGhpcy50eXBpbmdUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0lucHV0IFZhbHVlOicsIHZhbHVlKTtcbiAgICAgICAgfSwgMTAwMCk7XG4gICAgfVxuICAgICovXG4gICAgLy8qKioqIEZvciBjaGlsZCBjb21wb25lbnQgb2YgbW9kYWwgVUlcbiAgICBwdWJsaWMgaW5wdXREYXRhO1xuICAgIHB1YmxpYyBvdXRwdXREYXRhO1xuICAgIHB1YmxpYyBkb25lOmFueTtcbiAgICBwcm90ZWN0ZWQgZm9jdXNFbDsgLy9FbGVtZW50UmVmXG4gICAgc2V0Rm9jdXMoKSB7XG4gICAgICAgIGlmICh0aGlzLmZvY3VzRWwpXG4gICAgICAgICAgICB0aGlzLmZvY3VzRWwubmF0aXZlRWxlbWVudC5mb2N1cygpO1xuICAgIH1cbiAgICB1aUNsb3NlTW9kYWwoKSB7XG4gICAgICAgIHRoaXMub3V0cHV0RGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuZG9uZS5lbWl0KHRydWUpO1xuICAgIH1cbiAgICB1aU9uRXNjYXBlS2V5KCkge1xuICAgICAgICB0aGlzLnVpQ2xvc2VNb2RhbCgpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBzZWxlY3RlZElkID0gbnVsbDtcbiAgICBzZWxlY3RJdGVtU2VsZWN0ZWQobnVtOm51bWJlcikge1xuICAgICAgICBsZXQgZGV0YWlsID0gdGhpcy5saXN0W251bV07XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJZCA9IGRldGFpbFsnX2lkJ107XG4gICAgICAgIHRoaXMuY2xpY2tlZElkID0gZGV0YWlsWydfaWQnXTtcbiAgICAgICAgdGhpcy5vdXRwdXREYXRhID0ge2FjdGlvbjogXCJzZWxlY3RlZFwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1wiX2lkXCI6IGRldGFpbFtcIl9pZFwiXSwgXCJ2YWx1ZVwiOiB0aGlzLnN0cmluZ2lmeShkZXRhaWwpfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IGRldGFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICB0aGlzLmRvbmUuZW1pdCh0cnVlKTtcbiAgICB9XG4gICAgXG4gICAgZGV0YWlsU2VsU2VsZWN0ZWQoKSB7XG4gICAgICAgIGxldCBkZXRhaWwgPSB0aGlzLmRldGFpbDtcbiAgICAgICAgdGhpcy5vdXRwdXREYXRhID0ge2FjdGlvbjogXCJzZWxlY3RlZFwiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1wiX2lkXCI6IGRldGFpbFtcIl9pZFwiXSwgXCJ2YWx1ZVwiOiB0aGlzLnN0cmluZ2lmeShkZXRhaWwpfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXRhaWw6IGRldGFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICB0aGlzLmRvbmUuZW1pdCh0cnVlKTtcbiAgICB9XG5cbiAgICBzZWxlY3RWaWV3RGV0YWlsKG51bTpudW1iZXIpIHtcbiAgICAgICAgbGV0IGRldGFpbCA9IHRoaXMubGlzdFtudW1dO1xuICAgICAgICB0aGlzLmNsaWNrZWRJZCA9IGRldGFpbFsnX2lkJ107XG4gICAgICAgIHRoaXMub3V0cHV0RGF0YSA9IHthY3Rpb246IFwidmlld1wiLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZGV0YWlsW1wiX2lkXCJdXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgIHRoaXMuZG9uZS5lbWl0KHRydWUpO1xuICAgIH1cbiAgICBcbiAgICBkZXRhaWxTZWxCYWNrKCkge1xuICAgICAgICB0aGlzLm91dHB1dERhdGEgPSB7YWN0aW9uOiBcImJhY2tcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgdGhpcy5kb25lLmVtaXQodHJ1ZSk7XG4gICAgfVxuICAgIFxuICAgIC8vU2VhcmNoIG1vcmUgaW4gdGhlIGxpc3Qgdmlld1xuICAgIHByb3RlY3RlZCBzZWFyY2hUZXh0OiBzdHJpbmc7XG4gICAgcHJvdGVjdGVkIHNlYXJjaE1vcmVEZXRhaWw6IGFueTtcbiAgICBwdWJsaWMgbW9yZVNlYXJjaE9wZW5lZDpib29sZWFuID0gZmFsc2U7XG4gICAgdG9nZ2xlTW9yZVNlYXJjaCgpIHtcbiAgICAgICAgdGhpcy5tb3JlU2VhcmNoT3BlbmVkID0gIXRoaXMubW9yZVNlYXJjaE9wZW5lZDtcbiAgICB9ICAgIFxuICAgIG9uU2VhcmNoVGV4dENsZWFyKCk6dm9pZCB7XG4gICAgICB0aGlzLnNlYXJjaFRleHQgPSB1bmRlZmluZWQ7XG4gICAgICBpZiAoIXRoaXMubW9yZVNlYXJjaE9wZW5lZCkgdGhpcy5zZWFyY2hMaXN0KCk7XG4gICAgfVxuICAgIG9uU2VhcmNoQ2xlYXIoKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoVGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgbGV0IGRldGFpbCA9IHt9O1xuICAgICAgICB0aGlzLmRldGFpbCA9IHRoaXMuZm9ybWF0RGV0YWlsKGRldGFpbCk7XG4gICAgICAgIHRoaXMuc2VhcmNoTGlzdCgpO1xuICAgIH1cbiAgICBcbiAgICAvKiBUaGlzIGlzIGZvciBlZGl0b3IgcmVsYXRlZCAqL1xuICAgIHByb3RlY3RlZCB0ZXh0RWRpdG9yczphbnk7IC8vdHlwZSBvZiBRdWVyeUxpc3Q8VD5cbiAgICBwcm90ZWN0ZWQgdGV4dEVkaXRvck1hcDphbnkgPSB7fTtcbiAgICBcbiAgICBwcm90ZWN0ZWQgZXh0cmFGaWVsZHNVbmxvYWQoKSB7Ly9mcm9tIHNlcnZlclxuICAgICAgICBpZiAodGhpcy50ZXh0RWRpdG9ycykge1xuICAgICAgICAgICAgdGhpcy50ZXh0RWRpdG9ycy5mb3JFYWNoKGVkaXRvcj0+e1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBmaWVsZE5hbWUgPSBlZGl0b3IubmFtZTtcbiAgICAgICAgICAgICAgICBsZXQgdmFsaWRhdG9yT2JqID0gdGhpcy50ZXh0RWRpdG9yTWFwW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgaWYgKCF2YWxpZGF0b3JPYmopIHJldHVybjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgY29udGVudCA9IHRoaXMuZGV0YWlsW3ZhbGlkYXRvck9iai5maWVsZE5hbWVdXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQpIGVkaXRvci5zZXRDb250ZW50KGNvbnRlbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgICAgIFxuICAgIHByb3RlY3RlZCBleHRyYUZpZWxkc0xvYWQoKSB7Ly90byBzZXJ2ZXJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnRleHRFZGl0b3JzKSB7XG4gICAgICAgICAgICBsZXQgYXJyYXkgPSB0aGlzLnRleHRFZGl0b3JzLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGVkaXRvciBvZiBhcnJheSkge1xuICAgICAgICAgICAgICAgIGxldCBmaWVsZE5hbWUgPSBlZGl0b3IubmFtZTtcbiAgICAgICAgICAgICAgICBsZXQgW2NvbnRlbnQsdGV4dF0gPSBlZGl0b3IuZ2V0Q29udGVudCgpO1xuICAgICAgICAgICAgICAgIGxldCB2YWxpZGF0b3JPYmogPSB0aGlzLnRleHRFZGl0b3JNYXBbZmllbGROYW1lXTtcbiAgICAgICAgICAgICAgICBpZiAoIXZhbGlkYXRvck9iaikgY29udGludWU7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IGZpZWxkU3RhdGUgPSB2YWxpZGF0b3JPYmouZmllbGRTdGF0ZTtcbiAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLmVycm9ycyA9IHt9O1xuICAgICAgICAgICAgICAgIGlmICghY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsaWRhdG9yT2JqLnJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLmVycm9ycy5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLnZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCdtaW5sZW5ndGgnIGluIHZhbGlkYXRvck9iaiAmJiB0ZXh0Lmxlbmd0aCA8IHZhbGlkYXRvck9iai5taW5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS52YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLmVycm9ycy5taW5sZW5ndGggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgnbWF4bGVuZ3RoJyBpbiB2YWxpZGF0b3JPYmogJiYgdGV4dC5sZW5ndGggPiB2YWxpZGF0b3JPYmoubWF4bGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUudmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS5lcnJvcnMubWF4bGVuZ3RoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJ3ZhbGlkYXRvcnMnIGluIHZhbGlkYXRvck9iaikge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZXJyb3IgPSB2YWxpZGF0b3JPYmpbJ3ZhbGlkYXRvcnMnXS52YWxpZGF0ZVZhbHVlKHRleHQpXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS52YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS5lcnJvcnMgPSBlcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH0gICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUudmFsaWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUuZXJyb3JzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW3ZhbGlkYXRvck9iai5maWVsZE5hbWVdID0gY29udGVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBvbkVkdGlvclByZXZpZXcoZWRpdG9yTmFtZTpzdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dEVkaXRvcnMpXG4gICAgICAgICAgICB0aGlzLnRleHRFZGl0b3JzLmZvckVhY2goIChlZGl0b3IpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoZWRpdG9yLm5hbWUgPT0gZWRpdG9yTmFtZSkgZWRpdG9yLnByZXZpZXcoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvKlBhcmVudCByb3V0ZXIgcmVsYXRlZCovXG4gICAgcHJvdGVjdGVkIGdldFBhcmVudFJvdXRlSXRlbSgpOnN0cmluZyB7XG4gICAgICAgIGxldCByb3V0ZVNuYXBzaG90ID0gdGhpcy5yb3V0ZS5zbmFwc2hvdDtcbiAgICAgICAgbGV0IHBhcmVudEl0ZW07XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgaWYgKHJvdXRlU25hcHNob3QuZGF0YSAmJiByb3V0ZVNuYXBzaG90LmRhdGEubXJhTGV2ZWwgPT0gMSApIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRJdGVtID0gcm91dGVTbmFwc2hvdC5kYXRhLml0ZW07XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcm91dGVTbmFwc2hvdCA9IHJvdXRlU25hcHNob3QucGFyZW50O1xuICAgICAgICB9IHdoaWxlIChyb3V0ZVNuYXBzaG90KVxuICAgICAgICByZXR1cm4gcGFyZW50SXRlbTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0UGFyZW50Um91dGVJdGVtSWQoKTpzdHJpbmcge1xuICAgICAgICBsZXQgcm91dGVTbmFwc2hvdCA9IHRoaXMucm91dGUuc25hcHNob3Q7XG4gICAgICAgIGxldCBwYXJlbnRJdGVtSWQ7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgaWYgKHJvdXRlU25hcHNob3QuZGF0YSAmJiByb3V0ZVNuYXBzaG90LmRhdGEubXJhTGV2ZWwgPT0gMSAmJiAoJ2lkJyBpbiByb3V0ZVNuYXBzaG90LnBhcmFtcykpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRJdGVtSWQgPSByb3V0ZVNuYXBzaG90LnBhcmFtcy5pZDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICByb3V0ZVNuYXBzaG90ID0gcm91dGVTbmFwc2hvdC5wYXJlbnQ7XG4gICAgICAgIH0gd2hpbGUgKHJvdXRlU25hcHNob3QpXG4gICAgICAgIHJldHVybiBwYXJlbnRJdGVtSWQ7XG4gICAgfVxuICAgICAgICBcbiAgICBwcm90ZWN0ZWQgZ2V0UGFyZW50Um91dGVSZWZGaWVsZCgpOnN0cmluZyB7XG4gICAgICAgIGxldCBtcCA9IHRoaXMucmVmZXJlbmNlRmllbGRzTWFwO1xuICAgICAgICBmb3IgKGxldCBwcm9wIGluIG1wKSB7XG4gICAgICAgICAgICBpZiAobXAuaGFzT3duUHJvcGVydHkocHJvcCkgJiYgbXBbcHJvcF0gPT0gdGhpcy5wYXJlbnRJdGVtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb3A7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZ2V0UGFyZW50QWN0aXZhdGVkUm91dGVyKCk6QWN0aXZhdGVkUm91dGUge1xuICAgICAgICBsZXQgcm91dGUgPSB0aGlzLnJvdXRlO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBsZXQgZGF0YSA9IHJvdXRlLnNuYXBzaG90LmRhdGE7XG4gICAgICAgICAgICAvL2FsbCByb3V0ZSBpbnNpZGUgdGhlIG1yYSBzeXN0ZW0gd2lsbCBoYXZlIG1yYUxldmVsIGRhdGEgaXRlbVxuICAgICAgICAgICAgaWYgKCFkYXRhLm1yYUxldmVsKSByZXR1cm4gcm91dGU7XG4gICAgICAgICAgICByb3V0ZSA9IHJvdXRlLnBhcmVudDtcbiAgICAgICAgfSB3aGlsZSAocm91dGUpXG4gICAgICAgIHJldHVybiB0aGlzLnJvdXRlLnJvb3Q7XG4gICAgfVxuICAgIFxuICAgIC8qU3ViIGRldGFpbCBzaG93IGZsYWcqL1xuICAgIHB1YmxpYyB0b2dnbGVDaGVja2VkSXRlbShpOm51bWJlcik6dm9pZCB7XG4gICAgICAgIHRoaXMuY2hlY2tlZEl0ZW1baV0gPSAhdGhpcy5jaGVja2VkSXRlbVtpXTtcbiAgICB9XG5cbiAgICAvKioqIEFueSBWaWV3IC0gYWRkIG5ldyBjb21wb25lbnQgaW4gdGhlIGN1cnJlbnQgdmlldyovXG4gICAgcHJvdGVjdGVkIGlzQWRkaW5nOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHVibGljIG9uQWRkKCkge1xuICAgICAgICB0aGlzLmlzQWRkaW5nID0gdHJ1ZTtcbiAgICB9XG4gICAgcHVibGljIHRvZ2dsZUFkZCgpIHtcbiAgICAgICAgdGhpcy5pc0FkZGluZyA9ICF0aGlzLmlzQWRkaW5nO1xuICAgIH1cbiAgICBwdWJsaWMgb25BZGREb25lKHJlc3VsdDogYm9vbGVhbikge1xuICAgICAgICB0aGlzLmlzQWRkaW5nID0gZmFsc2U7XG4gICAgICAgIGlmIChyZXN1bHQpIHsgLy9hZGQgc3VjY2Vzc2Z1bC4gUmUtcG9wdWxhdGUgdGhlIGN1cnJlbnQgbGlzdFxuICAgICAgICAgIGlmICh0aGlzLnZpZXcgPT0gVmlld1R5cGUuTElTVCkge1xuICAgICAgICAgICAgdGhpcy5wb3B1bGF0ZUxpc3QoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICA7IC8vZG8gbm90aGluZ1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8qRGF0ZSBSYW5nZSBTZWxlY3Rpb24gKi9cbiAgICBob3ZlcmVkRGF0ZTogYW55O1xuXG4gICAgb25EYXRlU2VsZWN0aW9uVG9nZ2xlKGZuOnN0cmluZykge1xuICAgICAgICB0aGlzLmRldGFpbFtmbl1bJ3BvcCddID0gIXRoaXMuZGV0YWlsW2ZuXVsncG9wJ107XG4gICAgfVxuICAgIFxuICAgIG9uRGF0ZVNlbGVjdGlvbihmbjpzdHJpbmcsIGRhdGU6IGFueSkge1xuICAgICAgICBpZiAoIXRoaXMuZGV0YWlsW2ZuXVsnZnJvbSddICYmICF0aGlzLmRldGFpbFtmbl1bJ3RvJ10pIHtcbiAgICAgICAgICB0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSA9IGRhdGU7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5kZXRhaWxbZm5dWydmcm9tJ10gJiYgIXRoaXMuZGV0YWlsW2ZuXVsndG8nXSAmJiBkYXRlLmFmdGVyKHRoaXMuZGV0YWlsW2ZuXVsnZnJvbSddKSkge1xuICAgICAgICAgIHRoaXMuZGV0YWlsW2ZuXVsndG8nXSA9IGRhdGU7XG4gICAgICAgICAgdGhpcy5kZXRhaWxbZm5dWydwb3AnXSA9IGZhbHNlOyAvL0ZpbmlzaGVkLiBoaWRlIHRoZSBzZWxlY3Rpb24gXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5kZXRhaWxbZm5dWyd0byddID0gbnVsbDtcbiAgICAgICAgICB0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSA9IGRhdGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpc0hvdmVyZWQoZm46c3RyaW5nLCBkYXRlOiBhbnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGV0YWlsW2ZuXVsnZnJvbSddICYmICF0aGlzLmRldGFpbFtmbl1bJ3RvJ10gJiYgdGhpcy5ob3ZlcmVkRGF0ZSAmJiBkYXRlLmFmdGVyKHRoaXMuZGV0YWlsW2ZuXVsnZnJvbSddKSAmJiBkYXRlLmJlZm9yZSh0aGlzLmhvdmVyZWREYXRlKTtcbiAgICB9XG5cbiAgICBpc0luc2lkZShmbjpzdHJpbmcsIGRhdGU6IGFueSkge1xuICAgICAgICByZXR1cm4gZGF0ZS5hZnRlcih0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSkgJiYgZGF0ZS5iZWZvcmUodGhpcy5kZXRhaWxbZm5dWyd0byddKTtcbiAgICB9XG5cbiAgICBpc1JhbmdlKGZuOnN0cmluZywgZGF0ZTogYW55KSB7XG4gICAgICAgIHJldHVybiBkYXRlLmVxdWFscyh0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSkgfHwgZGF0ZS5lcXVhbHModGhpcy5kZXRhaWxbZm5dWyd0byddKSB8fCB0aGlzLmlzSW5zaWRlKGZuLCBkYXRlKSB8fCB0aGlzLmlzSG92ZXJlZChmbiwgZGF0ZSk7XG4gICAgfVxufVxuIl19