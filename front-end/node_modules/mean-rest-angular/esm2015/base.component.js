/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { EventEmitter } from '@angular/core';
import { Modal } from './util.modal';
import { SnackBar } from './util.snackbar';
import { ErrorToast } from './util.errortoast';
import { ServiceError } from './base.service';
import { MraCommonService } from './common.service';
import { Util } from './util.tools';
/** @enum {number} */
const ViewType = {
    LIST: 0,
    DETAIL: 1,
    EDIT: 2,
};
export { ViewType };
ViewType[ViewType.LIST] = 'LIST';
ViewType[ViewType.DETAIL] = 'DETAIL';
ViewType[ViewType.EDIT] = 'EDIT';
export { ServiceError };
export class BaseComponent {
    /**
     * @param {?} service
     * @param {?} injector
     * @param {?} router
     * @param {?} route
     * @param {?} location
     * @param {?} view
     * @param {?} itemCamelName
     */
    constructor(service, injector, router, route, location, view, itemCamelName) {
        this.service = service;
        this.injector = injector;
        this.router = router;
        this.route = route;
        this.location = location;
        this.view = view;
        this.itemCamelName = itemCamelName;
        this.objectKeys = Object.keys;
        this.storage = {};
        //For list and pagination
        this.list = [];
        this.majorUi = true;
        this.eventEmitter = new EventEmitter();
        this.page = 1;
        this.per_page = 25;
        this.total_count = 0;
        this.total_pages = 0;
        this.pages = [];
        this.left_more = false;
        this.right_more = false;
        this.checkAll = false;
        //used to mark deleted items, or items that will show sub-detail, etc.
        this.checkedItem = [];
        //For edit and view details
        this.detail = {};
        this._detail = {}; //a clone and used to send/receive from next work
        //a clone and used to send/receive from next work
        this._extra = {}; //extra info.
        this.subEdit = false; //a edit-sub component
        //a edit-sub component
        //for fields with enum values
        this.enums = {};
        this.stringFields = [];
        this.referenceFields = [];
        this.referenceFieldsMap = {};
        this.dateFields = [];
        this.indexFields = [];
        this.multiSelectionFields = [];
        this.arrayFields = []; //element is [fieldName, elementType]
        //element is [fieldName, elementType]
        this.mapFields = []; //element is [fieldName, elementType, mapKey]
        //element is [fieldName, elementType, mapKey]
        this.dateFormat = "MM/DD/YYYY";
        this.timeFormat = "hh:mm:ss";
        this.hiddenFields = []; //fields hide from view. Currrently used by "Add" view of edit-sub
        this.refreshing = false;
        this.clickedId = null;
        this.selectedId = null;
        this.moreSearchOpened = false;
        //type of QueryList<T>
        this.textEditorMap = {};
        /**
         * Any View - add new component in the current view
         */
        this.isAdding = false;
        this.ItemCamelName = itemCamelName.charAt(0).toUpperCase() + itemCamelName.substr(1);
        this.itemName = itemCamelName.toLowerCase();
        this.parentItem = this.getParentRouteItem();
        this.commonService = injector.get(MraCommonService);
    }
    /**
     * @protected
     * @param {?} error
     * @return {?}
     */
    onServiceError(error) {
        //clear any pending flags
        this.refreshing = false;
        /** @type {?} */
        let errMsg;
        /** @type {?} */
        let more;
        if (error.clientErrorMsg) {
            errMsg = error.clientErrorMsg;
        }
        else if (error.serverError) {
            if (error.status == 401)
                return; //Don't show unauthorized error
            if (typeof error.serverError === 'object') {
                errMsg = error.status + ": " + JSON.stringify(error.serverError);
            }
            else {
                errMsg = error.status + ": " + error.serverError;
            }
        }
        console.info("Error: " + errMsg);
        if (!errMsg)
            errMsg = "Unknown error.";
        if (errMsg.length > 80) {
            more = errMsg;
            errMsg = errMsg.substring(0, 80) + "...";
        }
        /** @type {?} */
        let errorToastConfig = {
            content: errMsg,
            more: more
        };
        /** @type {?} */
        let errorToast = new ErrorToast(errorToastConfig);
        errorToast.show();
    }
    /**
     * @protected
     * @return {?}
     */
    populatePages() {
        this.pages = [];
        /** @type {?} */
        const SHOW_PAGE = 9;
        /** @type {?} */
        const HALF = (SHOW_PAGE - 1) / 2;
        /** @type {?} */
        let min;
        /** @type {?} */
        let max;
        if (this.total_pages <= SHOW_PAGE) {
            min = 1;
            max = this.total_pages;
            this.left_more = false;
            this.right_more = false;
        }
        else {
            if (this.page - 1 < HALF) {
                min = 1;
                max = SHOW_PAGE - 1;
                this.left_more = false;
                this.right_more = true;
            }
            else if (this.total_pages - this.page < HALF) {
                max = this.total_pages;
                min = (this.total_pages - SHOW_PAGE + 1) + 1;
                this.left_more = true;
                this.right_more = false;
            }
            else {
                min = this.page - HALF + 1;
                max = this.page + HALF - 1;
                this.left_more = true;
                this.right_more = true;
            }
        }
        for (let i = min; i <= max; i++) {
            this.pages.push(i);
        }
    }
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    getKey(key) {
        /** @type {?} */
        let url = this.router.url.split(';')[0].split('?')[0];
        return url + ":" + key;
    }
    /**
     * @private
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    putToStorage(key, value) {
        if (this.majorUi) {
            //only major UI we want to cache and recover when user comes back
            this.commonService.putToStorage(this.getKey(key), value);
        }
        else {
            this.storage[key] = value;
        }
    }
    /**
     * @private
     * @param {?} key
     * @return {?}
     */
    getFromStorage(key) {
        if (this.majorUi) {
            return this.commonService.getFromStorage(this.getKey(key));
        }
        else {
            return this.storage[key];
        }
    }
    /**
     * @private
     * @param {?} page
     * @return {?}
     */
    routeToPage(page) {
        this.putToStorage("page", page);
        this.populateList();
    }
    /**
     * @protected
     * @return {?}
     */
    onNextPage() {
        if (this.page >= this.total_pages)
            return;
        this.routeToPage(this.page + 1);
    }
    /**
     * @protected
     * @return {?}
     */
    onPreviousPage() {
        if (this.page <= 1)
            return;
        this.routeToPage(this.page - 1);
    }
    /**
     * @protected
     * @param {?} p
     * @return {?}
     */
    onGotoPage(p) {
        if (p > this.total_pages || p < 1)
            return;
        this.routeToPage(p);
    }
    /**
     * @protected
     * @return {?}
     */
    goBack() {
        this.location.back();
        /*
        // window.history.back();
        if (this.view != ViewType.EDIT)
            this.location.back();
        else {
            let url = this.location.path(); //in EDIT view, the current url is skipped. So get the "previous" one from path.
            this.router.navigateByUrl(url);
        }
        */
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    stringify(detail) {
        /** @type {?} */
        let str = "";
        for (let fnm of this.indexFields) {
            if (detail[fnm] && typeof detail[fnm] != 'object')
                str += " " + detail[fnm];
        }
        if (!str) {
            for (let prop in detail) {
                if (prop !== '_id' && detail[prop] && typeof detail[prop] != 'object') {
                    str += " " + detail[prop];
                }
            }
        }
        if (!str)
            str = detail["_id"] ? detail["_id"] : "...";
        str = str.replace(/^\s+|\s+$/g, '');
        if (str.length > 30)
            str = str.substr(0, 27) + '...';
        return str;
    }
    /**
     * Start: handle reference fields**
     * @protected
     * @param {?} field
     * @param {?} fieldName
     * @return {?}
     */
    formatReferenceField(field, fieldName) {
        /** @type {?} */
        let id;
        /** @type {?} */
        let value;
        if (typeof field == 'string') {
            //assume this is the "_id", let see we have the cached details for this ref from service
            /** @type {?} */
            let refDetail = this.commonService.getFromStorage(field);
            if (refDetail && (typeof refDetail == 'object'))
                field = refDetail;
            else {
                id = field;
                field = { '_id': id };
            }
        }
        else if (field && (typeof field == 'object')) {
            id = field['_id'];
            /** @type {?} */
            let referIndex = '';
            for (let k in field) {
                if (k != '_id')
                    referIndex += " " + field[k];
            }
            referIndex = referIndex.replace(/^\s+|\s+$/g, '');
            if (referIndex.length >= 20)
                referIndex = referIndex.substring(0, 20) + "...";
            field = { '_id': id, 'value': referIndex ? referIndex : fieldName };
        }
        else { //not defined
            field = { '_id': id, 'value': value };
        }
        return field;
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    formatReference(detail) {
        for (let fnm of this.referenceFields) {
            detail[fnm] = this.formatReferenceField(detail[fnm], fnm);
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    deFormatReference(detail) {
        for (let fnm of this.referenceFields) {
            if (typeof detail[fnm] !== 'object') { //not defined
                //let date values undefined
                delete detail[fnm];
            }
            else {
                /** @type {?} */
                let id = detail[fnm]['_id'];
                if (typeof id !== 'string')
                    delete detail[fnm];
                else
                    detail[fnm] = id;
            }
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    clearFieldReference(field) {
        for (let prop in field) {
            field[prop] = undefined;
        }
        return field;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    isDefinedFieldReference(field) {
        if ('_id' in field && typeof field['_id'] == 'string')
            return true;
        return false;
    }
    /**
     * Start: handle date fields**
     * @protected
     * @param {?} field
     * @return {?}
     */
    formatDateField(field) {
        /** @type {?} */
        let fmt = this.dateFormat;
        /** @type {?} */
        let t_fmt = this.timeFormat;
        /** @type {?} */
        let d;
        /** @type {?} */
        let M;
        /** @type {?} */
        let yyyy;
        /** @type {?} */
        let h;
        /** @type {?} */
        let m;
        /** @type {?} */
        let s;
        /** @type {?} */
        let dt = new Date(field);
        /** @type {?} */
        let dd;
        /** @type {?} */
        let MM;
        /** @type {?} */
        let hh;
        /** @type {?} */
        let mm;
        /** @type {?} */
        let ss;
        d = dt.getDate();
        M = dt.getMonth() + 1;
        yyyy = dt.getFullYear();
        /** @type {?} */
        let yy = yyyy.toString().slice(2);
        h = dt.getHours();
        m = dt.getMinutes();
        s = dt.getSeconds();
        dd = d < 10 ? '0' + d : d.toString();
        MM = M < 10 ? '0' + M : M.toString();
        hh = h < 10 ? '0' + h : h.toString();
        mm = m < 10 ? '0' + m : m.toString();
        ss = s < 10 ? '0' + s : s.toString();
        /** @type {?} */
        let value = fmt.replace(/yyyy/ig, yyyy.toString()).
            replace(/yy/ig, yy.toString()).
            replace(/MM/g, MM.toString()).
            replace(/dd/ig, dd.toString());
        /** @type {?} */
        let t_value = t_fmt.replace(/hh/ig, hh.toString()).
            replace(/mm/g, mm.toString()).
            replace(/ss/ig, ss.toString());
        /*Datepicker uses NgbDateStruct as a model and not the native Date object.
        It's a simple data structure with 3 fields. Also note that months start with 1 (as in ISO 8601).
        
        we add h, m, s here
        */
        //"from" and "to" used for search context. pop: show the selection popup
        return { 'date': { day: d, month: M, year: yyyy }, 'value': value, 'from': undefined, 'to': undefined, 'pop': false,
            'time': { hour: h, minute: m, second: s }, 't_value': value, 't_from': undefined, 't_to': undefined, 't_pop': false };
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    formatDate(detail) {
        for (let fnm of this.dateFields) {
            /** @type {?} */
            let value;
            /** @type {?} */
            let date;
            if (typeof detail[fnm] !== 'string') { //not defined
                //important: let date values undefined. "from" and "to" used for search context. pop: show the selection popup
                detail[fnm] = { 'date': undefined, 'value': undefined, 'from': undefined, 'to': undefined, 'pop': false };
            }
            else {
                detail[fnm] = this.formatDateField(detail[fnm]);
            }
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} date
     * @return {?}
     */
    deFormatDateField(date) {
        /** @type {?} */
        let d;
        /** @type {?} */
        let M;
        /** @type {?} */
        let yyyy;
        /** @type {?} */
        let h;
        /** @type {?} */
        let m;
        /** @type {?} */
        let s;
        yyyy = date.year;
        M = date.month - 1;
        d = date.day;
        if (typeof yyyy !== 'number' || typeof M !== 'number' || typeof d !== 'number')
            return null;
        else {
            /** @type {?} */
            let dt = new Date(yyyy, M, d, 0, 0, 0, 0);
            return dt.toISOString();
        }
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    deFormatDate(detail) {
        for (let fnm of this.dateFields) {
            /** @type {?} */
            let value;
            if (typeof detail[fnm] !== 'object') { //not defined
                //let date values undefined
                delete detail[fnm];
            }
            else {
                if (!detail[fnm].date)
                    delete detail[fnm];
                else {
                    /** @type {?} */
                    let dateStr = this.deFormatDateField(detail[fnm].date);
                    if (!dateStr)
                        delete detail[fnm];
                    else
                        detail[fnm] = dateStr;
                }
            }
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    clearFieldDate(field) {
        for (let prop in field) {
            field[prop] = undefined;
        }
        return field;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    isDefinedFieldDate(field) {
        if (typeof field === 'object') {
            if (typeof field['date'] == 'object')
                return true;
            if (typeof field['from'] == 'object')
                return true;
            if (typeof field['to'] == 'object')
                return true;
        }
        return false;
    }
    /**
     * Start: handle array of multi-selection fields**
     * @protected
     * @param {?} field
     * @param {?} enums
     * @return {?}
     */
    formatArrayMultiSelectionField(field, enums) {
        /** @type {?} */
        let selectObj = {};
        /** @type {?} */
        let value = "";
        for (let e of enums) {
            selectObj[e] = false; //not exist
        }
        if (Array.isArray(field)) { //not defined
            for (let e of field) {
                selectObj[e] = true; //exist.
            }
            value = field.join(" | ");
        }
        return { 'selection': selectObj, value: value };
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    formatArrayMultiSelection(detail) {
        for (let fnm of this.multiSelectionFields) {
            detail[fnm] = this.formatArrayMultiSelectionField(detail[fnm], this.enums[fnm]);
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    deFormatArrayMultiSelection(detail) {
        for (let fnm of this.multiSelectionFields) {
            if (typeof detail[fnm] !== 'object') { //not defined
                delete detail[fnm];
            }
            else {
                if (!detail[fnm].selection)
                    delete detail[fnm];
                else {
                    /** @type {?} */
                    let selectArray = [];
                    for (let e of this.enums[fnm]) {
                        if (detail[fnm].selection[e])
                            selectArray.push(e);
                    }
                    if (selectArray.length > 0)
                        detail[fnm] = selectArray;
                    else
                        delete detail[fnm];
                }
            }
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    clearFieldArrayMultiSelection(field) {
        if (!field['selection'])
            return field;
        for (let prop in field['selection']) {
            field['selection'][prop] = false; //not exist
        }
        return field;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    isDefinedFieldArrayMultiSelection(field) {
        if ('selection' in field && typeof field['selection'] == 'object') {
            /** @type {?} */
            let keys = Object.keys(field['selection']);
            return keys.some(e => { return field['selection'][e]; });
        }
        return false;
    }
    /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    multiselectionSelected(fieldName) {
        if (!this.detail[fieldName] || typeof this.detail[fieldName]['selection'] != 'object') {
            return false;
        }
        return this.isDefinedFieldArrayMultiSelection(this.detail[fieldName]);
    }
    /***End: handle array of multi-selection fields***/
    /**
     * Start: handle map fields**
     * @protected
     * @param {?} field
     * @param {?} elementType
     * @return {?}
     */
    formatMapField(field, elementType) {
        /** @type {?} */
        let selectObj = {};
        /** @type {?} */
        let values = [];
        if (typeof field == 'object') {
            selectObj = field;
            for (let e in field) {
                if (elementType === 'SchemaString') {
                    values.push(e + "(" + field[e] + ")");
                }
            }
        }
        values = values.filter(x => !!x);
        /** @type {?} */
        let value = values.join(" | ");
        return { 'selection': selectObj, value: value, keys: [] };
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    formatMapFields(detail) {
        for (let f of this.mapFields) {
            //[fieldName, elementType]
            detail[f[0]] = this.formatMapField(detail[f[0]], f[1]);
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    deFormatMapFields(detail) {
        for (let f of this.mapFields) {
            //[fieldName, elementType]
            /** @type {?} */
            let fnm = f[0];
            /** @type {?} */
            let elementType = f[1];
            if (typeof detail[fnm] !== 'object') { //not defined
                delete detail[fnm];
            }
            else {
                if (!detail[fnm].selection)
                    delete detail[fnm];
                else {
                    /** @type {?} */
                    let selectMap = detail[fnm].selection;
                    for (let e in detail[fnm].selection) {
                        if (elementType === 'SchemaString') {
                            ;
                        }
                    }
                    if (Object.keys(selectMap).length > 0)
                        detail[fnm] = selectMap;
                    else
                        delete detail[fnm];
                }
            }
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    clearFieldMap(field) {
        if (!field['selection'])
            return field;
        field['selection'] = {};
        field.value = undefined;
        return field;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    isDefinedFieldMap(field) {
        if ('selection' in field && typeof field['selection'] == 'object') {
            return Object.keys(field['selection']).length > 0;
        }
        return false;
    }
    /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    mapSelected(fieldName) {
        if (!this.detail[fieldName] || typeof this.detail[fieldName]['selection'] != 'object') {
            return false;
        }
        return this.isDefinedFieldMap(this.detail[fieldName]);
    }
    /***End: handle map fields***/
    /**
     * Start: handle array fields**
     * @protected
     * @param {?} field
     * @param {?} elementType
     * @return {?}
     */
    formatArrayField(field, elementType) {
        /** @type {?} */
        let selectArray = [];
        /** @type {?} */
        let values = [];
        if (Array.isArray(field)) { //not defined
            for (let e of field) {
                if (elementType === 'ObjectId') {
                    /** @type {?} */
                    let ref = this.formatReferenceField(e, "...");
                    selectArray.push(ref);
                    values.push(ref.value);
                }
                else if (elementType === 'SchemaString') {
                    selectArray.push(e);
                    values.push(e);
                }
            }
        }
        values = values.filter(x => !!x);
        /** @type {?} */
        let value = values.join(" | ");
        return { 'selection': selectArray, value: value };
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    formatArrayFields(detail) {
        for (let f of this.arrayFields) {
            //[fieldName, elementType]
            detail[f[0]] = this.formatArrayField(detail[f[0]], f[1]);
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    deFormatArrayFields(detail) {
        for (let f of this.arrayFields) {
            //[fieldName, elementType]
            /** @type {?} */
            let fnm = f[0];
            /** @type {?} */
            let elementType = f[1];
            if (typeof detail[fnm] !== 'object') { //not defined
                delete detail[fnm];
            }
            else {
                if (!detail[fnm].selection)
                    delete detail[fnm];
                else {
                    /** @type {?} */
                    let selectArray = [];
                    for (let e of detail[fnm].selection) {
                        if (elementType === 'ObjectId') {
                            if (e && e['_id'] && typeof e['_id'] === 'string')
                                selectArray.push(e['_id']);
                        }
                        else if (elementType === 'SchemaString') {
                            if (e)
                                selectArray.push(e);
                        }
                    }
                    if (selectArray.length > 0)
                        detail[fnm] = selectArray;
                    else
                        delete detail[fnm];
                }
            }
        }
        return detail;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    clearFieldArray(field) {
        if (!field['selection'])
            return field;
        field['selection'] = [];
        field.value = undefined;
        return field;
    }
    /**
     * @protected
     * @param {?} field
     * @return {?}
     */
    isDefinedFieldArray(field) {
        if ('selection' in field && Array.isArray(field['selection'])) {
            return field['selection'].length > 0;
        }
        return false;
    }
    /**
     * @protected
     * @param {?} fieldName
     * @return {?}
     */
    arraySelected(fieldName) {
        if (!this.detail[fieldName] || !Array.isArray(this.detail[fieldName]['selection'])) {
            return false;
        }
        return this.isDefinedFieldArray(this.detail[fieldName]);
    }
    /**
     * End: handle array fields**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    formatDetail(detail) {
        detail = this.formatReference(detail);
        detail = this.formatDate(detail);
        detail = this.formatArrayMultiSelection(detail);
        detail = this.formatArrayFields(detail);
        detail = this.formatMapFields(detail);
        return detail;
    }
    /**
     * @protected
     * @param {?} detail
     * @return {?}
     */
    deFormatDetail(detail) {
        /** @type {?} */
        let cpy = Util.clone(detail);
        cpy = this.deFormatReference(cpy);
        cpy = this.deFormatDate(cpy);
        cpy = this.deFormatArrayMultiSelection(cpy);
        cpy = this.deFormatArrayFields(cpy);
        cpy = this.deFormatMapFields(cpy);
        return cpy;
    }
    /**
     * @protected
     * @param {?} id
     * @return {?}
     */
    populateDetail(id) {
        return this.populateDetailForAction(id, null);
    }
    /**
     * @protected
     * @param {?} id
     * @param {?} action
     * @return {?}
     */
    populateDetailForAction(id, action) {
        //action: eg: action=edit  -> get detail for editing purpose 
        this.service.getDetailForAction(id, action).subscribe(detail => {
            /** @type {?} */
            let originalDetail = Util.clone(detail);
            if (detail["_id"])
                this.commonService.putToStorage(detail["_id"], originalDetail); //cache it
            this.detail = this.formatDetail(detail);
            this.extraFieldsUnload(); //unload data to text editors, etc
            if (action == 'edit') {
                this.extraInfoPopulate(); //collect other info required for edit view
            }
            if (this.refreshing) {
                this.refreshing = false;
                /** @type {?} */
                let snackBarConfig = {
                    content: "Detail refreshed"
                };
                /** @type {?} */
                let snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
            }
            this.eventEmitter.emit(this.detail);
        }, this.onServiceError);
        return this.eventEmitter;
    }
    /**
     * @protected
     * @param {?} copy_id
     * @return {?}
     */
    populateDetailFromCopy(copy_id) {
        this.service.getDetail(copy_id).subscribe(detail => {
            this.detail = this.formatDetail(detail);
            delete this.detail["_id"];
            this.extraFieldsUnload(); //unload data to text editors, etc
            this.extraInfoPopulate(); //collect other info required for create view
        }, this.onServiceError);
    }
    /**
     * @protected
     * @return {?}
     */
    extraInfoPopulate() {
        for (let fieldDef of this.mapFields) {
            //fieldDef: [field.fieldName, field.elementType, keyType, keyRefName, keyRefService, keyRefSubField]
            /** @type {?} */
            let fieldName = fieldDef[0];
            //this.<keyRefName>.<keyRefSubField>
            /** @type {?} */
            let mapKeyType = fieldDef[2];
            //this.<keyRefName>.<keyRefSubField>
            /** @type {?} */
            let keyArray = [];
            if (mapKeyType == "ObjectId") {
                /** @type {?} */
                let keyRefName = fieldDef[3];
                /** @type {?} */
                let recordKey = 'key-id-' + keyRefName;
                /** @type {?} */
                let refService = this.injector.get(fieldDef[4]);
                /** @type {?} */
                let id = this.detail[keyRefName] ? this.detail[keyRefName]['_id'] : undefined;
                if (!id)
                    continue;
                /** @type {?} */
                let mapField = this.detail[fieldName];
                if (mapField[recordKey] == id)
                    continue; //already populated for the same id
                refService.getDetail(id).subscribe(detail => {
                    if (Array.isArray(detail[fieldDef[5]])) {
                        keyArray = detail[fieldDef[5]];
                        mapField['keys'] = keyArray;
                        mapField[recordKey] = id; //record that keys is populated from this object
                        if (mapField['selection']) {
                            for (let k of keyArray) {
                                if (!(k in mapField['selection']))
                                    mapField['selection'][k] = "";
                            }
                        }
                    }
                }, this.onServiceError);
            }
        }
    }
    /**
     * @private
     * @param {?} arr1
     * @param {?} arr2
     * @return {?}
     */
    equalTwoSearchContextArrays(arr1, arr2) {
        if (!arr1)
            arr1 = [];
        if (!arr2)
            arr2 = [];
        if (arr1.length == 0 && arr2.length == 0)
            return true;
        //all object in array has format of {'field': 'value'} format
        /**
         * @param {?} a
         * @param {?} b
         * @return {?}
         */
        function compareObj(a, b) {
            /** @type {?} */
            let a_s = JSON.stringify(a);
            /** @type {?} */
            let b_s = JSON.stringify(b);
            if (a_s < b_s)
                return -1;
            if (a_s > b_s)
                return 1;
            return 0;
        }
        arr1 = arr1.sort(compareObj);
        arr2 = arr2.sort(compareObj);
        if (JSON.stringify(arr1) == JSON.stringify(arr2))
            return true;
        return false;
    }
    /**
     * @protected
     * @return {?}
     */
    processSearchContext() {
        this.moreSearchOpened = false;
        /** @type {?} */
        let d = this.detail;
        for (let s of this.stringFields) {
            d[s] = this.searchText;
        }
        /** @type {?} */
        let orSearchContext = [];
        /** @type {?} */
        let andSearchContext = [];
        for (let field in d) {
            if (typeof d[field] == 'string') {
                /** @type {?} */
                let o = {};
                o[field] = d[field];
                orSearchContext.push(o);
            }
        }
        this.searchMoreDetail = [];
        /** @type {?} */
        let d2 = this.deFormatDetail(d);
        for (let field in d2) {
            if (this.stringFields.indexOf(field) == -1) { //string fields already put to orSearchContext
                //string fields already put to orSearchContext
                /** @type {?} */
                let o = {};
                /** @type {?} */
                let valueToShow;
                o[field] = d2[field];
                if (this.multiSelectionFields.includes(field)) {
                    o[field] = { $in: d2[field] }; //use $in for or, and $all for and
                    //use $in for or, and $all for and
                    /** @type {?} */
                    let t = this.formatArrayMultiSelectionField(d2[field], this.enums[field]);
                    valueToShow = t.value;
                }
                else if (this.arrayFields.some(x => x[0] == field)) {
                    o[field] = { $in: d2[field] }; //use $in for or, and $all for and
                    valueToShow = d[field]['value'];
                }
                else if (this.dateFields.includes(field)) {
                    /** @type {?} */
                    let t = this.formatDateField(d2[field]);
                    valueToShow = t.value;
                }
                else if (this.referenceFields.includes(field)) {
                    valueToShow = valueToShow = d[field]['value'];
                }
                else {
                    valueToShow = d[field]; //take directoy from what we get 
                }
                this.searchMoreDetail.push([field, valueToShow]);
                andSearchContext.push(o);
            }
        }
        //Handle date range selection. These fields are not in d2, because field.date is undefined.
        for (let prop of this.dateFields) {
            /** @type {?} */
            let o = {};
            /** @type {?} */
            let valueToShow = "";
            o[prop] = {};
            if (typeof d[prop] !== 'object') { //not defined
                continue;
            }
            if (!d[prop]['from'] && !d[prop]['to']) { //not range
                continue;
            }
            if (d[prop]['from']) {
                o[prop]['from'] = this.deFormatDateField(d[prop]['from']);
                valueToShow += this.formatDateField(o[prop]['from']).value;
            }
            valueToShow += " ~ ";
            if (d[prop]['to']) {
                o[prop]['to'] = this.deFormatDateField(d[prop]['to']);
                valueToShow += this.formatDateField(o[prop]['to']).value;
            }
            this.searchMoreDetail.push([prop, valueToShow]);
            andSearchContext.push(o);
        }
        /** @type {?} */
        let searchContext = { '$and': [{ '$or': orSearchContext }, { '$and': andSearchContext }] };
        /* searchContext ={'$and', [{'$or', []},{'$and', []}]}
                */
        /** @type {?} */
        let context = this.getFromStorage("searchContext");
        if (context && context["$and"]) {
            /** @type {?} */
            let cachedOr;
            /** @type {?} */
            let cachedAnd;
            for (let sub of context["$and"]) {
                if ('$and' in sub)
                    cachedAnd = sub['$and'];
                else if ('$or' in sub)
                    cachedOr = sub['$or'];
            }
            if (this.equalTwoSearchContextArrays(cachedOr, orSearchContext)
                && this.equalTwoSearchContextArrays(cachedAnd, andSearchContext)) {
                return;
            }
        }
        if (orSearchContext.length == 0 && andSearchContext.length == 0)
            searchContext = null;
        this.putToStorage("searchContext", searchContext);
        this.putToStorage("searchText", this.searchText);
        this.putToStorage("page", 1); //start from 1st page
        this.putToStorage("searchMoreDetail", this.searchMoreDetail);
        this.putToStorage("detail", this.detail);
    }
    /**
     * @protected
     * @return {?}
     */
    searchList() {
        this.processSearchContext();
        //update the URL
        this.router.navigate(['.', {}], { relativeTo: this.route }); //start from 1st page
        this.putToStorage("page", 1); //start from 1st page
        this.populateList();
    }
    /**
     * @protected
     * @return {?}
     */
    loadUIFromCache() {
        //Now let's reload the search condition to UI
        this.searchText = this.getFromStorage("searchText");
        this.searchMoreDetail = this.getFromStorage("searchMoreDetail");
        /** @type {?} */
        let detail = this.getFromStorage("detail");
        if (detail)
            this.detail = detail;
    }
    /**
     * @protected
     * @return {?}
     */
    populateList() {
        //First let's handle page
        /** @type {?} */
        let new_page;
        /** @type {?} */
        let searchContext;
        /** @type {?} */
        let searchText;
        /** @type {?} */
        let url_page = parseInt(this.route.snapshot.paramMap.get('page'));
        /** @type {?} */
        let cached_page = parseInt(this.getFromStorage("page"));
        if (cached_page) {
            new_page = cached_page;
            if (cached_page == 1)
                this.router.navigate(['.', {}], { relativeTo: this.route, }); //update the url
            else
                this.router.navigate(['.', { page: cached_page }], { relativeTo: this.route, }); //update the url
        }
        else if (url_page)
            new_page = url_page;
        else
            new_page = 1;
        searchContext = this.getFromStorage("searchContext");
        this.loadUIFromCache();
        this.service.getList(new_page, this.per_page, searchContext).subscribe(result => {
            this.list = result.items.map(x => this.formatDetail(x));
            this.page = result.page;
            this.per_page = result.per_page;
            this.total_count = result.total_count;
            this.total_pages = result.total_pages;
            this.populatePages();
            this.checkedItem =
                Array.apply(null, Array(this.list.length)).map(Boolean.prototype.valueOf, false);
            this.checkAll = false;
            if (this.refreshing) {
                this.refreshing = false;
                /** @type {?} */
                let snackBarConfig = {
                    content: "List refreshed"
                };
                /** @type {?} */
                let snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
            }
            this.eventEmitter.emit(this.list);
        }, this.onServiceError);
        return this.eventEmitter;
    }
    /*UI operations handlers*/
    /**
     * @return {?}
     */
    onRefresh() {
        if (this.view == ViewType.LIST) {
            this.refreshing = true;
            this.populateList();
        }
        else if (this.view == ViewType.DETAIL) {
            this.refreshing = true;
            if (!this.id)
                this.id = this.route.snapshot.paramMap.get('id');
            if (this.id)
                this.populateDetail(this.id);
            else
                console.error("Routing error for detail view... no id...");
        }
    }
    /**
     * @return {?}
     */
    onCheckAllChange() {
        this.checkedItem =
            Array.apply(null, Array(this.list.length)).
                map(Boolean.prototype.valueOf, this.checkAll);
    }
    /**
     * @return {?}
     */
    isItemSelected() {
        return this.checkedItem.some((value) => { return value; });
    }
    /**
     * @return {?}
     */
    onDeleteSelected() {
        /** @type {?} */
        let deletedItem = [];
        this.checkedItem.forEach((value, index) => {
            if (value) {
                deletedItem.push(this.list[index]["_id"]);
            }
        });
        /** @type {?} */
        let modalConfig = {
            title: "Delete Confirmation",
            content: "Are you sure you want to delete selected items from the system?",
            //list of button text
            buttons: ['Delete', 'Cancel'],
            //list of button returns when clicked
            returns: [true, false],
            callBack: (result) => {
                if (result) {
                    this.service.deleteManyByIds(deletedItem).subscribe(result => {
                        /** @type {?} */
                        let snackBarConfig = {
                            content: this.ItemCamelName + " deleted"
                        };
                        /** @type {?} */
                        let snackBar = new SnackBar(snackBarConfig);
                        snackBar.show();
                        if (this.view != ViewType.LIST)
                            this.router.navigate(['../../list'], { relativeTo: this.route });
                        else {
                            /** @type {?} */
                            let len = this.checkedItem.length;
                            for (let i = 0; i < len; i++) {
                                /** @type {?} */
                                let idx = len - 1 - i;
                                /** @type {?} */
                                let value = this.checkedItem[idx];
                                if (value) {
                                    this.list.splice(idx, 1);
                                    this.checkedItem.splice(idx, 1);
                                    this.total_count -= 1;
                                }
                            }
                            ;
                        }
                    }, this.onServiceError);
                }
            }
        };
        /** @type {?} */
        let modal = new Modal(modalConfig);
        modal.show();
    }
    /**
     * @param {?} id
     * @param {?} idx
     * @return {?}
     */
    onDelete(id, idx) {
        /** @type {?} */
        let modalConfig = {
            title: "Delete Confirmation",
            content: "Are you sure you want to delete this " + this.itemCamelName + " from the system?",
            //list of button text
            buttons: ['Delete', 'Cancel'],
            //list of button returns when clicked
            returns: [true, false],
            callBack: (result) => {
                if (result) {
                    this.service.deleteOne(id).subscribe(result => {
                        /** @type {?} */
                        let snackBarConfig = {
                            content: this.ItemCamelName + " deleted"
                        };
                        /** @type {?} */
                        let snackBar = new SnackBar(snackBarConfig);
                        snackBar.show();
                        if (this.view != ViewType.LIST)
                            this.router.navigate(['../../list'], { relativeTo: this.route });
                        else if (idx != null && this.list) {
                            this.list.splice(idx, 1);
                            this.checkedItem.splice(idx, 1);
                            this.total_count -= 1;
                        }
                    }, this.onServiceError);
                }
            }
        };
        /** @type {?} */
        let modal = new Modal(modalConfig);
        modal.show();
    }
    /**
     * @return {?}
     */
    onSubmit() {
        if (!this.extraFieldsLoad())
            return; //error from other non ngModel fields;
        this._detail = this.deFormatDetail(this.detail);
        if (this.id) {
            this.service.updateOne(this.id, this._detail).subscribe(result => {
                /** @type {?} */
                var snackBarConfig = {
                    content: this.ItemCamelName + " updated."
                };
                /** @type {?} */
                var snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
                this.router.navigate(['../../detail', this.id], { relativeTo: this.route });
            }, this.onServiceError);
        }
        else {
            this.service.createOne(this._detail).subscribe(result => {
                /** @type {?} */
                let action = this.subEdit ? " added" : " created.";
                /** @type {?} */
                var snackBarConfig = {
                    content: this.ItemCamelName + action
                };
                /** @type {?} */
                var snackBar = new SnackBar(snackBarConfig);
                snackBar.show();
                this.id = result["_id"];
                this._detail = result;
                if (this.subEdit) {
                    this.done.emit(true);
                }
                else {
                    this.router.navigate(['../detail', this.id], { relativeTo: this.route });
                }
            }, this.onServiceError);
        }
    }
    /**
     * @return {?}
     */
    editCancel() {
        if (this.subEdit) {
            this.done.emit(false);
        }
        else {
            this.goBack();
        }
    }
    /**
     * @param {?} fn
     * @param {?} detail
     * @param {?} event
     * @return {?}
     */
    onDisplayRefClicked(fn, detail, event) {
        /** @type {?} */
        let ref = this.getRefFromField(fn);
        /** @type {?} */
        let d = detail;
        if (d && d['_id']) {
            if (this.list) {
                for (let item of this.list) {
                    if (item[fn] == d)
                        this.clickedId = item['_id'];
                }
            }
            this.router.navigate([ref, 'detail', d['_id']], { relativeTo: this.getParentActivatedRouter() });
        }
        if (event)
            event.stopPropagation();
    }
    /**
     * @param {?} id
     * @return {?}
     */
    onDetailLinkClicked(id) {
        this.clickedId = id;
        this.router.navigate([this.itemName, 'detail', id], { relativeTo: this.getParentActivatedRouter() });
    }
    /**
     * @protected
     * @param {?} fn
     * @return {?}
     */
    getRefFromField(fn) {
        return this.referenceFieldsMap[fn];
    }
    /**
     * @param {?} field
     * @return {?}
     */
    clearValueFromDetail(field) {
        if (!this.detail.hasOwnProperty(field))
            return;
        if (typeof this.detail[field] == 'undefined')
            return;
        if (typeof this.detail[field] == 'object') { //reference field or date
            if (this.multiSelectionFields.includes(field)) {
                this.detail[field] = this.clearFieldArrayMultiSelection(this.detail[field]);
            }
            else if (this.arrayFields.some(x => x[0] == field)) {
                this.detail[field] = this.clearFieldArray(this.detail[field]);
            }
            else if (this.mapFields.some(x => x[0] == field)) {
                this.detail[field] = this.clearFieldMap(this.detail[field]);
            }
            else if (this.dateFields.includes(field)) {
                this.detail[field] = this.clearFieldDate(this.detail[field]);
            }
            else if (this.referenceFields.includes(field)) {
                this.detail[field] = this.clearFieldReference(this.detail[field]);
            }
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
        else {
            delete this.detail[field];
        }
    }
    /**
     * @param {?} field
     * @param {?} idx
     * @return {?}
     */
    clearValueFromArrayField(field, idx) {
        if (this.detail[field]['selection']) {
            this.detail[field]['selection'] = this.detail[field]['selection'].filter((x, i) => i != idx);
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
    }
    /**
     * @param {?} field
     * @param {?} key
     * @return {?}
     */
    clearValueFromMapField(field, key) {
        if (this.detail[field]['selection']) {
            delete this.detail[field]['selection'][key];
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
    }
    /**
     * @param {?} field
     * @param {?} key
     * @return {?}
     */
    clearValueFromMapKey(field, key) {
        if (this.detail[field]['selection']) {
            this.detail[field]['selection'][key] = undefined;
            //check if any info needs to change after clear certain values;
            this.extraInfoPopulate();
        }
    }
    /**
     * @param {?} field
     * @return {?}
     */
    checkValueDefinedFromDetail(field) {
        /** @type {?} */
        let d = this.detail;
        if (!d.hasOwnProperty(field))
            return false;
        if (typeof d[field] == 'undefined')
            return false;
        if (typeof this.detail[field] == 'number'
            || typeof d[field] == 'string'
            || typeof d[field] == 'boolean')
            return true;
        if (typeof d[field] == 'object') {
            if (this.multiSelectionFields.includes(field)) {
                return this.isDefinedFieldArrayMultiSelection(d[field]);
            }
            else if (this.arrayFields.some(x => x[0] == field)) {
                return this.isDefinedFieldArray(d[field]);
            }
            else if (this.mapFields.some(x => x[0] == field)) {
                return this.isDefinedFieldMap(d[field]);
            }
            else if (this.dateFields.includes(field)) {
                return this.isDefinedFieldDate(d[field]);
            }
            else if (this.referenceFields.includes(field)) {
                return this.isDefinedFieldReference(d[field]);
            }
        }
        return false;
    }
    /**
     * @param {?} field
     * @return {?}
     */
    clearValueFromDetailAndSearchList(field) {
        this.clearValueFromDetail(field);
        this.searchList();
    }
    /**
     * @param {?} fieldName
     * @return {?}
     */
    onAddArrayItem(fieldName) {
        if (this.arrayFields.some(x => x[0] == fieldName)) {
            if (this.detail[fieldName]['new']) { //where new added item is stored
                //where new added item is stored
                /** @type {?} */
                let item = this.detail[fieldName]['new'];
                this.detail[fieldName]['new'] = undefined; //clear it
                this.detail[fieldName]['selection'].push(item);
                /** @type {?} */
                let values = [];
                if (this.detail[fieldName]['value'])
                    values = this.detail[fieldName]['value'].split(' | ');
                values.push(item); //display value
                values = values.filter(x => !!x);
                this.detail[fieldName]['value'] = values.join(' | ');
                //see if related info needs to change after the change of this value
                this.extraInfoPopulate();
            }
        }
    }
    /**
     * @param {?} fieldName
     * @return {?}
     */
    onAddMapItem(fieldName) {
        if (this.mapFields.some(x => x[0] == fieldName)) {
            if (this.detail[fieldName]['new']) { //where new added item is stored
                //where new added item is stored
                /** @type {?} */
                let item = this.detail[fieldName]['new'];
                this.detail[fieldName]['new'] = undefined; //clear it
                this.detail[fieldName]['selection'][item] = undefined; //move to selection object
                //TODO: this.detail[fieldName]['value'] change
                //see if related info needs to change after the change of this value
                this.extraInfoPopulate();
            }
        }
    }
    /**
     * @param {?} fieldName
     * @return {?}
     */
    onRefSelect(fieldName) {
        if (!this.refSelectDirective) {
            console.warn("No reference directive for field: ", fieldName);
            return;
        }
        /** @type {?} */
        let viewContainerRef = this.refSelectDirective.viewContainerRef;
        viewContainerRef.clear();
        if (!this.selectComponents[fieldName]) {
            console.warn("No reference defined for field: ", fieldName);
            return;
        }
        /** @type {?} */
        let componentRef = this.selectComponents[fieldName]["componentRef"];
        if (!componentRef) {
            /** @type {?} */
            let comType = this.selectComponents[fieldName]["select-type"];
            if (!comType)
                console.warn("No component type found for reference field ", fieldName);
            /** @type {?} */
            let componentFactory = this.componentFactoryResolver.resolveComponentFactory(comType);
            componentRef = viewContainerRef.createComponent(componentFactory); //create and insert in one call
            this.selectComponents[fieldName]["componentRef"] = componentRef; //save it
        }
        else {
            viewContainerRef.insert(componentRef.hostView);
        }
        /** @type {?} */
        let componentInstance = (/** @type {?} */ (componentRef.instance));
        if (this.detail[fieldName]) {
            if (this.referenceFields.includes(fieldName)) {
                componentInstance.inputData = this.detail[fieldName]['_id'];
            }
        }
        componentInstance.setFocus();
        this.componentSubscription = componentInstance.done.subscribe((val) => {
            if (val) {
                this.componentSubscription.unsubscribe();
                viewContainerRef.detach(); //only detach. not destroy
            }
            /** @type {?} */
            let outputData = componentInstance.outputData;
            if (outputData) {
                switch (outputData.action) {
                    case "selected":
                        if (this.arrayFields.some(x => x[0] == fieldName)) {
                            this.detail[fieldName]['selection'].push(outputData.value);
                            /** @type {?} */
                            let values = [];
                            if (this.detail[fieldName]['value'])
                                values = this.detail[fieldName]['value'].split(' | ');
                            values.push(outputData.value.value); //display value
                            values = values.filter(x => !!x);
                            this.detail[fieldName]['value'] = values.join(' | ');
                        }
                        else if (this.referenceFields.includes(fieldName)) {
                            this.detail[fieldName] = outputData.value;
                        }
                        //trigger extraInfo populate, once reference changed.
                        this.extraInfoPopulate();
                        break;
                    case "view":
                        this.onRefShow(fieldName, "select", outputData.value); //value is _id
                        break;
                    default:
                        break;
                }
            }
        });
    }
    /**
     * @param {?} fieldName
     * @param {?} action
     * @param {?} id
     * @return {?}
     */
    onRefShow(fieldName, action, id) {
        if (!id && this.detail[fieldName])
            id = this.detail[fieldName]['_id'];
        if (!id) {
            console.error('Show reference but no id is given.');
            return;
        }
        /** @type {?} */
        let viewContainerRef = this.refSelectDirective.viewContainerRef;
        viewContainerRef.clear();
        /** @type {?} */
        let detailType = action + "-detail-type";
        //eg: select-detail-type, pop-detail-type
        /** @type {?} */
        let comType = this.selectComponents[fieldName][detailType];
        if (!comType) {
            console.error("No component type found for: %s", detailType);
            return;
        }
        /** @type {?} */
        let componentFactory = this.componentFactoryResolver.resolveComponentFactory(comType);
        /** @type {?} */
        let componentRef = viewContainerRef.createComponent(componentFactory);
        //create and insert in one call
        /** @type {?} */
        let componentInstance = (/** @type {?} */ (componentRef.instance));
        componentInstance.inputData = id;
        componentInstance.setFocus();
        componentInstance.done.subscribe((val) => {
            if (val) {
                componentInstance.done.unsubscribe();
                viewContainerRef.clear();
            }
            /** @type {?} */
            let outputData = componentInstance.outputData;
            if (outputData) {
                switch (outputData.action) {
                    case "selected":
                        if (this.arrayFields.some(x => x[0] == fieldName)) {
                            this.detail[fieldName]['selection'].push(outputData.value);
                            /** @type {?} */
                            let values = [];
                            if (this.detail[fieldName]['value'])
                                values = this.detail[fieldName]['value'].split(' | ');
                            values.push(outputData.value.value); //display value
                            values = values.filter(x => !!x);
                            this.detail[fieldName]['value'] = values.join(' | ');
                        }
                        else if (this.referenceFields.includes(fieldName)) {
                            this.detail[fieldName] = outputData.value;
                        }
                        //trigger extraInfo populate, once reference changed.
                        this.extraInfoPopulate();
                        break;
                    case "back":
                        this.onRefSelect(fieldName);
                        break;
                    default:
                        break;
                }
            }
        });
    }
    //ElementRef
    /**
     * @return {?}
     */
    setFocus() {
        if (this.focusEl)
            this.focusEl.nativeElement.focus();
    }
    /**
     * @return {?}
     */
    uiCloseModal() {
        this.outputData = null;
        this.done.emit(true);
    }
    /**
     * @return {?}
     */
    uiOnEscapeKey() {
        this.uiCloseModal();
    }
    /**
     * @param {?} num
     * @return {?}
     */
    selectItemSelected(num) {
        /** @type {?} */
        let detail = this.list[num];
        this.selectedId = detail['_id'];
        this.clickedId = detail['_id'];
        this.outputData = { action: "selected",
            value: { "_id": detail["_id"], "value": this.stringify(detail) },
            detail: detail
        };
        this.done.emit(true);
    }
    /**
     * @return {?}
     */
    detailSelSelected() {
        /** @type {?} */
        let detail = this.detail;
        this.outputData = { action: "selected",
            value: { "_id": detail["_id"], "value": this.stringify(detail) },
            detail: detail
        };
        this.done.emit(true);
    }
    /**
     * @param {?} num
     * @return {?}
     */
    selectViewDetail(num) {
        /** @type {?} */
        let detail = this.list[num];
        this.clickedId = detail['_id'];
        this.outputData = { action: "view",
            value: detail["_id"]
        };
        this.done.emit(true);
    }
    /**
     * @return {?}
     */
    detailSelBack() {
        this.outputData = { action: "back",
            value: null
        };
        this.done.emit(true);
    }
    /**
     * @return {?}
     */
    toggleMoreSearch() {
        this.moreSearchOpened = !this.moreSearchOpened;
    }
    /**
     * @return {?}
     */
    onSearchTextClear() {
        this.searchText = undefined;
        if (!this.moreSearchOpened)
            this.searchList();
    }
    /**
     * @return {?}
     */
    onSearchClear() {
        this.searchText = undefined;
        /** @type {?} */
        let detail = {};
        this.detail = this.formatDetail(detail);
        this.searchList();
    }
    /**
     * @protected
     * @return {?}
     */
    extraFieldsUnload() {
        if (this.textEditors) {
            this.textEditors.forEach(editor => {
                /** @type {?} */
                let fieldName = editor.name;
                /** @type {?} */
                let validatorObj = this.textEditorMap[fieldName];
                if (!validatorObj)
                    return;
                /** @type {?} */
                let content = this.detail[validatorObj.fieldName];
                if (content)
                    editor.setContent(content);
            });
        }
    }
    /**
     * @protected
     * @return {?}
     */
    extraFieldsLoad() {
        //to server
        /** @type {?} */
        let result = true;
        if (this.textEditors) {
            /** @type {?} */
            let array = this.textEditors.toArray();
            for (let editor of array) {
                /** @type {?} */
                let fieldName = editor.name;
                let [content, text] = editor.getContent();
                /** @type {?} */
                let validatorObj = this.textEditorMap[fieldName];
                if (!validatorObj)
                    continue;
                /** @type {?} */
                let fieldState = validatorObj.fieldState;
                fieldState.errors = {};
                if (!content) {
                    if (validatorObj.required) {
                        fieldState.errors.required = true;
                        fieldState.valid = false;
                        result = false;
                    }
                    continue;
                }
                if ('minlength' in validatorObj && text.length < validatorObj.minlength) {
                    fieldState.valid = false;
                    fieldState.errors.minlength = true;
                    result = false;
                    continue;
                }
                if ('maxlength' in validatorObj && text.length > validatorObj.maxlength) {
                    fieldState.valid = false;
                    fieldState.errors.maxlength = true;
                    result = false;
                    continue;
                }
                if ('validators' in validatorObj) {
                    /** @type {?} */
                    let error = validatorObj['validators'].validateValue(text);
                    if (error) {
                        fieldState.valid = false;
                        fieldState.errors = error;
                        result = false;
                        continue;
                    }
                }
                fieldState.valid = true;
                fieldState.errors = undefined;
                this.detail[validatorObj.fieldName] = content;
            }
        }
        return result;
    }
    /**
     * @param {?} editorName
     * @return {?}
     */
    onEdtiorPreview(editorName) {
        if (this.textEditors)
            this.textEditors.forEach((editor) => {
                if (editor.name == editorName)
                    editor.preview();
            });
    }
    /*Parent router related*/
    /**
     * @protected
     * @return {?}
     */
    getParentRouteItem() {
        /** @type {?} */
        let routeSnapshot = this.route.snapshot;
        /** @type {?} */
        let parentItem;
        do {
            if (routeSnapshot.data && routeSnapshot.data.mraLevel == 1) {
                parentItem = routeSnapshot.data.item;
                break;
            }
            routeSnapshot = routeSnapshot.parent;
        } while (routeSnapshot);
        return parentItem;
    }
    /**
     * @protected
     * @return {?}
     */
    getParentRouteItemId() {
        /** @type {?} */
        let routeSnapshot = this.route.snapshot;
        /** @type {?} */
        let parentItemId;
        do {
            if (routeSnapshot.data && routeSnapshot.data.mraLevel == 1 && ('id' in routeSnapshot.params)) {
                parentItemId = routeSnapshot.params.id;
                break;
            }
            routeSnapshot = routeSnapshot.parent;
        } while (routeSnapshot);
        return parentItemId;
    }
    /**
     * @protected
     * @return {?}
     */
    getParentRouteRefField() {
        /** @type {?} */
        let mp = this.referenceFieldsMap;
        for (let prop in mp) {
            if (mp.hasOwnProperty(prop) && mp[prop] == this.parentItem) {
                return prop;
            }
        }
    }
    /**
     * @protected
     * @return {?}
     */
    getParentActivatedRouter() {
        /** @type {?} */
        let route = this.route;
        do {
            /** @type {?} */
            let data = route.snapshot.data;
            //all route inside the mra system will have mraLevel data item
            if (!data.mraLevel)
                return route;
            route = route.parent;
        } while (route);
        return this.route.root;
    }
    /*Sub detail show flag*/
    /**
     * @param {?} i
     * @return {?}
     */
    toggleCheckedItem(i) {
        this.checkedItem[i] = !this.checkedItem[i];
    }
    /**
     * @return {?}
     */
    onAdd() {
        this.isAdding = true;
    }
    /**
     * @return {?}
     */
    toggleAdd() {
        this.isAdding = !this.isAdding;
    }
    /**
     * @param {?} result
     * @return {?}
     */
    onAddDone(result) {
        this.isAdding = false;
        if (result) { //add successful. Re-populate the current list
            if (this.view == ViewType.LIST) {
                this.populateList();
            }
        }
        else {
            ; //do nothing
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    onDateSelectionToggle(fn) {
        this.detail[fn]['pop'] = !this.detail[fn]['pop'];
    }
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    onDateSelection(fn, date) {
        if (!this.detail[fn]['from'] && !this.detail[fn]['to']) {
            this.detail[fn]['from'] = date;
        }
        else if (this.detail[fn]['from'] && !this.detail[fn]['to'] && date.after(this.detail[fn]['from'])) {
            this.detail[fn]['to'] = date;
            this.detail[fn]['pop'] = false; //Finished. hide the selection 
        }
        else {
            this.detail[fn]['to'] = null;
            this.detail[fn]['from'] = date;
        }
    }
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    isHovered(fn, date) {
        return this.detail[fn]['from'] && !this.detail[fn]['to'] && this.hoveredDate && date.after(this.detail[fn]['from']) && date.before(this.hoveredDate);
    }
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    isInside(fn, date) {
        return date.after(this.detail[fn]['from']) && date.before(this.detail[fn]['to']);
    }
    /**
     * @param {?} fn
     * @param {?} date
     * @return {?}
     */
    isRange(fn, date) {
        return date.equals(this.detail[fn]['from']) || date.equals(this.detail[fn]['to']) || this.isInside(fn, date) || this.isHovered(fn, date);
    }
}
if (false) {
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.objectKeys;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype.storage;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.list;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.majorUi;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.eventEmitter;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.page;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.per_page;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.total_count;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.total_pages;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype.new_page;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.pages;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.left_more;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.right_more;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.checkAll;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.checkedItem;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.detail;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype._detail;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype._extra;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.id;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.subEdit;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.enums;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.stringFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.referenceFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.referenceFieldsMap;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.dateFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.indexFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.multiSelectionFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.arrayFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.mapFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.dateFormat;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.timeFormat;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.hiddenFields;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.ItemCamelName;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.itemName;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.parentItem;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.refreshing;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.commonService;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.clickedId;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.refSelectDirective;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.selectComponents;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.componentFactoryResolver;
    /**
     * @type {?}
     * @private
     */
    BaseComponent.prototype.componentSubscription;
    /** @type {?} */
    BaseComponent.prototype.inputData;
    /** @type {?} */
    BaseComponent.prototype.outputData;
    /** @type {?} */
    BaseComponent.prototype.done;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.focusEl;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.selectedId;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.searchText;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.searchMoreDetail;
    /** @type {?} */
    BaseComponent.prototype.moreSearchOpened;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.textEditors;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.textEditorMap;
    /**
     * Any View - add new component in the current view
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.isAdding;
    /** @type {?} */
    BaseComponent.prototype.hoveredDate;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.service;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.injector;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.router;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.route;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.location;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.view;
    /**
     * @type {?}
     * @protected
     */
    BaseComponent.prototype.itemCamelName;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9tZWFuLXJlc3QtYW5ndWxhci8iLCJzb3VyY2VzIjpbImJhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFDQSxPQUFPLEVBQVksWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBT3ZELE9BQU8sRUFBZSxLQUFLLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDakQsT0FBTyxFQUFrQixRQUFRLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUMxRCxPQUFPLEVBQW9CLFVBQVUsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBRWhFLE9BQU8sRUFBZSxZQUFZLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUVwRCxPQUFPLEVBQUUsSUFBSSxFQUFFLE1BQU0sY0FBYyxDQUFDOzs7SUFHaEMsT0FBSTtJQUNKLFNBQU07SUFDTixPQUFJOzs7Ozs7QUFHUixPQUFPLEVBQUMsWUFBWSxFQUFDLENBQUM7QUFFdEIsTUFBTSxPQUFPLGFBQWE7Ozs7Ozs7Ozs7SUF1RHRCLFlBQ2MsT0FBb0IsRUFDcEIsUUFBa0IsRUFDbEIsTUFBYyxFQUNkLEtBQXFCLEVBQ3JCLFFBQWtCLEVBQ2xCLElBQWMsRUFDZCxhQUFxQjtRQU5yQixZQUFPLEdBQVAsT0FBTyxDQUFhO1FBQ3BCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUNkLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQ3JCLGFBQVEsR0FBUixRQUFRLENBQVU7UUFDbEIsU0FBSSxHQUFKLElBQUksQ0FBVTtRQUNkLGtCQUFhLEdBQWIsYUFBYSxDQUFRO1FBN0R6QixlQUFVLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQztRQUUzQixZQUFPLEdBQU8sRUFBRSxDQUFDOztRQUdmLFNBQUksR0FBUyxFQUFFLENBQUM7UUFFaEIsWUFB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OztJQUVsQyxxQ0FBNEI7Ozs7O0lBRTVCLHNDQUFnQzs7Ozs7SUFDaEMsaUNBQTJCOzs7OztJQUMzQixtQ0FBNkI7Ozs7O0lBRTdCLG1DQUFzQzs7Ozs7SUFFdEMsc0NBQTBDOzs7OztJQW84QjFDLGtDQUEyQjs7Ozs7SUFtSTNCLDJDQUFpQzs7Ozs7SUFDakMseUNBQStCOzs7OztJQUMvQixpREFBd0M7Ozs7O0lBQ3hDLDhDQUE2Qjs7SUFzSTdCLGtDQUFpQjs7SUFDakIsbUNBQWtCOztJQUNsQiw2QkFBZ0I7Ozs7O0lBQ2hCLGdDQUFrQjs7Ozs7SUFhbEIsbUNBQTRCOzs7OztJQXNDNUIsbUNBQTZCOzs7OztJQUM3Qix5Q0FBZ0M7O0lBQ2hDLHlDQUF3Qzs7Ozs7SUFnQnhDLG9DQUEwQjs7Ozs7SUFDMUIsc0NBQWlDOzs7Ozs7SUE0SGpDLGlDQUFvQzs7SUFtQnBDLG9DQUFpQjs7Ozs7SUFyNkNiLGdDQUE4Qjs7Ozs7SUFDOUIsaUNBQTRCOzs7OztJQUM1QiwrQkFBd0I7Ozs7O0lBQ3hCLDhCQUErQjs7Ozs7SUFDL0IsaUNBQTRCOzs7OztJQUM1Qiw2QkFBd0I7Ozs7O0lBQ3hCLHNDQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFJvdXRlciwgQWN0aXZhdGVkUm91dGUsIFBhcmFtTWFwIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IEluamVjdG9yLCBFdmVudEVtaXR0ZXIgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcblxuaW1wb3J0IHsgTG9jYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IE1vZGFsQ29uZmlnLCBNb2RhbH0gZnJvbSAnLi91dGlsLm1vZGFsJztcbmltcG9ydCB7IFNuYWNrQmFyQ29uZmlnLCBTbmFja0Jhcn0gZnJvbSAnLi91dGlsLnNuYWNrYmFyJztcbmltcG9ydCB7IEVycm9yVG9hc3RDb25maWcsIEVycm9yVG9hc3R9IGZyb20gJy4vdXRpbC5lcnJvcnRvYXN0JztcblxuaW1wb3J0IHsgQmFzZVNlcnZpY2UsIFNlcnZpY2VFcnJvciB9IGZyb20gJy4vYmFzZS5zZXJ2aWNlJztcbmltcG9ydCB7IE1yYUNvbW1vblNlcnZpY2UgfSBmcm9tICcuL2NvbW1vbi5zZXJ2aWNlJztcbmltcG9ydCB7IEJhc2VDb21wb25lbnRJbnRlcmZhY2UgfSBmcm9tICcuL2Jhc2UuaW50ZXJmYWNlJztcbmltcG9ydCB7IFV0aWwgfSBmcm9tICcuL3V0aWwudG9vbHMnO1xuXG5leHBvcnQgZW51bSBWaWV3VHlwZSB7XG4gICAgTElTVCxcbiAgICBERVRBSUwsXG4gICAgRURJVCxcbn1cblxuZXhwb3J0IHtTZXJ2aWNlRXJyb3J9O1xuXG5leHBvcnQgY2xhc3MgQmFzZUNvbXBvbmVudCBpbXBsZW1lbnRzIEJhc2VDb21wb25lbnRJbnRlcmZhY2Uge1xuICAgIHByb3RlY3RlZCBvYmplY3RLZXlzID0gT2JqZWN0LmtleXM7XG4gIFxuICAgIHByaXZhdGUgc3RvcmFnZTphbnkgPSB7fTtcblxuICAgIC8vRm9yIGxpc3QgYW5kIHBhZ2luYXRpb25cbiAgICBwcm90ZWN0ZWQgbGlzdDphbnlbXSA9IFtdO1xuICAgICAgICBcbiAgICBwcm90ZWN0ZWQgbWFqb3JVaSA9IHRydWU7XG4gICAgcHJvdGVjdGVkIGV2ZW50RW1pdHRlcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgXG4gICAgcHJvdGVjdGVkIHBhZ2U6IG51bWJlciA9IDE7XG4gICAgcHJvdGVjdGVkIHBlcl9wYWdlOiBudW1iZXIgPSAyNTtcbiAgICBwcm90ZWN0ZWQgdG90YWxfY291bnQ6IG51bWJlciA9IDA7XG4gICAgcHJvdGVjdGVkIHRvdGFsX3BhZ2VzOiBudW1iZXIgPSAwO1xuICAgIFxuICAgIHByaXZhdGUgbmV3X3BhZ2U7XG4gICAgXG4gICAgcHJvdGVjdGVkIHBhZ2VzOiBudW1iZXJbXSA9IFtdO1xuICAgIHByb3RlY3RlZCBsZWZ0X21vcmU6Ym9vbGVhbiA9IGZhbHNlO1xuICAgIHByb3RlY3RlZCByaWdodF9tb3JlOmJvb2xlYW4gPSBmYWxzZTtcblxuICAgIHByb3RlY3RlZCBjaGVja0FsbCA9IGZhbHNlO1xuICAgIC8vdXNlZCB0byBtYXJrIGRlbGV0ZWQgaXRlbXMsIG9yIGl0ZW1zIHRoYXQgd2lsbCBzaG93IHN1Yi1kZXRhaWwsIGV0Yy5cbiAgICBwcm90ZWN0ZWQgY2hlY2tlZEl0ZW06Ym9vbGVhbltdID0gW107XG4gICAgXG4gICAgLy9Gb3IgZWRpdCBhbmQgdmlldyBkZXRhaWxzXG4gICAgcHJvdGVjdGVkIGRldGFpbDphbnkgPSB7fTtcbiAgICBwcml2YXRlIF9kZXRhaWw6YW55ID0ge307IC8vYSBjbG9uZSBhbmQgdXNlZCB0byBzZW5kL3JlY2VpdmUgZnJvbSBuZXh0IHdvcmtcbiAgICBwcml2YXRlIF9leHRyYTphbnkgPSB7fTsgLy9leHRyYSBpbmZvLlxuICAgIHByb3RlY3RlZCBpZDpzdHJpbmc7XG4gICAgcHJvdGVjdGVkIHN1YkVkaXQgPSBmYWxzZTsgLy9hIGVkaXQtc3ViIGNvbXBvbmVudFxuICAgIC8vZm9yIGZpZWxkcyB3aXRoIGVudW0gdmFsdWVzXG4gICAgcHJvdGVjdGVkIGVudW1zOmFueSA9IHt9O1xuICAgIHByb3RlY3RlZCBzdHJpbmdGaWVsZHMgPSBbXTtcbiAgICBwcm90ZWN0ZWQgcmVmZXJlbmNlRmllbGRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIHByb3RlY3RlZCByZWZlcmVuY2VGaWVsZHNNYXAgPSB7fTtcbiAgICBwcm90ZWN0ZWQgZGF0ZUZpZWxkcyA9IFtdO1xuICAgIHByb3RlY3RlZCBpbmRleEZpZWxkcyA9IFtdO1xuICAgIHByb3RlY3RlZCBtdWx0aVNlbGVjdGlvbkZpZWxkcyA9IFtdO1xuICAgIHByb3RlY3RlZCBhcnJheUZpZWxkcyA9IFtdOyAvL2VsZW1lbnQgaXMgW2ZpZWxkTmFtZSwgZWxlbWVudFR5cGVdXG4gICAgcHJvdGVjdGVkIG1hcEZpZWxkcyA9IFtdOyAvL2VsZW1lbnQgaXMgW2ZpZWxkTmFtZSwgZWxlbWVudFR5cGUsIG1hcEtleV1cbiAgICBwcm90ZWN0ZWQgZGF0ZUZvcm1hdCA9IFwiTU0vREQvWVlZWVwiO1xuICAgIHByb3RlY3RlZCB0aW1lRm9ybWF0ID0gXCJoaDptbTpzc1wiO1xuXG4gICAgcHJvdGVjdGVkIGhpZGRlbkZpZWxkcyA9IFtdOyAvL2ZpZWxkcyBoaWRlIGZyb20gdmlldy4gQ3VycnJlbnRseSB1c2VkIGJ5IFwiQWRkXCIgdmlldyBvZiBlZGl0LXN1YlxuXG4gICAgcHJvdGVjdGVkIEl0ZW1DYW1lbE5hbWU6IHN0cmluZztcbiAgICBwcm90ZWN0ZWQgaXRlbU5hbWU6IHN0cmluZztcbiAgICBwcm90ZWN0ZWQgcGFyZW50SXRlbTogc3RyaW5nO1xuICBcbiAgICBwcm90ZWN0ZWQgcmVmcmVzaGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICBcbiAgICBwcm90ZWN0ZWQgY29tbW9uU2VydmljZTogTXJhQ29tbW9uU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcm90ZWN0ZWQgc2VydmljZTogQmFzZVNlcnZpY2UsXG4gICAgICAgIHByb3RlY3RlZCBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgICAgIHByb3RlY3RlZCByb3V0ZXI6IFJvdXRlcixcbiAgICAgICAgcHJvdGVjdGVkIHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSxcbiAgICAgICAgcHJvdGVjdGVkIGxvY2F0aW9uOiBMb2NhdGlvbixcbiAgICAgICAgcHJvdGVjdGVkIHZpZXc6IFZpZXdUeXBlLFxuICAgICAgICBwcm90ZWN0ZWQgaXRlbUNhbWVsTmFtZTogc3RyaW5nKSB7XG4gICAgICBcbiAgICAgICAgdGhpcy5JdGVtQ2FtZWxOYW1lID0gaXRlbUNhbWVsTmFtZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGl0ZW1DYW1lbE5hbWUuc3Vic3RyKDEpO1xuICAgICAgICB0aGlzLml0ZW1OYW1lID0gaXRlbUNhbWVsTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB0aGlzLnBhcmVudEl0ZW0gPSB0aGlzLmdldFBhcmVudFJvdXRlSXRlbSgpO1xuICAgICAgICB0aGlzLmNvbW1vblNlcnZpY2UgPSBpbmplY3Rvci5nZXQoTXJhQ29tbW9uU2VydmljZSk7XG4gICAgICAgIFxuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgb25TZXJ2aWNlRXJyb3IoZXJyb3I6U2VydmljZUVycm9yKTp2b2lkIHtcbiAgICAgICAgLy9jbGVhciBhbnkgcGVuZGluZyBmbGFnc1xuICAgICAgICB0aGlzLnJlZnJlc2hpbmcgPSBmYWxzZTtcbiAgICAgIFxuICAgICAgICBsZXQgZXJyTXNnOnN0cmluZztcbiAgICAgICAgbGV0IG1vcmU6c3RyaW5nO1xuICAgICAgICBpZiAoZXJyb3IuY2xpZW50RXJyb3JNc2cpIHtcbiAgICAgICAgICAgIGVyck1zZyA9IGVycm9yLmNsaWVudEVycm9yTXNnO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGVycm9yLnNlcnZlckVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09IDQwMSkgIHJldHVybjsgLy9Eb24ndCBzaG93IHVuYXV0aG9yaXplZCBlcnJvclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBlcnJvci5zZXJ2ZXJFcnJvciA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBlcnJNc2cgPSBlcnJvci5zdGF0dXMgKyBcIjogXCIgKyBKU09OLnN0cmluZ2lmeShlcnJvci5zZXJ2ZXJFcnJvcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVyck1zZyA9IGVycm9yLnN0YXR1cyArIFwiOiBcIiArZXJyb3Iuc2VydmVyRXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc29sZS5pbmZvKFwiRXJyb3I6IFwiICsgZXJyTXNnKTtcbiAgICAgICAgaWYgKCFlcnJNc2cpIGVyck1zZyA9IFwiVW5rbm93biBlcnJvci5cIjtcbiAgICAgICAgaWYgKGVyck1zZy5sZW5ndGggPiA4MCkge1xuICAgICAgICAgICAgbW9yZSA9IGVyck1zZztcbiAgICAgICAgICAgIGVyck1zZyA9IGVyck1zZy5zdWJzdHJpbmcoMCwgODApICsgXCIuLi5cIjtcbiAgICAgICAgfVxuICAgICAgICBsZXQgZXJyb3JUb2FzdENvbmZpZzogRXJyb3JUb2FzdENvbmZpZyA9IHtcbiAgICAgICAgICAgIGNvbnRlbnQ6IGVyck1zZyxcbiAgICAgICAgICAgIG1vcmU6IG1vcmVcbiAgICAgICAgfVxuICAgICAgICBsZXQgZXJyb3JUb2FzdCA9IG5ldyBFcnJvclRvYXN0KGVycm9yVG9hc3RDb25maWcpO1xuICAgICAgICBlcnJvclRvYXN0LnNob3coKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgcG9wdWxhdGVQYWdlcygpOnZvaWQgeyAgICAgICAgXG4gICAgICAgIHRoaXMucGFnZXMgPSBbXVxuICAgICAgICBjb25zdCBTSE9XX1BBR0UgPSA5O1xuICAgICAgICBjb25zdCBIQUxGID0gKFNIT1dfUEFHRS0xKS8yO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1pbiwgbWF4O1xuICAgICAgICBpZiAodGhpcy50b3RhbF9wYWdlcyA8PSBTSE9XX1BBR0UpIHtcbiAgICAgICAgICAgIG1pbiA9IDE7XG4gICAgICAgICAgICBtYXggPSB0aGlzLnRvdGFsX3BhZ2VzO1xuICAgICAgICAgICAgdGhpcy5sZWZ0X21vcmUgPSBmYWxzZTsgXG4gICAgICAgICAgICB0aGlzLnJpZ2h0X21vcmUgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhZ2UgLSAxIDwgSEFMRikge1xuICAgICAgICAgICAgICAgIG1pbiA9IDE7XG4gICAgICAgICAgICAgICAgbWF4ID0gU0hPV19QQUdFLTE7XG4gICAgICAgICAgICAgICAgdGhpcy5sZWZ0X21vcmUgPSBmYWxzZTsgXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodF9tb3JlID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50b3RhbF9wYWdlcyAtIHRoaXMucGFnZSA8IEhBTEYpIHtcbiAgICAgICAgICAgICAgICBtYXggPSB0aGlzLnRvdGFsX3BhZ2VzO1xuICAgICAgICAgICAgICAgIG1pbiA9ICh0aGlzLnRvdGFsX3BhZ2VzIC0gU0hPV19QQUdFICsgMSkgKyAxO1xuICAgICAgICAgICAgICAgIHRoaXMubGVmdF9tb3JlID0gdHJ1ZTsgXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodF9tb3JlID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1pbiA9IHRoaXMucGFnZSAtIEhBTEYgKyAxO1xuICAgICAgICAgICAgICAgIG1heCA9IHRoaXMucGFnZSArIEhBTEYgLSAxO1xuICAgICAgICAgICAgICAgIHRoaXMubGVmdF9tb3JlID0gdHJ1ZTsgXG4gICAgICAgICAgICAgICAgdGhpcy5yaWdodF9tb3JlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gbWluOyBpIDw9IG1heDsgaSsrKSB7XG4gICAgICAgICAgICB0aGlzLnBhZ2VzLnB1c2goaSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBnZXRLZXkoa2V5OnN0cmluZyk6c3RyaW5nIHtcbiAgICAgICAgbGV0IHVybCA9IHRoaXMucm91dGVyLnVybC5zcGxpdCgnOycpWzBdLnNwbGl0KCc/JylbMF07XG4gICAgICAgIHJldHVybiB1cmwrIFwiOlwiICsga2V5O1xuICAgIH1cbiAgICBwcml2YXRlIHB1dFRvU3RvcmFnZShrZXk6c3RyaW5nLCB2YWx1ZTphbnkpOnZvaWQge1xuICAgICAgICBpZiAodGhpcy5tYWpvclVpKSB7XG4gICAgICAgICAgICAvL29ubHkgbWFqb3IgVUkgd2Ugd2FudCB0byBjYWNoZSBhbmQgcmVjb3ZlciB3aGVuIHVzZXIgY29tZXMgYmFja1xuICAgICAgICAgICAgdGhpcy5jb21tb25TZXJ2aWNlLnB1dFRvU3RvcmFnZSh0aGlzLmdldEtleShrZXkpLCB2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0b3JhZ2Vba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgZ2V0RnJvbVN0b3JhZ2Uoa2V5OnN0cmluZyk6YW55IHtcbiAgICAgICAgaWYgKHRoaXMubWFqb3JVaSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tbW9uU2VydmljZS5nZXRGcm9tU3RvcmFnZSh0aGlzLmdldEtleShrZXkpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0b3JhZ2Vba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIHJvdXRlVG9QYWdlKHBhZ2U6bnVtYmVyKTp2b2lkIHtcbiAgICAgICAgdGhpcy5wdXRUb1N0b3JhZ2UoXCJwYWdlXCIsIHBhZ2UpO1xuICAgICAgICB0aGlzLnBvcHVsYXRlTGlzdCgpO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgb25OZXh0UGFnZSgpOnZvaWQge1xuICAgICAgICBpZiAodGhpcy5wYWdlID49IHRoaXMudG90YWxfcGFnZXMpIHJldHVybjtcbiAgICAgICAgdGhpcy5yb3V0ZVRvUGFnZSh0aGlzLnBhZ2UgKyAxKTtcbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIG9uUHJldmlvdXNQYWdlKCk6dm9pZCB7XG4gICAgICAgIGlmICh0aGlzLnBhZ2UgPD0gMSkgcmV0dXJuO1xuICAgICAgICB0aGlzLnJvdXRlVG9QYWdlKHRoaXMucGFnZSAtIDEpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBvbkdvdG9QYWdlKHA6bnVtYmVyKTp2b2lkIHtcbiAgICAgICAgaWYgKHAgPiB0aGlzLnRvdGFsX3BhZ2VzIHx8IHAgPCAxKSByZXR1cm47XG4gICAgICAgIHRoaXMucm91dGVUb1BhZ2UocClcbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIGdvQmFjaygpIHtcbiAgICAgICAgdGhpcy5sb2NhdGlvbi5iYWNrKCk7XG4gICAgICAgIC8qXG4gICAgICAgIC8vIHdpbmRvdy5oaXN0b3J5LmJhY2soKTtcbiAgICAgICAgaWYgKHRoaXMudmlldyAhPSBWaWV3VHlwZS5FRElUKVxuICAgICAgICAgICAgdGhpcy5sb2NhdGlvbi5iYWNrKCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGV0IHVybCA9IHRoaXMubG9jYXRpb24ucGF0aCgpOyAvL2luIEVESVQgdmlldywgdGhlIGN1cnJlbnQgdXJsIGlzIHNraXBwZWQuIFNvIGdldCB0aGUgXCJwcmV2aW91c1wiIG9uZSBmcm9tIHBhdGguXG4gICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZUJ5VXJsKHVybCk7XG4gICAgICAgIH1cbiAgICAgICAgKi9cbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIHN0cmluZ2lmeShkZXRhaWw6YW55KTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHN0ciA9IFwiXCI7XG4gICAgICAgIGZvciAobGV0IGZubSBvZiB0aGlzLmluZGV4RmllbGRzKSB7XG4gICAgICAgICAgICBpZiAoZGV0YWlsW2ZubV0gJiYgdHlwZW9mIGRldGFpbFtmbm1dICE9ICdvYmplY3QnKSBzdHIgKz0gXCIgXCIgKyBkZXRhaWxbZm5tXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN0cikgIHtcbiAgICAgICAgICAgIGZvciAobGV0IHByb3AgaW4gZGV0YWlsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3AgIT09ICdfaWQnICYmIGRldGFpbFtwcm9wXSAmJiB0eXBlb2YgZGV0YWlsW3Byb3BdICE9ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0ciArPSBcIiBcIiArIGRldGFpbFtwcm9wXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzdHIpIHN0ciA9IGRldGFpbFtcIl9pZFwiXT9kZXRhaWxbXCJfaWRcIl06XCIuLi5cIlxuICAgICAgICBzdHIgPSBzdHIucmVwbGFjZSgvXlxccyt8XFxzKyQvZywgJycpXG4gICAgICAgIGlmIChzdHIubGVuZ3RoID4gMzApIHN0ciA9IHN0ci5zdWJzdHIoMCwgMjcpICsgJy4uLic7XG4gICAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICBcbiAgICAvKioqU3RhcnQ6IGhhbmRsZSByZWZlcmVuY2UgZmllbGRzKioqL1xuICAgIHByb3RlY3RlZCBmb3JtYXRSZWZlcmVuY2VGaWVsZChmaWVsZDogYW55LCBmaWVsZE5hbWU6IHN0cmluZyApOmFueSB7XG4gICAgICAgIGxldCBpZCwgdmFsdWU7XG4gICAgICAgIGlmICh0eXBlb2YgZmllbGQgPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIC8vYXNzdW1lIHRoaXMgaXMgdGhlIFwiX2lkXCIsIGxldCBzZWUgd2UgaGF2ZSB0aGUgY2FjaGVkIGRldGFpbHMgZm9yIHRoaXMgcmVmIGZyb20gc2VydmljZVxuICAgICAgICAgICAgbGV0IHJlZkRldGFpbCA9IHRoaXMuY29tbW9uU2VydmljZS5nZXRGcm9tU3RvcmFnZShmaWVsZCk7XG4gICAgICAgICAgICBpZiAocmVmRGV0YWlsICYmICh0eXBlb2YgcmVmRGV0YWlsID09ICdvYmplY3QnKSkgZmllbGQgPSByZWZEZXRhaWw7XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZCA9IGZpZWxkO1xuICAgICAgICAgICAgICAgIGZpZWxkID0geydfaWQnOiBpZH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoZmllbGQgJiYgKHR5cGVvZiBmaWVsZCA9PSAnb2JqZWN0JykgKSB7XG4gICAgICAgICAgICBpZCA9IGZpZWxkWydfaWQnXTtcbiAgICAgICAgICAgIGxldCByZWZlckluZGV4ID0gJyc7XG4gICAgICAgICAgICBmb3IgKGxldCBrIGluICBmaWVsZCkge1xuICAgICAgICAgICAgICAgIGlmIChrICE9ICdfaWQnKSByZWZlckluZGV4ICs9IFwiIFwiICsgZmllbGRba107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWZlckluZGV4ID0gcmVmZXJJbmRleC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG4gICAgICAgICAgICBpZiAocmVmZXJJbmRleC5sZW5ndGggPj0gMjApIHJlZmVySW5kZXggPSByZWZlckluZGV4LnN1YnN0cmluZygwLCAyMCkgKyBcIi4uLlwiO1xuICAgICAgICAgICAgZmllbGQgPSB7J19pZCc6IGlkLCAndmFsdWUnOiByZWZlckluZGV4PyByZWZlckluZGV4OiBmaWVsZE5hbWV9O1xuICAgICAgICB9IGVsc2Ugey8vbm90IGRlZmluZWRcbiAgICAgICAgICAgIGZpZWxkID0geydfaWQnOiBpZCwgJ3ZhbHVlJzogdmFsdWV9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG4gICAgcHJvdGVjdGVkIGZvcm1hdFJlZmVyZW5jZShkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZm5tIG9mIHRoaXMucmVmZXJlbmNlRmllbGRzKSB7XG4gICAgICAgICAgICBkZXRhaWxbZm5tXSA9IHRoaXMuZm9ybWF0UmVmZXJlbmNlRmllbGQoZGV0YWlsW2ZubV0sIGZubSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9XG4gICAgcHJvdGVjdGVkIGRlRm9ybWF0UmVmZXJlbmNlKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBmbm0gb2YgdGhpcy5yZWZlcmVuY2VGaWVsZHMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGV0YWlsW2ZubV0gIT09ICdvYmplY3QnKSB7IC8vbm90IGRlZmluZWRcbiAgICAgICAgICAgICAgICAvL2xldCBkYXRlIHZhbHVlcyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBpZCA9IGRldGFpbFtmbm1dWydfaWQnXTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGlkICE9PSAnc3RyaW5nJykgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgICAgIGVsc2UgZGV0YWlsW2ZubV0gPSBpZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgY2xlYXJGaWVsZFJlZmVyZW5jZShmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBmb3IgKGxldCBwcm9wIGluIGZpZWxkKSB7XG4gICAgICAgICAgICBmaWVsZFtwcm9wXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGlzRGVmaW5lZEZpZWxkUmVmZXJlbmNlKGZpZWxkOmFueSApOmFueSB7XG4gICAgICAgIGlmICgnX2lkJyBpbiBmaWVsZCAmJiB0eXBlb2YgZmllbGRbJ19pZCddID09ICdzdHJpbmcnKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvKioqU3RhcnQ6IGhhbmRsZSBkYXRlIGZpZWxkcyoqKi8gICAgXG4gICAgcHJvdGVjdGVkIGZvcm1hdERhdGVGaWVsZChmaWVsZDpzdHJpbmcpOmFueSB7XG4gICAgICAgIGxldCBmbXQgPSB0aGlzLmRhdGVGb3JtYXQ7XG4gICAgICAgIGxldCB0X2ZtdCA9IHRoaXMudGltZUZvcm1hdDtcbiAgICAgICAgbGV0IGQsIE0sIHl5eXksIGgsIG0sIHM7XG5cbiAgICAgICAgbGV0IGR0ID0gbmV3IERhdGUoZmllbGQpO1xuICAgICAgICBcbiAgICAgICAgbGV0IGRkLCBNTSwgaGgsIG1tLCBzcztcbiAgICAgICAgZCA9IGR0LmdldERhdGUoKTtcbiAgICAgICAgTSA9IGR0LmdldE1vbnRoKCkrMTsgXG4gICAgICAgIHl5eXkgPSBkdC5nZXRGdWxsWWVhcigpO1xuICAgICAgICBcbiAgICAgICAgbGV0IHl5ID0geXl5eS50b1N0cmluZygpLnNsaWNlKDIpO1xuICAgICAgICBoID0gZHQuZ2V0SG91cnMoKTtcbiAgICAgICAgbSA9IGR0LmdldE1pbnV0ZXMoKTtcbiAgICAgICAgcyA9IGR0LmdldFNlY29uZHMoKTtcbiAgICAgICAgXG4gICAgICAgIGRkPSBkPDEwPyAnMCcrZDogZC50b1N0cmluZygpO1xuICAgICAgICBNTT0gTTwxMD8gJzAnK006IE0udG9TdHJpbmcoKTtcbiAgICAgICAgaGg9IGg8MTA/ICcwJytoOiBoLnRvU3RyaW5nKCk7XG4gICAgICAgIG1tPSBtPDEwPyAnMCcrbTogbS50b1N0cmluZygpO1xuICAgICAgICBzcz0gczwxMD8gJzAnK3M6IHMudG9TdHJpbmcoKTtcbiAgICAgICAgXG4gICAgICAgIGxldCB2YWx1ZSA9IGZtdC5yZXBsYWNlKC95eXl5L2lnLCB5eXl5LnRvU3RyaW5nKCkpLlxuICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlKC95eS9pZywgeXkudG9TdHJpbmcoKSkuXG4gICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoL01NL2csIE1NLnRvU3RyaW5nKCkpLlxuICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlKC9kZC9pZywgZGQudG9TdHJpbmcoKSk7XG4gICAgICBcbiAgICAgICAgbGV0IHRfdmFsdWUgPSB0X2ZtdC5yZXBsYWNlKC9oaC9pZywgaGgudG9TdHJpbmcoKSkuXG4gICAgICAgICAgICAgICAgICAgICAgIHJlcGxhY2UoL21tL2csIG1tLnRvU3RyaW5nKCkpLlxuICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlKC9zcy9pZywgc3MudG9TdHJpbmcoKSk7XG4gICAgICAgIC8qRGF0ZXBpY2tlciB1c2VzIE5nYkRhdGVTdHJ1Y3QgYXMgYSBtb2RlbCBhbmQgbm90IHRoZSBuYXRpdmUgRGF0ZSBvYmplY3QuIFxuICAgICAgICBJdCdzIGEgc2ltcGxlIGRhdGEgc3RydWN0dXJlIHdpdGggMyBmaWVsZHMuIEFsc28gbm90ZSB0aGF0IG1vbnRocyBzdGFydCB3aXRoIDEgKGFzIGluIElTTyA4NjAxKS5cbiAgICAgICAgXG4gICAgICAgIHdlIGFkZCBoLCBtLCBzIGhlcmVcbiAgICAgICAgKi9cbiAgICAgICAgLy9cImZyb21cIiBhbmQgXCJ0b1wiIHVzZWQgZm9yIHNlYXJjaCBjb250ZXh0LiBwb3A6IHNob3cgdGhlIHNlbGVjdGlvbiBwb3B1cFxuICAgICAgICByZXR1cm4geydkYXRlJzp7IGRheTogZCwgbW9udGg6IE0sIHllYXI6IHl5eXl9LCAndmFsdWUnOiB2YWx1ZSwgJ2Zyb20nOiB1bmRlZmluZWQsICd0byc6IHVuZGVmaW5lZCwgJ3BvcCc6ZmFsc2UsXG4gICAgICAgICAgICAgICAgJ3RpbWUnOnsgaG91cjogaCwgbWludXRlOiBtLCBzZWNvbmQ6IHN9LCAndF92YWx1ZSc6IHZhbHVlLCAndF9mcm9tJzogdW5kZWZpbmVkLCAndF90byc6IHVuZGVmaW5lZCwgJ3RfcG9wJzpmYWxzZX1cblxuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgZm9ybWF0RGF0ZShkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZm5tIG9mIHRoaXMuZGF0ZUZpZWxkcykge1xuICAgICAgICAgICAgbGV0IHZhbHVlLCBkYXRlO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXRhaWxbZm5tXSAhPT0gJ3N0cmluZycpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgICAgIC8vaW1wb3J0YW50OiBsZXQgZGF0ZSB2YWx1ZXMgdW5kZWZpbmVkLiBcImZyb21cIiBhbmQgXCJ0b1wiIHVzZWQgZm9yIHNlYXJjaCBjb250ZXh0LiBwb3A6IHNob3cgdGhlIHNlbGVjdGlvbiBwb3B1cFxuICAgICAgICAgICAgICAgIGRldGFpbFtmbm1dID0geydkYXRlJzp1bmRlZmluZWQsICd2YWx1ZSc6IHVuZGVmaW5lZCwgJ2Zyb20nOiB1bmRlZmluZWQsICd0byc6IHVuZGVmaW5lZCwgJ3BvcCc6ZmFsc2V9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZGV0YWlsW2ZubV0gPSB0aGlzLmZvcm1hdERhdGVGaWVsZChkZXRhaWxbZm5tXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIGRlRm9ybWF0RGF0ZUZpZWxkKGRhdGU6YW55KTpzdHJpbmcge1xuICAgICAgICBsZXQgZCwgTSwgeXl5eSwgaCwgbSwgcztcbiAgICAgICAgXG4gICAgICAgIHl5eXkgPSBkYXRlLnllYXI7XG4gICAgICAgIE0gPSBkYXRlLm1vbnRoIC0gMTtcbiAgICAgICAgZCA9IGRhdGUuZGF5O1xuICAgICAgICBcbiAgICAgICAgaWYgKHR5cGVvZiB5eXl5ICE9PSAnbnVtYmVyJyB8fCB0eXBlb2YgTSAhPT0gJ251bWJlcicgfHwgdHlwZW9mIGQgIT09ICdudW1iZXInKSByZXR1cm4gbnVsbDtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZXQgZHQgPSBuZXcgRGF0ZSh5eXl5LCBNLCBkLCAwLCAwLCAwLCAwKTtcbiAgICAgICAgICAgIHJldHVybiBkdC50b0lTT1N0cmluZygpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBkZUZvcm1hdERhdGUoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IGZubSBvZiB0aGlzLmRhdGVGaWVsZHMpIHtcbiAgICAgICAgICAgIGxldCB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGV0YWlsW2ZubV0gIT09ICdvYmplY3QnKSB7IC8vbm90IGRlZmluZWRcbiAgICAgICAgICAgICAgICAvL2xldCBkYXRlIHZhbHVlcyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoISBkZXRhaWxbZm5tXS5kYXRlKSBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRlU3RyID0gdGhpcy5kZUZvcm1hdERhdGVGaWVsZChkZXRhaWxbZm5tXS5kYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkYXRlU3RyKSBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgZGV0YWlsW2ZubV0gPSBkYXRlU3RyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgY2xlYXJGaWVsZERhdGUoZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgcHJvcCBpbiBmaWVsZCkge1xuICAgICAgICAgICAgZmllbGRbcHJvcF0gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgaXNEZWZpbmVkRmllbGREYXRlKGZpZWxkOmFueSApOmFueSB7XG4gICAgICAgIGlmICh0eXBlb2YgZmllbGQgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmaWVsZFsnZGF0ZSddID09ICdvYmplY3QnKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGZpZWxkWydmcm9tJ10gPT0gJ29iamVjdCcpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZmllbGRbJ3RvJ10gPT0gJ29iamVjdCcpIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKioqU3RhcnQ6IGhhbmRsZSBhcnJheSBvZiBtdWx0aS1zZWxlY3Rpb24gZmllbGRzKioqL1xuICAgIHByb3RlY3RlZCBmb3JtYXRBcnJheU11bHRpU2VsZWN0aW9uRmllbGQoZmllbGQ6IGFueSwgZW51bXM6IGFueSk6IGFueSB7XG4gICAgICAgIGxldCBzZWxlY3RPYmogPSB7fTtcbiAgICAgICAgbGV0IHZhbHVlID0gXCJcIjtcbiAgICAgICAgZm9yIChsZXQgZSBvZiBlbnVtcykge1xuICAgICAgICAgICAgc2VsZWN0T2JqW2VdID0gZmFsc2U7IC8vbm90IGV4aXN0XG4gICAgICAgIH1cbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZmllbGQpKSB7IC8vbm90IGRlZmluZWRcbiAgICAgICAgICAgIGZvciAobGV0IGUgb2YgZmllbGQpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RPYmpbZV0gPSB0cnVlOyAgLy9leGlzdC5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbHVlID0gZmllbGQuam9pbihcIiB8IFwiKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7J3NlbGVjdGlvbic6IHNlbGVjdE9iaiwgdmFsdWU6IHZhbHVlfTtcblxuICAgIH1cbiAgICBwcm90ZWN0ZWQgZm9ybWF0QXJyYXlNdWx0aVNlbGVjdGlvbihkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZm5tIG9mIHRoaXMubXVsdGlTZWxlY3Rpb25GaWVsZHMpIHtcbiAgICAgICAgICAgIGRldGFpbFtmbm1dID0gdGhpcy5mb3JtYXRBcnJheU11bHRpU2VsZWN0aW9uRmllbGQoZGV0YWlsW2ZubV0sIHRoaXMuZW51bXNbZm5tXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIGRlRm9ybWF0QXJyYXlNdWx0aVNlbGVjdGlvbihkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgZm9yIChsZXQgZm5tIG9mIHRoaXMubXVsdGlTZWxlY3Rpb25GaWVsZHMpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGV0YWlsW2ZubV0gIT09ICdvYmplY3QnKSB7IC8vbm90IGRlZmluZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoISBkZXRhaWxbZm5tXS5zZWxlY3Rpb24pIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGUgb2YgdGhpcy5lbnVtc1tmbm1dKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGV0YWlsW2ZubV0uc2VsZWN0aW9uW2VdKSBzZWxlY3RBcnJheS5wdXNoKGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdEFycmF5Lmxlbmd0aCA+IDApIGRldGFpbFtmbm1dID0gc2VsZWN0QXJyYXk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgY2xlYXJGaWVsZEFycmF5TXVsdGlTZWxlY3Rpb24oZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKCFmaWVsZFsnc2VsZWN0aW9uJ10pIHJldHVybiBmaWVsZDtcbiAgICAgICAgZm9yIChsZXQgcHJvcCBpbiBmaWVsZFsnc2VsZWN0aW9uJ10pIHtcbiAgICAgICAgICAgIGZpZWxkWydzZWxlY3Rpb24nXVtwcm9wXSA9IGZhbHNlOyAvL25vdCBleGlzdFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaXNEZWZpbmVkRmllbGRBcnJheU11bHRpU2VsZWN0aW9uKGZpZWxkOmFueSApOmFueSB7XG4gICAgICAgIGlmICgnc2VsZWN0aW9uJyBpbiBmaWVsZCAmJiB0eXBlb2YgZmllbGRbJ3NlbGVjdGlvbiddID09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBsZXQga2V5cyA9IE9iamVjdC5rZXlzKGZpZWxkWydzZWxlY3Rpb24nXSk7XG4gICAgICAgICAgICByZXR1cm4ga2V5cy5zb21lKGU9PntyZXR1cm4gZmllbGRbJ3NlbGVjdGlvbiddW2VdfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgbXVsdGlzZWxlY3Rpb25TZWxlY3RlZChmaWVsZE5hbWUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRldGFpbFtmaWVsZE5hbWVdIHx8IHR5cGVvZiB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWydzZWxlY3Rpb24nXSAhPSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLmlzRGVmaW5lZEZpZWxkQXJyYXlNdWx0aVNlbGVjdGlvbih0aGlzLmRldGFpbFtmaWVsZE5hbWVdKTtcbiAgICB9XG4gICAgLyoqKkVuZDogaGFuZGxlIGFycmF5IG9mIG11bHRpLXNlbGVjdGlvbiBmaWVsZHMqKiovXG4gICAgLyoqKlN0YXJ0OiBoYW5kbGUgbWFwIGZpZWxkcyoqKi9cbiAgICBwcm90ZWN0ZWQgZm9ybWF0TWFwRmllbGQoZmllbGQ6IGFueSwgZWxlbWVudFR5cGU6IHN0cmluZyk6IGFueSB7XG4gICAgICAgIGxldCBzZWxlY3RPYmogPSB7fTtcbiAgICAgICAgbGV0IHZhbHVlcyA9IFtdO1xuICAgICAgICBpZiAodHlwZW9mIGZpZWxkID09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBzZWxlY3RPYmogPSBmaWVsZDtcbiAgICAgICAgICAgIGZvciAobGV0IGUgaW4gZmllbGQpIHtcbiAgICAgICAgICAgICAgaWYgKGVsZW1lbnRUeXBlID09PSAnU2NoZW1hU3RyaW5nJykge1xuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGUgKyBcIihcIiArIGZpZWxkW2VdICsgXCIpXCIpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWVzID0gdmFsdWVzLmZpbHRlcih4PT4hIXgpO1xuICAgICAgICBsZXQgdmFsdWUgPSB2YWx1ZXMuam9pbihcIiB8IFwiKVxuICAgICAgICByZXR1cm4geydzZWxlY3Rpb24nOiBzZWxlY3RPYmosIHZhbHVlOiB2YWx1ZSwga2V5czogW119O1xuXG4gICAgfVxuICAgIHByb3RlY3RlZCBmb3JtYXRNYXBGaWVsZHMoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IGYgb2YgdGhpcy5tYXBGaWVsZHMpIHtcbiAgICAgICAgICAgIC8vW2ZpZWxkTmFtZSwgZWxlbWVudFR5cGVdXG4gICAgICAgICAgICBkZXRhaWxbZlswXV0gPSB0aGlzLmZvcm1hdE1hcEZpZWxkKGRldGFpbFtmWzBdXSwgZlsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgZGVGb3JtYXRNYXBGaWVsZHMoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IGYgb2YgdGhpcy5tYXBGaWVsZHMpIHtcbiAgICAgICAgICAgIC8vW2ZpZWxkTmFtZSwgZWxlbWVudFR5cGVdXG4gICAgICAgICAgICBsZXQgZm5tID0gZlswXTtcbiAgICAgICAgICAgIGxldCBlbGVtZW50VHlwZSA9IGZbMV07XG4gICAgICAgICAgXG4gICAgICAgICAgICBpZiAodHlwZW9mIGRldGFpbFtmbm1dICE9PSAnb2JqZWN0JykgeyAvL25vdCBkZWZpbmVkXG4gICAgICAgICAgICAgICAgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKCEgZGV0YWlsW2ZubV0uc2VsZWN0aW9uKSBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RNYXAgPSBkZXRhaWxbZm5tXS5zZWxlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGUgaW4gZGV0YWlsW2ZubV0uc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRUeXBlID09PSAnU2NoZW1hU3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhzZWxlY3RNYXApLmxlbmd0aCA+IDApIGRldGFpbFtmbm1dID0gc2VsZWN0TWFwO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY2xlYXJGaWVsZE1hcChmaWVsZDphbnkgKTphbnkge1xuICAgICAgICBpZiAoIWZpZWxkWydzZWxlY3Rpb24nXSkgcmV0dXJuIGZpZWxkO1xuICAgICAgICBmaWVsZFsnc2VsZWN0aW9uJ10gPSB7fTtcbiAgICAgICAgZmllbGQudmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiBmaWVsZDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgaXNEZWZpbmVkRmllbGRNYXAoZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKCdzZWxlY3Rpb24nIGluIGZpZWxkICYmIHR5cGVvZiBmaWVsZFsnc2VsZWN0aW9uJ10gPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhmaWVsZFsnc2VsZWN0aW9uJ10pLmxlbmd0aCA+IDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgbWFwU2VsZWN0ZWQoZmllbGROYW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5kZXRhaWxbZmllbGROYW1lXSB8fCB0eXBlb2YgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsnc2VsZWN0aW9uJ10gIT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZE1hcCh0aGlzLmRldGFpbFtmaWVsZE5hbWVdKTtcbiAgICB9XG4gICAgLyoqKkVuZDogaGFuZGxlIG1hcCBmaWVsZHMqKiovXG4gICAgLyoqKlN0YXJ0OiBoYW5kbGUgYXJyYXkgZmllbGRzKioqL1xuICAgIHByb3RlY3RlZCBmb3JtYXRBcnJheUZpZWxkKGZpZWxkOiBhbnksIGVsZW1lbnRUeXBlOiBzdHJpbmcpOiBhbnkge1xuICAgICAgICBsZXQgc2VsZWN0QXJyYXkgPSBbXTtcbiAgICAgICAgbGV0IHZhbHVlcyA9IFtdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShmaWVsZCkpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgZm9yIChsZXQgZSBvZiBmaWVsZCkge1xuICAgICAgICAgICAgICBpZiAoZWxlbWVudFR5cGUgPT09ICdPYmplY3RJZCcpIHtcbiAgICAgICAgICAgICAgICBsZXQgcmVmID0gdGhpcy5mb3JtYXRSZWZlcmVuY2VGaWVsZChlLCBcIi4uLlwiKTtcbiAgICAgICAgICAgICAgICBzZWxlY3RBcnJheS5wdXNoKHJlZik7XG4gICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gocmVmLnZhbHVlKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50VHlwZSA9PT0gJ1NjaGVtYVN0cmluZycpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RBcnJheS5wdXNoKGUpO1xuICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFsdWVzID0gdmFsdWVzLmZpbHRlcih4PT4hIXgpO1xuICAgICAgICBsZXQgdmFsdWUgPSB2YWx1ZXMuam9pbihcIiB8IFwiKVxuICAgICAgICByZXR1cm4geydzZWxlY3Rpb24nOiBzZWxlY3RBcnJheSwgdmFsdWU6IHZhbHVlfTtcblxuICAgIH1cbiAgICBwcm90ZWN0ZWQgZm9ybWF0QXJyYXlGaWVsZHMoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IGYgb2YgdGhpcy5hcnJheUZpZWxkcykge1xuICAgICAgICAgICAgLy9bZmllbGROYW1lLCBlbGVtZW50VHlwZV1cbiAgICAgICAgICAgIGRldGFpbFtmWzBdXSA9IHRoaXMuZm9ybWF0QXJyYXlGaWVsZChkZXRhaWxbZlswXV0sIGZbMV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXRhaWw7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGRlRm9ybWF0QXJyYXlGaWVsZHMoZGV0YWlsOmFueSApOmFueSB7XG4gICAgICAgIGZvciAobGV0IGYgb2YgdGhpcy5hcnJheUZpZWxkcykge1xuICAgICAgICAgICAgLy9bZmllbGROYW1lLCBlbGVtZW50VHlwZV1cbiAgICAgICAgICAgIGxldCBmbm0gPSBmWzBdO1xuICAgICAgICAgICAgbGV0IGVsZW1lbnRUeXBlID0gZlsxXTtcbiAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGV0YWlsW2ZubV0gIT09ICdvYmplY3QnKSB7IC8vbm90IGRlZmluZWRcbiAgICAgICAgICAgICAgICBkZWxldGUgZGV0YWlsW2ZubV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoISBkZXRhaWxbZm5tXS5zZWxlY3Rpb24pIGRlbGV0ZSBkZXRhaWxbZm5tXTtcbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdEFycmF5ID0gW107XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGUgb2YgZGV0YWlsW2ZubV0uc2VsZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnRUeXBlID09PSAnT2JqZWN0SWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSAmJiBlWydfaWQnXSAmJiB0eXBlb2YgZVsnX2lkJ10gPT09ICdzdHJpbmcnKSBzZWxlY3RBcnJheS5wdXNoKGVbJ19pZCddKTtcbiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnRUeXBlID09PSAnU2NoZW1hU3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHNlbGVjdEFycmF5LnB1c2goZSk7XG4gICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdEFycmF5Lmxlbmd0aCA+IDApIGRldGFpbFtmbm1dID0gc2VsZWN0QXJyYXk7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgZGVsZXRlIGRldGFpbFtmbm1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlsO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBjbGVhckZpZWxkQXJyYXkoZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKCFmaWVsZFsnc2VsZWN0aW9uJ10pIHJldHVybiBmaWVsZDtcbiAgICAgICAgZmllbGRbJ3NlbGVjdGlvbiddID0gW107XG4gICAgICAgIGZpZWxkLnZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gZmllbGQ7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGlzRGVmaW5lZEZpZWxkQXJyYXkoZmllbGQ6YW55ICk6YW55IHtcbiAgICAgICAgaWYgKCdzZWxlY3Rpb24nIGluIGZpZWxkICYmIEFycmF5LmlzQXJyYXkoZmllbGRbJ3NlbGVjdGlvbiddKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZpZWxkWydzZWxlY3Rpb24nXS5sZW5ndGggPiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcHJvdGVjdGVkIGFycmF5U2VsZWN0ZWQoZmllbGROYW1lKSB7XG4gICAgICAgIGlmICghdGhpcy5kZXRhaWxbZmllbGROYW1lXSB8fCAhQXJyYXkuaXNBcnJheSh0aGlzLmRldGFpbFtmaWVsZE5hbWVdWydzZWxlY3Rpb24nXSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZEFycmF5KHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV0pO1xuICAgIH1cbiAgICAvKioqRW5kOiBoYW5kbGUgYXJyYXkgZmllbGRzKioqL1xuICBcbiAgICBwcm90ZWN0ZWQgZm9ybWF0RGV0YWlsKGRldGFpbDphbnkgKTphbnkge1xuICAgICAgICBkZXRhaWwgPSB0aGlzLmZvcm1hdFJlZmVyZW5jZShkZXRhaWwpO1xuICAgICAgICBkZXRhaWwgPSB0aGlzLmZvcm1hdERhdGUoZGV0YWlsKTtcbiAgICAgICAgZGV0YWlsID0gdGhpcy5mb3JtYXRBcnJheU11bHRpU2VsZWN0aW9uKGRldGFpbCk7XG4gICAgICAgIGRldGFpbCA9IHRoaXMuZm9ybWF0QXJyYXlGaWVsZHMoZGV0YWlsKTtcbiAgICAgICAgZGV0YWlsID0gdGhpcy5mb3JtYXRNYXBGaWVsZHMoZGV0YWlsKTtcbiAgICAgICAgcmV0dXJuIGRldGFpbDtcbiAgICB9ICAgIFxuICAgIFxuICAgIHByb3RlY3RlZCBkZUZvcm1hdERldGFpbChkZXRhaWw6YW55ICk6YW55IHtcbiAgICAgICAgbGV0IGNweSA9IFV0aWwuY2xvbmUoZGV0YWlsKTtcbiAgICAgICAgXG4gICAgICAgIGNweSA9IHRoaXMuZGVGb3JtYXRSZWZlcmVuY2UoY3B5KTtcbiAgICAgICAgY3B5ID0gdGhpcy5kZUZvcm1hdERhdGUoY3B5KTtcbiAgICAgICAgY3B5ID0gdGhpcy5kZUZvcm1hdEFycmF5TXVsdGlTZWxlY3Rpb24oY3B5KTtcbiAgICAgICAgY3B5ID0gdGhpcy5kZUZvcm1hdEFycmF5RmllbGRzKGNweSk7XG4gICAgICAgIGNweSA9IHRoaXMuZGVGb3JtYXRNYXBGaWVsZHMoY3B5KTtcbiAgICAgICAgcmV0dXJuIGNweTtcbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIHBvcHVsYXRlRGV0YWlsKGlkOiBzdHJpbmcpOkV2ZW50RW1pdHRlcjxhbnk+IHtcbiAgICAgIHJldHVybiB0aGlzLnBvcHVsYXRlRGV0YWlsRm9yQWN0aW9uKGlkLCBudWxsKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgcG9wdWxhdGVEZXRhaWxGb3JBY3Rpb24oaWQ6IHN0cmluZywgYWN0aW9uOiBzdHJpbmcpOkV2ZW50RW1pdHRlcjxhbnk+IHtcbiAgICAgIC8vYWN0aW9uOiBlZzogYWN0aW9uPWVkaXQgIC0+IGdldCBkZXRhaWwgZm9yIGVkaXRpbmcgcHVycG9zZSBcbiAgICAgIHRoaXMuc2VydmljZS5nZXREZXRhaWxGb3JBY3Rpb24oaWQsIGFjdGlvbikuc3Vic2NyaWJlKFxuICAgICAgICBkZXRhaWwgPT4ge1xuICAgICAgICAgICAgbGV0IG9yaWdpbmFsRGV0YWlsID0gVXRpbC5jbG9uZShkZXRhaWwpO1xuICAgICAgICAgICAgaWYgKGRldGFpbFtcIl9pZFwiXSkgdGhpcy5jb21tb25TZXJ2aWNlLnB1dFRvU3RvcmFnZShkZXRhaWxbXCJfaWRcIl0sIG9yaWdpbmFsRGV0YWlsKTsvL2NhY2hlIGl0XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsID0gdGhpcy5mb3JtYXREZXRhaWwoZGV0YWlsKTtcbiAgICAgICAgICAgIHRoaXMuZXh0cmFGaWVsZHNVbmxvYWQoKTsvL3VubG9hZCBkYXRhIHRvIHRleHQgZWRpdG9ycywgZXRjXG4gICAgICAgICAgICBpZiAoYWN0aW9uID09ICdlZGl0Jykge1xuICAgICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7Ly9jb2xsZWN0IG90aGVyIGluZm8gcmVxdWlyZWQgZm9yIGVkaXQgdmlld1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMucmVmcmVzaGluZykge1xuICAgICAgICAgICAgICB0aGlzLnJlZnJlc2hpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgbGV0IHNuYWNrQmFyQ29uZmlnOiBTbmFja0JhckNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IFwiRGV0YWlsIHJlZnJlc2hlZFwiXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgbGV0IHNuYWNrQmFyID0gbmV3IFNuYWNrQmFyKHNuYWNrQmFyQ29uZmlnKTtcbiAgICAgICAgICAgICAgc25hY2tCYXIuc2hvdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5ldmVudEVtaXR0ZXIuZW1pdCh0aGlzLmRldGFpbCk7XG4gICAgICAgIH0sXG4gICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICk7XG4gICAgICByZXR1cm4gdGhpcy5ldmVudEVtaXR0ZXI7XG4gICAgfVxuICAgIFxuXG4gICAgcHJvdGVjdGVkIHBvcHVsYXRlRGV0YWlsRnJvbUNvcHkoY29weV9pZDpzdHJpbmcpOnZvaWQge1xuICAgICAgdGhpcy5zZXJ2aWNlLmdldERldGFpbChjb3B5X2lkKS5zdWJzY3JpYmUoXG4gICAgICAgIGRldGFpbCA9PiB7ICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLmRldGFpbCA9IHRoaXMuZm9ybWF0RGV0YWlsKGRldGFpbCk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5kZXRhaWxbXCJfaWRcIl07XG4gICAgICAgICAgICB0aGlzLmV4dHJhRmllbGRzVW5sb2FkKCk7Ly91bmxvYWQgZGF0YSB0byB0ZXh0IGVkaXRvcnMsIGV0Y1xuICAgICAgICAgICAgdGhpcy5leHRyYUluZm9Qb3B1bGF0ZSgpOy8vY29sbGVjdCBvdGhlciBpbmZvIHJlcXVpcmVkIGZvciBjcmVhdGUgdmlld1xuICAgICAgICB9LFxuICAgICAgICB0aGlzLm9uU2VydmljZUVycm9yXG4gICAgICApO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBleHRyYUluZm9Qb3B1bGF0ZSgpIHtcbiAgICAgICAgZm9yIChsZXQgZmllbGREZWYgb2YgdGhpcy5tYXBGaWVsZHMpIHsgXG4gICAgICAgICAgLy9maWVsZERlZjogW2ZpZWxkLmZpZWxkTmFtZSwgZmllbGQuZWxlbWVudFR5cGUsIGtleVR5cGUsIGtleVJlZk5hbWUsIGtleVJlZlNlcnZpY2UsIGtleVJlZlN1YkZpZWxkXVxuICAgICAgICAgIGxldCBmaWVsZE5hbWUgPSBmaWVsZERlZlswXTsgLy90aGlzLjxrZXlSZWZOYW1lPi48a2V5UmVmU3ViRmllbGQ+XG4gICAgICAgICAgbGV0IG1hcEtleVR5cGUgPSBmaWVsZERlZlsyXTsgLy90aGlzLjxrZXlSZWZOYW1lPi48a2V5UmVmU3ViRmllbGQ+XG4gICAgICAgICAgbGV0IGtleUFycmF5ID0gW107XG4gICAgICAgICAgaWYgKG1hcEtleVR5cGUgPT0gXCJPYmplY3RJZFwiKSB7XG4gICAgICAgICAgICBsZXQga2V5UmVmTmFtZSA9IGZpZWxkRGVmWzNdO1xuICAgICAgICAgICAgbGV0IHJlY29yZEtleSA9ICdrZXktaWQtJyArIGtleVJlZk5hbWU7XG4gICAgICAgICAgICBsZXQgcmVmU2VydmljZSA9IHRoaXMuaW5qZWN0b3IuZ2V0KGZpZWxkRGVmWzRdKTtcbiAgICAgICAgICAgIGxldCBpZCA9IHRoaXMuZGV0YWlsW2tleVJlZk5hbWVdP3RoaXMuZGV0YWlsW2tleVJlZk5hbWVdWydfaWQnXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGlmICghaWQpIGNvbnRpbnVlO1xuICAgICAgICAgICAgbGV0IG1hcEZpZWxkID0gdGhpcy5kZXRhaWxbZmllbGROYW1lXTtcbiAgICAgICAgICAgIGlmIChtYXBGaWVsZFtyZWNvcmRLZXldID09IGlkKSBjb250aW51ZTsgLy9hbHJlYWR5IHBvcHVsYXRlZCBmb3IgdGhlIHNhbWUgaWRcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVmU2VydmljZS5nZXREZXRhaWwoaWQpLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgZGV0YWlsID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShkZXRhaWxbZmllbGREZWZbNV1dKSkge1xuICAgICAgICAgICAgICAgICAga2V5QXJyYXkgPSBkZXRhaWxbZmllbGREZWZbNV1dO1xuICAgICAgICAgICAgICAgICAgbWFwRmllbGRbJ2tleXMnXSA9IGtleUFycmF5O1xuICAgICAgICAgICAgICAgICAgbWFwRmllbGRbcmVjb3JkS2V5XSA9IGlkOyAvL3JlY29yZCB0aGF0IGtleXMgaXMgcG9wdWxhdGVkIGZyb20gdGhpcyBvYmplY3RcbiAgICAgICAgICAgICAgICAgIGlmIChtYXBGaWVsZFsnc2VsZWN0aW9uJ10pIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgayBvZiBrZXlBcnJheSkge1xuICAgICAgICAgICAgICAgICAgICAgIGlmICghKGsgaW4gbWFwRmllbGRbJ3NlbGVjdGlvbiddKSkgbWFwRmllbGRbJ3NlbGVjdGlvbiddW2tdID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgdGhpcy5vblNlcnZpY2VFcnJvclxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9ICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfVxuICBcbiAgICBwcml2YXRlIGVxdWFsVHdvU2VhcmNoQ29udGV4dEFycmF5cyAoYXJyMSwgYXJyMikge1xuICAgICAgaWYgKCFhcnIxKSBhcnIxID0gW107XG4gICAgICBpZiAoIWFycjIpIGFycjIgPSBbXTtcbiAgICAgIGlmIChhcnIxLmxlbmd0aCA9PSAwICYmIGFycjIubGVuZ3RoID09IDApIHJldHVybiB0cnVlO1xuICAgICAgLy9hbGwgb2JqZWN0IGluIGFycmF5IGhhcyBmb3JtYXQgb2YgeydmaWVsZCc6ICd2YWx1ZSd9IGZvcm1hdFxuICAgICAgZnVuY3Rpb24gY29tcGFyZU9iaihhLCBiKSB7XG4gICAgICAgICAgbGV0IGFfcyA9IEpTT04uc3RyaW5naWZ5KGEpLCBiX3MgPSBKU09OLnN0cmluZ2lmeShiKVxuICAgICAgICAgIGlmIChhX3MgPCBiX3MpXG4gICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICBpZiAoYV9zID4gYl9zKVxuICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICAgIGFycjEgPSBhcnIxLnNvcnQoY29tcGFyZU9iaik7XG4gICAgICBhcnIyID0gYXJyMi5zb3J0KGNvbXBhcmVPYmopO1xuICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KGFycjEpID09IEpTT04uc3RyaW5naWZ5KGFycjIpKSByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgcHJvY2Vzc1NlYXJjaENvbnRleHQoKSB7XG4gICAgICAgIHRoaXMubW9yZVNlYXJjaE9wZW5lZCA9IGZhbHNlO1xuICAgICAgICBsZXQgZCA9IHRoaXMuZGV0YWlsO1xuICAgICAgICBmb3IgKGxldCBzIG9mIHRoaXMuc3RyaW5nRmllbGRzKSB7XG4gICAgICAgICAgICBkW3NdID0gdGhpcy5zZWFyY2hUZXh0O1xuICAgICAgICB9XG4gICAgICAgIGxldCBvclNlYXJjaENvbnRleHQgPSBbXSwgYW5kU2VhcmNoQ29udGV4dCA9IFtdO1xuICAgICAgICBmb3IgKGxldCBmaWVsZCBpbiBkKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRbZmllbGRdID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgbGV0IG8gPSB7fVxuICAgICAgICAgICAgICAgIG9bZmllbGRdID0gZFtmaWVsZF07XG4gICAgICAgICAgICAgICAgb3JTZWFyY2hDb250ZXh0LnB1c2gobyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMuc2VhcmNoTW9yZURldGFpbCA9IFtdXG4gICAgICAgIGxldCBkMiA9IHRoaXMuZGVGb3JtYXREZXRhaWwoZCk7Ly91bmRlZmluZWQgZmllbGQgaXMgZGVsZXRlZCBhZnRlciB0aGlzIHN0ZXBcbiAgICAgICAgZm9yIChsZXQgZmllbGQgaW4gZDIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0cmluZ0ZpZWxkcy5pbmRleE9mKGZpZWxkKSA9PSAtMSkgey8vc3RyaW5nIGZpZWxkcyBhbHJlYWR5IHB1dCB0byBvclNlYXJjaENvbnRleHRcbiAgICAgICAgICAgICAgICBsZXQgbyA9IHt9XG4gICAgICAgICAgICAgICAgbGV0IHZhbHVlVG9TaG93O1xuXG4gICAgICAgICAgICAgICAgb1tmaWVsZF0gPSBkMltmaWVsZF07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5tdWx0aVNlbGVjdGlvbkZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgb1tmaWVsZF0gPSB7JGluOiBkMltmaWVsZF19OyAvL3VzZSAkaW4gZm9yIG9yLCBhbmQgJGFsbCBmb3IgYW5kXG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IHQgPSB0aGlzLmZvcm1hdEFycmF5TXVsdGlTZWxlY3Rpb25GaWVsZChkMltmaWVsZF0sIHRoaXMuZW51bXNbZmllbGRdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVUb1Nob3cgPSB0LnZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcnJheUZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGQpKSB7ICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIG9bZmllbGRdID0geyRpbjogZDJbZmllbGRdfTsgLy91c2UgJGluIGZvciBvciwgYW5kICRhbGwgZm9yIGFuZFxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlVG9TaG93ID0gZFtmaWVsZF1bJ3ZhbHVlJ107XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmRhdGVGaWVsZHMuaW5jbHVkZXMoZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0ID0gdGhpcy5mb3JtYXREYXRlRmllbGQoZDJbZmllbGRdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVUb1Nob3cgPSB0LnZhbHVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5yZWZlcmVuY2VGaWVsZHMuaW5jbHVkZXMoZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlVG9TaG93ID0gdmFsdWVUb1Nob3cgPSBkW2ZpZWxkXVsndmFsdWUnXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZVRvU2hvdyA9IGRbZmllbGRdOy8vdGFrZSBkaXJlY3RveSBmcm9tIHdoYXQgd2UgZ2V0IFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoTW9yZURldGFpbC5wdXNoKFtmaWVsZCwgdmFsdWVUb1Nob3ddKTtcbiAgICAgICAgICAgICAgICBhbmRTZWFyY2hDb250ZXh0LnB1c2gobyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy9IYW5kbGUgZGF0ZSByYW5nZSBzZWxlY3Rpb24uIFRoZXNlIGZpZWxkcyBhcmUgbm90IGluIGQyLCBiZWNhdXNlIGZpZWxkLmRhdGUgaXMgdW5kZWZpbmVkLlxuICAgICAgICBmb3IgKGxldCBwcm9wIG9mIHRoaXMuZGF0ZUZpZWxkcykge1xuICAgICAgICAgICAgbGV0IG8gPSB7fTtcbiAgICAgICAgICAgIGxldCB2YWx1ZVRvU2hvdyA9IFwiXCI7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIG9bcHJvcF0gPSB7fTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZFtwcm9wXSAhPT0gJ29iamVjdCcpIHsgLy9ub3QgZGVmaW5lZFxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFkW3Byb3BdWydmcm9tJ10gJiYgIWRbcHJvcF1bJ3RvJ10pIHsgLy9ub3QgcmFuZ2VcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkW3Byb3BdWydmcm9tJ10pIHtcbiAgICAgICAgICAgICAgICBvW3Byb3BdWydmcm9tJ10gPSB0aGlzLmRlRm9ybWF0RGF0ZUZpZWxkKGRbcHJvcF1bJ2Zyb20nXSk7XG4gICAgICAgICAgICAgICAgdmFsdWVUb1Nob3cgKz0gdGhpcy5mb3JtYXREYXRlRmllbGQob1twcm9wXVsnZnJvbSddKS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbHVlVG9TaG93ICs9IFwiIH4gXCI7XG4gICAgICAgICAgICBpZiAoZFtwcm9wXVsndG8nXSkge1xuICAgICAgICAgICAgICAgIG9bcHJvcF1bJ3RvJ10gPSB0aGlzLmRlRm9ybWF0RGF0ZUZpZWxkKGRbcHJvcF1bJ3RvJ10pO1xuICAgICAgICAgICAgICAgIHZhbHVlVG9TaG93ICs9IHRoaXMuZm9ybWF0RGF0ZUZpZWxkKG9bcHJvcF1bJ3RvJ10pLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zZWFyY2hNb3JlRGV0YWlsLnB1c2goW3Byb3AsIHZhbHVlVG9TaG93XSk7XG4gICAgICAgICAgICBhbmRTZWFyY2hDb250ZXh0LnB1c2gobyk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgc2VhcmNoQ29udGV4dCA9IHsnJGFuZCc6IFt7JyRvcic6IG9yU2VhcmNoQ29udGV4dH0seyckYW5kJzogYW5kU2VhcmNoQ29udGV4dH1dfTtcbiAgICAgICAgLyogc2VhcmNoQ29udGV4dCA9eyckYW5kJywgW3snJG9yJywgW119LHsnJGFuZCcsIFtdfV19XG4gICAgICAgICovXG4gICAgICAgIGxldCBjb250ZXh0ID0gdGhpcy5nZXRGcm9tU3RvcmFnZShcInNlYXJjaENvbnRleHRcIik7XG4gICAgICAgIGlmIChjb250ZXh0ICYmIGNvbnRleHRbXCIkYW5kXCJdKSB7XG4gICAgICAgICAgICBsZXQgY2FjaGVkT3IsIGNhY2hlZEFuZDtcbiAgICAgICAgICAgIGZvciAobGV0IHN1YiBvZiBjb250ZXh0W1wiJGFuZFwiXSkge1xuICAgICAgICAgICAgICAgIGlmICgnJGFuZCcgaW4gc3ViKSBjYWNoZWRBbmQgPSBzdWJbJyRhbmQnXTtcbiAgICAgICAgICAgICAgICBlbHNlIGlmICgnJG9yJyBpbiBzdWIpIGNhY2hlZE9yID0gc3ViWyckb3InXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVxdWFsVHdvU2VhcmNoQ29udGV4dEFycmF5cyhjYWNoZWRPciwgb3JTZWFyY2hDb250ZXh0KSBcbiAgICAgICAgICAgICAgICAmJiB0aGlzLmVxdWFsVHdvU2VhcmNoQ29udGV4dEFycmF5cyhjYWNoZWRBbmQsIGFuZFNlYXJjaENvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IFxuICAgICAgICBcbiAgICAgICAgaWYgKG9yU2VhcmNoQ29udGV4dC5sZW5ndGggPT0gMCAmJiBhbmRTZWFyY2hDb250ZXh0Lmxlbmd0aCA9PSAwKSBzZWFyY2hDb250ZXh0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5wdXRUb1N0b3JhZ2UoXCJzZWFyY2hDb250ZXh0XCIsIHNlYXJjaENvbnRleHQpO1xuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcInNlYXJjaFRleHRcIiwgdGhpcy5zZWFyY2hUZXh0KTtcbiAgICAgICAgdGhpcy5wdXRUb1N0b3JhZ2UoXCJwYWdlXCIsIDEpOy8vc3RhcnQgZnJvbSAxc3QgcGFnZVxuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcInNlYXJjaE1vcmVEZXRhaWxcIiwgdGhpcy5zZWFyY2hNb3JlRGV0YWlsKTtcbiAgICAgICAgdGhpcy5wdXRUb1N0b3JhZ2UoXCJkZXRhaWxcIiwgdGhpcy5kZXRhaWwpO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgc2VhcmNoTGlzdCgpOnZvaWQge1xuICAgICAgICB0aGlzLnByb2Nlc3NTZWFyY2hDb250ZXh0KCk7XG4gICAgICAgIC8vdXBkYXRlIHRoZSBVUkxcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuJywge31dLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZX0pOy8vc3RhcnQgZnJvbSAxc3QgcGFnZVxuICAgICAgICB0aGlzLnB1dFRvU3RvcmFnZShcInBhZ2VcIiwgMSk7Ly9zdGFydCBmcm9tIDFzdCBwYWdlXG4gICAgICAgIHRoaXMucG9wdWxhdGVMaXN0KCk7XG4gICAgfVxuICAgIHByb3RlY3RlZCBsb2FkVUlGcm9tQ2FjaGUoKTp2b2lkIHtcbiAgICAgICAgLy9Ob3cgbGV0J3MgcmVsb2FkIHRoZSBzZWFyY2ggY29uZGl0aW9uIHRvIFVJXG4gICAgICAgIHRoaXMuc2VhcmNoVGV4dCA9IHRoaXMuZ2V0RnJvbVN0b3JhZ2UoXCJzZWFyY2hUZXh0XCIpO1xuICAgICAgICB0aGlzLnNlYXJjaE1vcmVEZXRhaWwgPSB0aGlzLmdldEZyb21TdG9yYWdlKFwic2VhcmNoTW9yZURldGFpbFwiKTtcbiAgICAgICAgbGV0IGRldGFpbCA9IHRoaXMuZ2V0RnJvbVN0b3JhZ2UoXCJkZXRhaWxcIik7XG4gICAgICAgIGlmIChkZXRhaWwpIHRoaXMuZGV0YWlsID0gZGV0YWlsO1xuICAgIH1cbiAgICBcbiAgICBwcm90ZWN0ZWQgcG9wdWxhdGVMaXN0KCk6RXZlbnRFbWl0dGVyPGFueT4ge1xuICAgICAgICAvL0ZpcnN0IGxldCdzIGhhbmRsZSBwYWdlXG4gICAgICAgIGxldCBuZXdfcGFnZTtcbiAgICAgICAgbGV0IHNlYXJjaENvbnRleHQsIHNlYXJjaFRleHQ7XG5cbiAgICAgICAgbGV0IHVybF9wYWdlID0gcGFyc2VJbnQodGhpcy5yb3V0ZS5zbmFwc2hvdC5wYXJhbU1hcC5nZXQoJ3BhZ2UnKSk7XG4gICAgICAgIGxldCBjYWNoZWRfcGFnZSA9IHBhcnNlSW50KHRoaXMuZ2V0RnJvbVN0b3JhZ2UoXCJwYWdlXCIpKTtcbiAgICAgICAgICAgIFxuICAgICAgICBpZiAoY2FjaGVkX3BhZ2UpIHsgXG4gICAgICAgICAgICBuZXdfcGFnZSA9IGNhY2hlZF9wYWdlO1xuICAgICAgICAgICAgaWYgKGNhY2hlZF9wYWdlID09IDEpXG4gICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuJywge31dLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZSwgfSk7Ly91cGRhdGUgdGhlIHVybFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnLicsIHtwYWdlOiBjYWNoZWRfcGFnZX1dLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZSwgfSk7Ly91cGRhdGUgdGhlIHVybFxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHVybF9wYWdlKSBuZXdfcGFnZSA9IHVybF9wYWdlO1xuICAgICAgICBlbHNlIG5ld19wYWdlID0gMTtcblxuICAgICAgICBzZWFyY2hDb250ZXh0ID0gdGhpcy5nZXRGcm9tU3RvcmFnZShcInNlYXJjaENvbnRleHRcIik7XG4gICAgICAgIHRoaXMubG9hZFVJRnJvbUNhY2hlKCk7ICAgICAgXG5cbiAgICAgICAgdGhpcy5zZXJ2aWNlLmdldExpc3QobmV3X3BhZ2UsIHRoaXMucGVyX3BhZ2UsIHNlYXJjaENvbnRleHQpLnN1YnNjcmliZShcbiAgICAgICAgICByZXN1bHQgPT4geyBcbiAgICAgICAgICAgIHRoaXMubGlzdCA9IHJlc3VsdC5pdGVtcy5tYXAoeD0+dGhpcy5mb3JtYXREZXRhaWwoeCkpO1xuICAgICAgICAgICAgdGhpcy5wYWdlID0gcmVzdWx0LnBhZ2U7XG4gICAgICAgICAgICB0aGlzLnBlcl9wYWdlID0gcmVzdWx0LnBlcl9wYWdlO1xuICAgICAgICAgICAgdGhpcy50b3RhbF9jb3VudCA9IHJlc3VsdC50b3RhbF9jb3VudDtcbiAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZXMgPSByZXN1bHQudG90YWxfcGFnZXM7XG4gICAgICAgICAgICB0aGlzLnBvcHVsYXRlUGFnZXMoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5jaGVja2VkSXRlbSA9IFxuICAgICAgICAgICAgICAgIEFycmF5LmFwcGx5KG51bGwsIEFycmF5KHRoaXMubGlzdC5sZW5ndGgpKS5tYXAoQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZixmYWxzZSk7XG4gICAgICAgICAgICB0aGlzLmNoZWNrQWxsID0gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0aGlzLnJlZnJlc2hpbmcpIHtcbiAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgIGxldCBzbmFja0JhckNvbmZpZzogU25hY2tCYXJDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICBjb250ZW50OiBcIkxpc3QgcmVmcmVzaGVkXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBsZXQgc25hY2tCYXIgPSBuZXcgU25hY2tCYXIoc25hY2tCYXJDb25maWcpO1xuICAgICAgICAgICAgICBzbmFja0Jhci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmV2ZW50RW1pdHRlci5lbWl0KHRoaXMubGlzdCk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0aGlzLm9uU2VydmljZUVycm9yXG4gICAgICAgICk7XG4gICAgICByZXR1cm4gdGhpcy5ldmVudEVtaXR0ZXI7XG4gICAgfVxuICAgIFxuICAgIFxuICAgIC8qVUkgb3BlcmF0aW9ucyBoYW5kbGVycyovXG4gICAgcHVibGljIG9uUmVmcmVzaCgpOnZvaWQge1xuICAgICAgICBpZiAodGhpcy52aWV3ID09IFZpZXdUeXBlLkxJU1QpIHtcbiAgICAgICAgICB0aGlzLnJlZnJlc2hpbmcgPSB0cnVlO1xuICAgICAgICAgIHRoaXMucG9wdWxhdGVMaXN0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy52aWV3ID09IFZpZXdUeXBlLkRFVEFJTCkge1xuICAgICAgICAgIHRoaXMucmVmcmVzaGluZyA9IHRydWU7XG4gICAgICAgICAgaWYgKCF0aGlzLmlkKSB0aGlzLmlkID0gdGhpcy5yb3V0ZS5zbmFwc2hvdC5wYXJhbU1hcC5nZXQoJ2lkJyk7XG4gICAgICAgICAgaWYgKHRoaXMuaWQpIHRoaXMucG9wdWxhdGVEZXRhaWwodGhpcy5pZCk7XG4gICAgICAgICAgZWxzZSBjb25zb2xlLmVycm9yKFwiUm91dGluZyBlcnJvciBmb3IgZGV0YWlsIHZpZXcuLi4gbm8gaWQuLi5cIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHVibGljIG9uQ2hlY2tBbGxDaGFuZ2UoKTp2b2lkIHtcbiAgICAgICAgdGhpcy5jaGVja2VkSXRlbSA9IFxuICAgICAgICAgICAgIEFycmF5LmFwcGx5KG51bGwsIEFycmF5KHRoaXMubGlzdC5sZW5ndGgpKS5cbiAgICAgICAgICAgICAgICBtYXAoQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZix0aGlzLmNoZWNrQWxsKTtcbiAgICB9XG4gICAgXG4gICAgcHVibGljIGlzSXRlbVNlbGVjdGVkKCk6Ym9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrZWRJdGVtLnNvbWUoKHZhbHVlKT0+e3JldHVybiB2YWx1ZTt9KVxuICAgIH1cblxuICAgIHB1YmxpYyBvbkRlbGV0ZVNlbGVjdGVkKCk6dm9pZCB7XG4gICAgICAgIGxldCBkZWxldGVkSXRlbSA9IFtdO1xuICAgICAgICB0aGlzLmNoZWNrZWRJdGVtLmZvckVhY2goKHZhbHVlLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGVkSXRlbS5wdXNoKHRoaXMubGlzdFtpbmRleF1bXCJfaWRcIl0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbGV0IG1vZGFsQ29uZmlnOiBNb2RhbENvbmZpZyA9IHtcbiAgICAgICAgdGl0bGU6IFwiRGVsZXRlIENvbmZpcm1hdGlvblwiLFxuICAgICAgICBjb250ZW50OiBcIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgc2VsZWN0ZWQgaXRlbXMgZnJvbSB0aGUgc3lzdGVtP1wiLFxuICAgICAgICAvL2xpc3Qgb2YgYnV0dG9uIHRleHRcbiAgICAgICAgYnV0dG9uczogWydEZWxldGUnLCAnQ2FuY2VsJ10sXG4gICAgICAgIC8vbGlzdCBvZiBidXR0b24gcmV0dXJucyB3aGVuIGNsaWNrZWRcbiAgICAgICAgcmV0dXJuczogW3RydWUsIGZhbHNlXSxcbiAgICAgICAgY2FsbEJhY2s6IChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlcnZpY2UuZGVsZXRlTWFueUJ5SWRzKGRlbGV0ZWRJdGVtKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc25hY2tCYXJDb25maWc6IFNuYWNrQmFyQ29uZmlnID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuSXRlbUNhbWVsTmFtZSArIFwiIGRlbGV0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNuYWNrQmFyID0gbmV3IFNuYWNrQmFyKHNuYWNrQmFyQ29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNuYWNrQmFyLnNob3coKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudmlldyAhPSBWaWV3VHlwZS5MSVNUKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnLi4vLi4vbGlzdCddLCB7cmVsYXRpdmVUbzogdGhpcy5yb3V0ZX0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGxlbiA9IHRoaXMuY2hlY2tlZEl0ZW0ubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpZHggPSBsZW4gLSAxIC0gaTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5jaGVja2VkSXRlbVtpZHhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdC5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlZEl0ZW0uc3BsaWNlKGlkeCwxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxfY291bnQgLT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgbGV0IG1vZGFsID0gbmV3IE1vZGFsKG1vZGFsQ29uZmlnKTtcbiAgICAgIG1vZGFsLnNob3coKTtcbiAgICB9XG4gICAgXG4gICAgcHVibGljIG9uRGVsZXRlKGlkOnN0cmluZywgaWR4OiBudW1iZXIpOnZvaWQgeyAgICAgIFxuICAgICAgbGV0IG1vZGFsQ29uZmlnOiBNb2RhbENvbmZpZyA9IHtcbiAgICAgICAgdGl0bGU6IFwiRGVsZXRlIENvbmZpcm1hdGlvblwiLFxuICAgICAgICBjb250ZW50OiBcIkFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBcIiArIHRoaXMuaXRlbUNhbWVsTmFtZSArIFwiIGZyb20gdGhlIHN5c3RlbT9cIixcbiAgICAgICAgLy9saXN0IG9mIGJ1dHRvbiB0ZXh0XG4gICAgICAgIGJ1dHRvbnM6IFsnRGVsZXRlJywgJ0NhbmNlbCddLFxuICAgICAgICAvL2xpc3Qgb2YgYnV0dG9uIHJldHVybnMgd2hlbiBjbGlja2VkXG4gICAgICAgIHJldHVybnM6IFt0cnVlLCBmYWxzZV0sXG4gICAgICAgIGNhbGxCYWNrOiAocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXJ2aWNlLmRlbGV0ZU9uZShpZCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNuYWNrQmFyQ29uZmlnOiBTbmFja0JhckNvbmZpZyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLkl0ZW1DYW1lbE5hbWUgKyBcIiBkZWxldGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzbmFja0JhciA9IG5ldyBTbmFja0JhcihzbmFja0JhckNvbmZpZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzbmFja0Jhci5zaG93KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZpZXcgIT0gVmlld1R5cGUuTElTVClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJy4uLy4uL2xpc3QnXSwge3JlbGF0aXZlVG86IHRoaXMucm91dGV9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGlkeCE9bnVsbCAmJiB0aGlzLmxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LnNwbGljZShpZHgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZWRJdGVtLnNwbGljZShpZHgsMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxfY291bnQgLT0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGxldCBtb2RhbCA9IG5ldyBNb2RhbChtb2RhbENvbmZpZyk7XG4gICAgICBtb2RhbC5zaG93KCk7XG4gICAgfVxuICAgIFxuICAgIHB1YmxpYyBvblN1Ym1pdCgpOnZvaWQge1xuICAgICAgaWYgKCF0aGlzLmV4dHJhRmllbGRzTG9hZCgpKSByZXR1cm47IC8vZXJyb3IgZnJvbSBvdGhlciBub24gbmdNb2RlbCBmaWVsZHM7XG4gICAgICAgIFxuICAgICAgdGhpcy5fZGV0YWlsID0gdGhpcy5kZUZvcm1hdERldGFpbCh0aGlzLmRldGFpbCk7XG4gICAgICBpZiAodGhpcy5pZCkge1xuICAgICAgICAgIHRoaXMuc2VydmljZS51cGRhdGVPbmUodGhpcy5pZCwgdGhpcy5fZGV0YWlsKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICByZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIHZhciBzbmFja0JhckNvbmZpZzogU25hY2tCYXJDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuSXRlbUNhbWVsTmFtZSArIFwiIHVwZGF0ZWQuXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNuYWNrQmFyID0gbmV3IFNuYWNrQmFyKHNuYWNrQmFyQ29uZmlnKTtcbiAgICAgICAgICAgICAgICBzbmFja0Jhci5zaG93KCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuLi8uLi9kZXRhaWwnLCB0aGlzLmlkXSwge3JlbGF0aXZlVG86IHRoaXMucm91dGV9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0aGlzLm9uU2VydmljZUVycm9yXG4gICAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2VydmljZS5jcmVhdGVPbmUodGhpcy5fZGV0YWlsKS5zdWJzY3JpYmUoXG4gICAgICAgICAgICByZXN1bHQgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBhY3Rpb24gPSB0aGlzLnN1YkVkaXQ/IFwiIGFkZGVkXCI6XCIgY3JlYXRlZC5cIjtcblxuICAgICAgICAgICAgICAgIHZhciBzbmFja0JhckNvbmZpZzogU25hY2tCYXJDb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMuSXRlbUNhbWVsTmFtZSArIGFjdGlvblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc25hY2tCYXIgPSBuZXcgU25hY2tCYXIoc25hY2tCYXJDb25maWcpO1xuICAgICAgICAgICAgICAgIHNuYWNrQmFyLnNob3coKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmlkID0gcmVzdWx0W1wiX2lkXCJdO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RldGFpbCA9IHJlc3VsdDtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnN1YkVkaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kb25lLmVtaXQodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycuLi9kZXRhaWwnLCB0aGlzLmlkXSwge3JlbGF0aXZlVG86IHRoaXMucm91dGV9KTtcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRoaXMub25TZXJ2aWNlRXJyb3JcbiAgICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgZWRpdENhbmNlbCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3ViRWRpdCkge1xuICAgICAgICAgICAgdGhpcy5kb25lLmVtaXQoZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nb0JhY2soKTtcbiAgICAgICAgfSBcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY2xpY2tlZElkID0gbnVsbDtcbiAgICBwdWJsaWMgb25EaXNwbGF5UmVmQ2xpY2tlZChmbjpzdHJpbmcsIGRldGFpbDphbnksIGV2ZW50OmFueSk6dm9pZCB7XG4gICAgICAgIGxldCByZWYgPSB0aGlzLmdldFJlZkZyb21GaWVsZChmbik7XG4gICAgICAgIGxldCBkID0gZGV0YWlsO1xuICAgICAgICBcbiAgICAgICAgaWYgKGQgJiYgZFsnX2lkJ10pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpc3QpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpdGVtIG9mIHRoaXMubGlzdCl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpdGVtW2ZuXSA9PSBkKSB0aGlzLmNsaWNrZWRJZCA9IGl0ZW1bJ19pZCddO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtyZWYsICdkZXRhaWwnLCBkWydfaWQnXV0sIHtyZWxhdGl2ZVRvOiB0aGlzLmdldFBhcmVudEFjdGl2YXRlZFJvdXRlcigpIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmVudCkgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfVxuXG4gICAgcHVibGljIG9uRGV0YWlsTGlua0NsaWNrZWQoaWQ6c3RyaW5nKTp2b2lkIHtcbiAgICAgICAgdGhpcy5jbGlja2VkSWQgPSBpZDsgXG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFt0aGlzLml0ZW1OYW1lLCAnZGV0YWlsJywgaWRdLCB7cmVsYXRpdmVUbzogdGhpcy5nZXRQYXJlbnRBY3RpdmF0ZWRSb3V0ZXIoKSB9KTtcbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIGdldFJlZkZyb21GaWVsZChmbjpzdHJpbmcpOnN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlZmVyZW5jZUZpZWxkc01hcFtmbl07XG4gICAgfVxuXG4gICAgcHVibGljIGNsZWFyVmFsdWVGcm9tRGV0YWlsKGZpZWxkOnN0cmluZyk6dm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5kZXRhaWwuaGFzT3duUHJvcGVydHkoZmllbGQpKSByZXR1cm47XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5kZXRhaWxbZmllbGRdID09ICd1bmRlZmluZWQnKSByZXR1cm47XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5kZXRhaWxbZmllbGRdID09ICdvYmplY3QnKSB7Ly9yZWZlcmVuY2UgZmllbGQgb3IgZGF0ZVxuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3Rpb25GaWVsZHMuaW5jbHVkZXMoZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGRdID0gdGhpcy5jbGVhckZpZWxkQXJyYXlNdWx0aVNlbGVjdGlvbih0aGlzLmRldGFpbFtmaWVsZF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmFycmF5RmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZF0gPSB0aGlzLmNsZWFyRmllbGRBcnJheSh0aGlzLmRldGFpbFtmaWVsZF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1hcEZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGRdID0gdGhpcy5jbGVhckZpZWxkTWFwKHRoaXMuZGV0YWlsW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0ZUZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZF0gPSB0aGlzLmNsZWFyRmllbGREYXRlKHRoaXMuZGV0YWlsW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmVmZXJlbmNlRmllbGRzLmluY2x1ZGVzKGZpZWxkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkXSA9IHRoaXMuY2xlYXJGaWVsZFJlZmVyZW5jZSh0aGlzLmRldGFpbFtmaWVsZF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy9jaGVjayBpZiBhbnkgaW5mbyBuZWVkcyB0byBjaGFuZ2UgYWZ0ZXIgY2xlYXIgY2VydGFpbiB2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5kZXRhaWxbZmllbGRdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBjbGVhclZhbHVlRnJvbUFycmF5RmllbGQoZmllbGQ6IHN0cmluZywgaWR4OiBudW1iZXIpOnZvaWQge1xuICAgICAgICBpZiAodGhpcy5kZXRhaWxbZmllbGRdWydzZWxlY3Rpb24nXSkge1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGRdWydzZWxlY3Rpb24nXSA9IHRoaXMuZGV0YWlsW2ZpZWxkXVsnc2VsZWN0aW9uJ10uZmlsdGVyKCh4LGkpPT4gaSAhPSBpZHggKTtcbiAgICAgICAgICAgIC8vY2hlY2sgaWYgYW55IGluZm8gbmVlZHMgdG8gY2hhbmdlIGFmdGVyIGNsZWFyIGNlcnRhaW4gdmFsdWVzO1xuICAgICAgICAgICAgdGhpcy5leHRyYUluZm9Qb3B1bGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBjbGVhclZhbHVlRnJvbU1hcEZpZWxkKGZpZWxkOiBzdHJpbmcsIGtleTogc3RyaW5nKTp2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGV0YWlsW2ZpZWxkXVsnc2VsZWN0aW9uJ10pIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmRldGFpbFtmaWVsZF1bJ3NlbGVjdGlvbiddW2tleV07XG4gICAgICAgICAgICAvL2NoZWNrIGlmIGFueSBpbmZvIG5lZWRzIHRvIGNoYW5nZSBhZnRlciBjbGVhciBjZXJ0YWluIHZhbHVlcztcbiAgICAgICAgICAgIHRoaXMuZXh0cmFJbmZvUG9wdWxhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgY2xlYXJWYWx1ZUZyb21NYXBLZXkoZmllbGQ6IHN0cmluZywga2V5OiBzdHJpbmcpOnZvaWQge1xuICAgICAgICBpZiAodGhpcy5kZXRhaWxbZmllbGRdWydzZWxlY3Rpb24nXSkge1xuICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGRdWydzZWxlY3Rpb24nXVtrZXldID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgLy9jaGVjayBpZiBhbnkgaW5mbyBuZWVkcyB0byBjaGFuZ2UgYWZ0ZXIgY2xlYXIgY2VydGFpbiB2YWx1ZXM7XG4gICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gIFxuICAgIHB1YmxpYyBjaGVja1ZhbHVlRGVmaW5lZEZyb21EZXRhaWwoZmllbGQ6c3RyaW5nKTpib29sZWFuIHtcbiAgICAgICAgbGV0IGQgPSB0aGlzLmRldGFpbDtcbiAgICAgICAgaWYgKCFkLmhhc093blByb3BlcnR5KGZpZWxkKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgICBpZiAodHlwZW9mIGRbZmllbGRdID09ICd1bmRlZmluZWQnKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5kZXRhaWxbZmllbGRdID09ICdudW1iZXInIFxuICAgICAgICAgICAgfHwgdHlwZW9mIGRbZmllbGRdID09ICdzdHJpbmcnXG4gICAgICAgICAgICB8fCB0eXBlb2YgZFtmaWVsZF0gPT0gJ2Jvb2xlYW4nKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKHR5cGVvZiBkW2ZpZWxkXSA9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgaWYgKHRoaXMubXVsdGlTZWxlY3Rpb25GaWVsZHMuaW5jbHVkZXMoZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNEZWZpbmVkRmllbGRBcnJheU11bHRpU2VsZWN0aW9uKGRbZmllbGRdKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5hcnJheUZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXNEZWZpbmVkRmllbGRBcnJheShkW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubWFwRmllbGRzLnNvbWUoeD0+eFswXSA9PSBmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZE1hcChkW2ZpZWxkXSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGF0ZUZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZERhdGUoZFtmaWVsZF0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlZmVyZW5jZUZpZWxkcy5pbmNsdWRlcyhmaWVsZCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pc0RlZmluZWRGaWVsZFJlZmVyZW5jZShkW2ZpZWxkXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHB1YmxpYyBjbGVhclZhbHVlRnJvbURldGFpbEFuZFNlYXJjaExpc3QoZmllbGQ6c3RyaW5nKTp2b2lkIHtcbiAgICAgICAgdGhpcy5jbGVhclZhbHVlRnJvbURldGFpbChmaWVsZCk7XG4gICAgICAgIHRoaXMuc2VhcmNoTGlzdCgpO1xuICAgIH1cbiAgICBcbiAgICBwdWJsaWMgb25BZGRBcnJheUl0ZW0oZmllbGROYW1lOnN0cmluZykge1xuICAgICAgICBpZiAodGhpcy5hcnJheUZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyduZXcnXSkgeyAvL3doZXJlIG5ldyBhZGRlZCBpdGVtIGlzIHN0b3JlZFxuICAgICAgICAgICAgbGV0IGl0ZW0gPSB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyduZXcnXTtcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ25ldyddID0gdW5kZWZpbmVkOyAvL2NsZWFyIGl0XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3NlbGVjdGlvbiddLnB1c2goaXRlbSk7XG4gICAgICAgICAgXG4gICAgICAgICAgICBsZXQgdmFsdWVzID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXSkgdmFsdWVzID0gdGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXS5zcGxpdCgnIHwgJylcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKGl0ZW0pOyAvL2Rpc3BsYXkgdmFsdWVcbiAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5maWx0ZXIoeD0+ISF4KTtcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10gPSB2YWx1ZXMuam9pbignIHwgJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vc2VlIGlmIHJlbGF0ZWQgaW5mbyBuZWVkcyB0byBjaGFuZ2UgYWZ0ZXIgdGhlIGNoYW5nZSBvZiB0aGlzIHZhbHVlXG4gICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcbiAgICB9XG4gICAgcHVibGljIG9uQWRkTWFwSXRlbShmaWVsZE5hbWU6c3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLm1hcEZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyduZXcnXSkgeyAvL3doZXJlIG5ldyBhZGRlZCBpdGVtIGlzIHN0b3JlZFxuICAgICAgICAgICAgbGV0IGl0ZW0gPSB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyduZXcnXTtcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ25ldyddID0gdW5kZWZpbmVkOyAvL2NsZWFyIGl0XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3NlbGVjdGlvbiddW2l0ZW1dID0gdW5kZWZpbmVkOyAvL21vdmUgdG8gc2VsZWN0aW9uIG9iamVjdFxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvL1RPRE86IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10gY2hhbmdlXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vc2VlIGlmIHJlbGF0ZWQgaW5mbyBuZWVkcyB0byBjaGFuZ2UgYWZ0ZXIgdGhlIGNoYW5nZSBvZiB0aGlzIHZhbHVlXG4gICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcbiAgICB9XG4gICAgLy8qKioqIEZvciBwYXJlbnQgY29tcG9uZW50IG9mIG1vZGFsIFVJXG4gICAgcHJvdGVjdGVkIHJlZlNlbGVjdERpcmVjdGl2ZTphbnk7XG4gICAgcHJvdGVjdGVkIHNlbGVjdENvbXBvbmVudHM6YW55OyAvL3tmaWVsZE5hbWU6IGNvbXBvbmVudC10eXBlfSBmb3JtYXRcbiAgICBwcm90ZWN0ZWQgY29tcG9uZW50RmFjdG9yeVJlc29sdmVyOiBhbnk7IC8vaW5qZWN0ZWQgYnkgZXh0ZW5kZWQgY2xhc3MsIGlmIG5lZWRlZC5cbiAgICBwcml2YXRlIGNvbXBvbmVudFN1YnNjcmlwdGlvblxuICAgIHB1YmxpYyBvblJlZlNlbGVjdChmaWVsZE5hbWU6c3RyaW5nKSB7XG4gICAgICAgIGlmICghdGhpcy5yZWZTZWxlY3REaXJlY3RpdmUpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJObyByZWZlcmVuY2UgZGlyZWN0aXZlIGZvciBmaWVsZDogXCIsIGZpZWxkTmFtZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCB2aWV3Q29udGFpbmVyUmVmID0gdGhpcy5yZWZTZWxlY3REaXJlY3RpdmUudmlld0NvbnRhaW5lclJlZjtcbiAgICAgICAgdmlld0NvbnRhaW5lclJlZi5jbGVhcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCF0aGlzLnNlbGVjdENvbXBvbmVudHNbZmllbGROYW1lXSkge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcIk5vIHJlZmVyZW5jZSBkZWZpbmVkIGZvciBmaWVsZDogXCIsIGZpZWxkTmFtZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjb21wb25lbnRSZWYgPSB0aGlzLnNlbGVjdENvbXBvbmVudHNbZmllbGROYW1lXVtcImNvbXBvbmVudFJlZlwiXTtcbiAgICAgICAgaWYgKCFjb21wb25lbnRSZWYpIHtcbiAgICAgICAgICAgIGxldCBjb21UeXBlID0gdGhpcy5zZWxlY3RDb21wb25lbnRzW2ZpZWxkTmFtZV1bXCJzZWxlY3QtdHlwZVwiXVxuICAgICAgICAgICAgaWYgKCFjb21UeXBlKSBjb25zb2xlLndhcm4oXCJObyBjb21wb25lbnQgdHlwZSBmb3VuZCBmb3IgcmVmZXJlbmNlIGZpZWxkIFwiLCBmaWVsZE5hbWUpO1xuXG4gICAgICAgICAgICBsZXQgY29tcG9uZW50RmFjdG9yeSA9IHRoaXMuY29tcG9uZW50RmFjdG9yeVJlc29sdmVyLnJlc29sdmVDb21wb25lbnRGYWN0b3J5KGNvbVR5cGUpO1xuICAgICAgICAgICAgY29tcG9uZW50UmVmID0gdmlld0NvbnRhaW5lclJlZi5jcmVhdGVDb21wb25lbnQoY29tcG9uZW50RmFjdG9yeSk7Ly9jcmVhdGUgYW5kIGluc2VydCBpbiBvbmUgY2FsbFxuICAgICAgICAgICAgdGhpcy5zZWxlY3RDb21wb25lbnRzW2ZpZWxkTmFtZV1bXCJjb21wb25lbnRSZWZcIl0gPSBjb21wb25lbnRSZWY7Ly9zYXZlIGl0XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2aWV3Q29udGFpbmVyUmVmLmluc2VydChjb21wb25lbnRSZWYuaG9zdFZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsZXQgY29tcG9uZW50SW5zdGFuY2UgPSA8QmFzZUNvbXBvbmVudEludGVyZmFjZT5jb21wb25lbnRSZWYuaW5zdGFuY2U7XG4gICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZE5hbWVdKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5yZWZlcmVuY2VGaWVsZHMuaW5jbHVkZXMoZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmlucHV0RGF0YSA9IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ19pZCddO1xuICAgICAgICAgICAgfSAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGNvbXBvbmVudEluc3RhbmNlLnNldEZvY3VzKCk7XG4gICAgICAgIFxuIFxuICAgICAgICB0aGlzLmNvbXBvbmVudFN1YnNjcmlwdGlvbiA9IGNvbXBvbmVudEluc3RhbmNlLmRvbmUuc3Vic2NyaWJlKCAodmFsKSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnRTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICB2aWV3Q29udGFpbmVyUmVmLmRldGFjaCgpOyAvL29ubHkgZGV0YWNoLiBub3QgZGVzdHJveVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IG91dHB1dERhdGEgPSBjb21wb25lbnRJbnN0YW5jZS5vdXRwdXREYXRhO1xuICAgICAgICAgICAgaWYgKG91dHB1dERhdGEpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG91dHB1dERhdGEuYWN0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInNlbGVjdGVkXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5hcnJheUZpZWxkcy5zb21lKHg9PnhbMF0gPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3NlbGVjdGlvbiddLnB1c2goIG91dHB1dERhdGEudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdmFsdWVzID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10pIHZhbHVlcyA9IHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV1bJ3ZhbHVlJ10uc3BsaXQoJyB8ICcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2gob3V0cHV0RGF0YS52YWx1ZS52YWx1ZSk7IC8vZGlzcGxheSB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcyA9IHZhbHVlcy5maWx0ZXIoeD0+ISF4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyd2YWx1ZSddID0gdmFsdWVzLmpvaW4oJyB8ICcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJlZmVyZW5jZUZpZWxkcy5pbmNsdWRlcyhmaWVsZE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXSA9IG91dHB1dERhdGEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciBleHRyYUluZm8gcG9wdWxhdGUsIG9uY2UgcmVmZXJlbmNlIGNoYW5nZWQuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmV4dHJhSW5mb1BvcHVsYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcInZpZXdcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub25SZWZTaG93KGZpZWxkTmFtZSwgXCJzZWxlY3RcIiwgb3V0cHV0RGF0YS52YWx1ZSk7Ly92YWx1ZSBpcyBfaWRcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHB1YmxpYyBvblJlZlNob3coZmllbGROYW1lOnN0cmluZywgYWN0aW9uOnN0cmluZywgaWQ6c3RyaW5nKSB7XG4gICAgICAgIGlmICghaWQgJiYgdGhpcy5kZXRhaWxbZmllbGROYW1lXSkgaWQgPSB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWydfaWQnXTtcbiAgICAgICAgaWYgKCFpZCkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1Nob3cgcmVmZXJlbmNlIGJ1dCBubyBpZCBpcyBnaXZlbi4nKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHZpZXdDb250YWluZXJSZWYgPSB0aGlzLnJlZlNlbGVjdERpcmVjdGl2ZS52aWV3Q29udGFpbmVyUmVmO1xuICAgICAgICB2aWV3Q29udGFpbmVyUmVmLmNsZWFyKCk7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGV0YWlsVHlwZSA9IGFjdGlvbiArIFwiLWRldGFpbC10eXBlXCI7IC8vZWc6IHNlbGVjdC1kZXRhaWwtdHlwZSwgcG9wLWRldGFpbC10eXBlXG4gICAgICAgIGxldCBjb21UeXBlID0gdGhpcy5zZWxlY3RDb21wb25lbnRzW2ZpZWxkTmFtZV1bZGV0YWlsVHlwZV1cbiAgICAgICAgaWYgKCFjb21UeXBlKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIk5vIGNvbXBvbmVudCB0eXBlIGZvdW5kIGZvcjogJXNcIiwgZGV0YWlsVHlwZSk7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCBjb21wb25lbnRGYWN0b3J5ID0gdGhpcy5jb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoY29tVHlwZSk7XG4gICAgICAgIGxldCBjb21wb25lbnRSZWYgPSB2aWV3Q29udGFpbmVyUmVmLmNyZWF0ZUNvbXBvbmVudChjb21wb25lbnRGYWN0b3J5KTsvL2NyZWF0ZSBhbmQgaW5zZXJ0IGluIG9uZSBjYWxsXG5cbiAgICAgICAgbGV0IGNvbXBvbmVudEluc3RhbmNlID0gPEJhc2VDb21wb25lbnRJbnRlcmZhY2U+Y29tcG9uZW50UmVmLmluc3RhbmNlO1xuICAgICAgICBjb21wb25lbnRJbnN0YW5jZS5pbnB1dERhdGEgPSBpZDtcbiAgICAgICAgY29tcG9uZW50SW5zdGFuY2Uuc2V0Rm9jdXMoKTtcbiAgICAgICBcbiAgICAgICAgY29tcG9uZW50SW5zdGFuY2UuZG9uZS5zdWJzY3JpYmUoICh2YWwpID0+IHtcbiAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgY29tcG9uZW50SW5zdGFuY2UuZG9uZS51bnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgdmlld0NvbnRhaW5lclJlZi5jbGVhcigpO1xuICAgICAgICAgICB9XG4gICAgICAgICAgIGxldCBvdXRwdXREYXRhID0gY29tcG9uZW50SW5zdGFuY2Uub3V0cHV0RGF0YTtcbiAgICAgICAgICAgIGlmIChvdXRwdXREYXRhKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChvdXRwdXREYXRhLmFjdGlvbil7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzZWxlY3RlZFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYXJyYXlGaWVsZHMuc29tZSh4PT54WzBdID09IGZpZWxkTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWydzZWxlY3Rpb24nXS5wdXNoKCBvdXRwdXREYXRhLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyd2YWx1ZSddKSB2YWx1ZXMgPSB0aGlzLmRldGFpbFtmaWVsZE5hbWVdWyd2YWx1ZSddLnNwbGl0KCcgfCAnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKG91dHB1dERhdGEudmFsdWUudmFsdWUpOyAvL2Rpc3BsYXkgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXMgPSB2YWx1ZXMuZmlsdGVyKHg9PiEheCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhaWxbZmllbGROYW1lXVsndmFsdWUnXSA9IHZhbHVlcy5qb2luKCcgfCAnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5yZWZlcmVuY2VGaWVsZHMuaW5jbHVkZXMoZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWlsW2ZpZWxkTmFtZV0gPSBvdXRwdXREYXRhLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RyaWdnZXIgZXh0cmFJbmZvIHBvcHVsYXRlLCBvbmNlIHJlZmVyZW5jZSBjaGFuZ2VkLlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5leHRyYUluZm9Qb3B1bGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJiYWNrXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9uUmVmU2VsZWN0KGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvL0ZvbGxvd2luZyBoYXZuJ3QgYmVlbiB1c2VkIHlldFxuICAgIC8qXG4gICAgcHJpdmF0ZSB0eXBpbmdUaW1lcjtcbiAgICBwdWJsaWMgb25LZXlVcChmaWVsZE5hbWU6c3RyaW5nLCB2YWx1ZTpzdHJpbmcpOnZvaWQge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50eXBpbmdUaW1lcik7XG4gICAgXG4gICAgICAgIHRoaXMudHlwaW5nVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJbnB1dCBWYWx1ZTonLCB2YWx1ZSk7XG4gICAgICAgIH0sIDEwMDApO1xuICAgIH1cbiAgICAqL1xuICAgIC8vKioqKiBGb3IgY2hpbGQgY29tcG9uZW50IG9mIG1vZGFsIFVJXG4gICAgcHVibGljIGlucHV0RGF0YTtcbiAgICBwdWJsaWMgb3V0cHV0RGF0YTtcbiAgICBwdWJsaWMgZG9uZTphbnk7XG4gICAgcHJvdGVjdGVkIGZvY3VzRWw7IC8vRWxlbWVudFJlZlxuICAgIHNldEZvY3VzKCkge1xuICAgICAgICBpZiAodGhpcy5mb2N1c0VsKVxuICAgICAgICAgICAgdGhpcy5mb2N1c0VsLm5hdGl2ZUVsZW1lbnQuZm9jdXMoKTtcbiAgICB9XG4gICAgdWlDbG9zZU1vZGFsKCkge1xuICAgICAgICB0aGlzLm91dHB1dERhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLmRvbmUuZW1pdCh0cnVlKTtcbiAgICB9XG4gICAgdWlPbkVzY2FwZUtleSgpIHtcbiAgICAgICAgdGhpcy51aUNsb3NlTW9kYWwoKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgc2VsZWN0ZWRJZCA9IG51bGw7XG4gICAgc2VsZWN0SXRlbVNlbGVjdGVkKG51bTpudW1iZXIpIHtcbiAgICAgICAgbGV0IGRldGFpbCA9IHRoaXMubGlzdFtudW1dO1xuICAgICAgICB0aGlzLnNlbGVjdGVkSWQgPSBkZXRhaWxbJ19pZCddO1xuICAgICAgICB0aGlzLmNsaWNrZWRJZCA9IGRldGFpbFsnX2lkJ107XG4gICAgICAgIHRoaXMub3V0cHV0RGF0YSA9IHthY3Rpb246IFwic2VsZWN0ZWRcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcIl9pZFwiOiBkZXRhaWxbXCJfaWRcIl0sIFwidmFsdWVcIjogdGhpcy5zdHJpbmdpZnkoZGV0YWlsKX0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBkZXRhaWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgdGhpcy5kb25lLmVtaXQodHJ1ZSk7XG4gICAgfVxuICAgIFxuICAgIGRldGFpbFNlbFNlbGVjdGVkKCkge1xuICAgICAgICBsZXQgZGV0YWlsID0gdGhpcy5kZXRhaWw7XG4gICAgICAgIHRoaXMub3V0cHV0RGF0YSA9IHthY3Rpb246IFwic2VsZWN0ZWRcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHtcIl9pZFwiOiBkZXRhaWxbXCJfaWRcIl0sIFwidmFsdWVcIjogdGhpcy5zdHJpbmdpZnkoZGV0YWlsKX0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBkZXRhaWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgdGhpcy5kb25lLmVtaXQodHJ1ZSk7XG4gICAgfVxuXG4gICAgc2VsZWN0Vmlld0RldGFpbChudW06bnVtYmVyKSB7XG4gICAgICAgIGxldCBkZXRhaWwgPSB0aGlzLmxpc3RbbnVtXTtcbiAgICAgICAgdGhpcy5jbGlja2VkSWQgPSBkZXRhaWxbJ19pZCddO1xuICAgICAgICB0aGlzLm91dHB1dERhdGEgPSB7YWN0aW9uOiBcInZpZXdcIiwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGRldGFpbFtcIl9pZFwiXVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICB0aGlzLmRvbmUuZW1pdCh0cnVlKTtcbiAgICB9XG4gICAgXG4gICAgZGV0YWlsU2VsQmFjaygpIHtcbiAgICAgICAgdGhpcy5vdXRwdXREYXRhID0ge2FjdGlvbjogXCJiYWNrXCIsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgIHRoaXMuZG9uZS5lbWl0KHRydWUpO1xuICAgIH1cbiAgICBcbiAgICAvL1NlYXJjaCBtb3JlIGluIHRoZSBsaXN0IHZpZXdcbiAgICBwcm90ZWN0ZWQgc2VhcmNoVGV4dDogc3RyaW5nO1xuICAgIHByb3RlY3RlZCBzZWFyY2hNb3JlRGV0YWlsOiBhbnk7XG4gICAgcHVibGljIG1vcmVTZWFyY2hPcGVuZWQ6Ym9vbGVhbiA9IGZhbHNlO1xuICAgIHRvZ2dsZU1vcmVTZWFyY2goKSB7XG4gICAgICAgIHRoaXMubW9yZVNlYXJjaE9wZW5lZCA9ICF0aGlzLm1vcmVTZWFyY2hPcGVuZWQ7XG4gICAgfSAgICBcbiAgICBvblNlYXJjaFRleHRDbGVhcigpOnZvaWQge1xuICAgICAgdGhpcy5zZWFyY2hUZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKCF0aGlzLm1vcmVTZWFyY2hPcGVuZWQpIHRoaXMuc2VhcmNoTGlzdCgpO1xuICAgIH1cbiAgICBvblNlYXJjaENsZWFyKCkge1xuICAgICAgICB0aGlzLnNlYXJjaFRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGxldCBkZXRhaWwgPSB7fTtcbiAgICAgICAgdGhpcy5kZXRhaWwgPSB0aGlzLmZvcm1hdERldGFpbChkZXRhaWwpO1xuICAgICAgICB0aGlzLnNlYXJjaExpc3QoKTtcbiAgICB9XG4gICAgXG4gICAgLyogVGhpcyBpcyBmb3IgZWRpdG9yIHJlbGF0ZWQgKi9cbiAgICBwcm90ZWN0ZWQgdGV4dEVkaXRvcnM6YW55OyAvL3R5cGUgb2YgUXVlcnlMaXN0PFQ+XG4gICAgcHJvdGVjdGVkIHRleHRFZGl0b3JNYXA6YW55ID0ge307XG4gICAgXG4gICAgcHJvdGVjdGVkIGV4dHJhRmllbGRzVW5sb2FkKCkgey8vZnJvbSBzZXJ2ZXJcbiAgICAgICAgaWYgKHRoaXMudGV4dEVkaXRvcnMpIHtcbiAgICAgICAgICAgIHRoaXMudGV4dEVkaXRvcnMuZm9yRWFjaChlZGl0b3I9PntcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgZmllbGROYW1lID0gZWRpdG9yLm5hbWU7XG4gICAgICAgICAgICAgICAgbGV0IHZhbGlkYXRvck9iaiA9IHRoaXMudGV4dEVkaXRvck1hcFtmaWVsZE5hbWVdO1xuICAgICAgICAgICAgICAgIGlmICghdmFsaWRhdG9yT2JqKSByZXR1cm47XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSB0aGlzLmRldGFpbFt2YWxpZGF0b3JPYmouZmllbGROYW1lXVxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50KSBlZGl0b3Iuc2V0Q29udGVudChjb250ZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgICAgICBcbiAgICBwcm90ZWN0ZWQgZXh0cmFGaWVsZHNMb2FkKCkgey8vdG8gc2VydmVyXG4gICAgICAgIGxldCByZXN1bHQgPSB0cnVlO1xuICAgICAgICBpZiAodGhpcy50ZXh0RWRpdG9ycykge1xuICAgICAgICAgICAgbGV0IGFycmF5ID0gdGhpcy50ZXh0RWRpdG9ycy50b0FycmF5KCk7XG4gICAgICAgICAgICBmb3IgKGxldCBlZGl0b3Igb2YgYXJyYXkpIHtcbiAgICAgICAgICAgICAgICBsZXQgZmllbGROYW1lID0gZWRpdG9yLm5hbWU7XG4gICAgICAgICAgICAgICAgbGV0IFtjb250ZW50LHRleHRdID0gZWRpdG9yLmdldENvbnRlbnQoKTtcbiAgICAgICAgICAgICAgICBsZXQgdmFsaWRhdG9yT2JqID0gdGhpcy50ZXh0RWRpdG9yTWFwW2ZpZWxkTmFtZV07XG4gICAgICAgICAgICAgICAgaWYgKCF2YWxpZGF0b3JPYmopIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBmaWVsZFN0YXRlID0gdmFsaWRhdG9yT2JqLmZpZWxkU3RhdGU7XG4gICAgICAgICAgICAgICAgZmllbGRTdGF0ZS5lcnJvcnMgPSB7fTtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbGlkYXRvck9iai5yZXF1aXJlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS5lcnJvcnMucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS52YWxpZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgnbWlubGVuZ3RoJyBpbiB2YWxpZGF0b3JPYmogJiYgdGV4dC5sZW5ndGggPCB2YWxpZGF0b3JPYmoubWlubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUudmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRTdGF0ZS5lcnJvcnMubWlubGVuZ3RoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoJ21heGxlbmd0aCcgaW4gdmFsaWRhdG9yT2JqICYmIHRleHQubGVuZ3RoID4gdmFsaWRhdG9yT2JqLm1heGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLnZhbGlkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUuZXJyb3JzLm1heGxlbmd0aCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCd2YWxpZGF0b3JzJyBpbiB2YWxpZGF0b3JPYmopIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVycm9yID0gdmFsaWRhdG9yT2JqWyd2YWxpZGF0b3JzJ10udmFsaWRhdGVWYWx1ZSh0ZXh0KVxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUudmFsaWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkU3RhdGUuZXJyb3JzID0gZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9ICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBmaWVsZFN0YXRlLmVycm9ycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFpbFt2YWxpZGF0b3JPYmouZmllbGROYW1lXSA9IGNvbnRlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgb25FZHRpb3JQcmV2aWV3KGVkaXRvck5hbWU6c3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLnRleHRFZGl0b3JzKVxuICAgICAgICAgICAgdGhpcy50ZXh0RWRpdG9ycy5mb3JFYWNoKCAoZWRpdG9yKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGVkaXRvci5uYW1lID09IGVkaXRvck5hbWUpIGVkaXRvci5wcmV2aWV3KCk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLypQYXJlbnQgcm91dGVyIHJlbGF0ZWQqL1xuICAgIHByb3RlY3RlZCBnZXRQYXJlbnRSb3V0ZUl0ZW0oKTpzdHJpbmcge1xuICAgICAgICBsZXQgcm91dGVTbmFwc2hvdCA9IHRoaXMucm91dGUuc25hcHNob3Q7XG4gICAgICAgIGxldCBwYXJlbnRJdGVtO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICAgIGlmIChyb3V0ZVNuYXBzaG90LmRhdGEgJiYgcm91dGVTbmFwc2hvdC5kYXRhLm1yYUxldmVsID09IDEgKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50SXRlbSA9IHJvdXRlU25hcHNob3QuZGF0YS5pdGVtO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIHJvdXRlU25hcHNob3QgPSByb3V0ZVNuYXBzaG90LnBhcmVudDtcbiAgICAgICAgfSB3aGlsZSAocm91dGVTbmFwc2hvdClcbiAgICAgICAgcmV0dXJuIHBhcmVudEl0ZW07XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldFBhcmVudFJvdXRlSXRlbUlkKCk6c3RyaW5nIHtcbiAgICAgICAgbGV0IHJvdXRlU25hcHNob3QgPSB0aGlzLnJvdXRlLnNuYXBzaG90O1xuICAgICAgICBsZXQgcGFyZW50SXRlbUlkO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICAgIGlmIChyb3V0ZVNuYXBzaG90LmRhdGEgJiYgcm91dGVTbmFwc2hvdC5kYXRhLm1yYUxldmVsID09IDEgJiYgKCdpZCcgaW4gcm91dGVTbmFwc2hvdC5wYXJhbXMpKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50SXRlbUlkID0gcm91dGVTbmFwc2hvdC5wYXJhbXMuaWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcm91dGVTbmFwc2hvdCA9IHJvdXRlU25hcHNob3QucGFyZW50O1xuICAgICAgICB9IHdoaWxlIChyb3V0ZVNuYXBzaG90KVxuICAgICAgICByZXR1cm4gcGFyZW50SXRlbUlkO1xuICAgIH1cbiAgICAgICAgXG4gICAgcHJvdGVjdGVkIGdldFBhcmVudFJvdXRlUmVmRmllbGQoKTpzdHJpbmcge1xuICAgICAgICBsZXQgbXAgPSB0aGlzLnJlZmVyZW5jZUZpZWxkc01hcDtcbiAgICAgICAgZm9yIChsZXQgcHJvcCBpbiBtcCkge1xuICAgICAgICAgICAgaWYgKG1wLmhhc093blByb3BlcnR5KHByb3ApICYmIG1wW3Byb3BdID09IHRoaXMucGFyZW50SXRlbSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGdldFBhcmVudEFjdGl2YXRlZFJvdXRlcigpOkFjdGl2YXRlZFJvdXRlIHtcbiAgICAgICAgbGV0IHJvdXRlID0gdGhpcy5yb3V0ZTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgbGV0IGRhdGEgPSByb3V0ZS5zbmFwc2hvdC5kYXRhO1xuICAgICAgICAgICAgLy9hbGwgcm91dGUgaW5zaWRlIHRoZSBtcmEgc3lzdGVtIHdpbGwgaGF2ZSBtcmFMZXZlbCBkYXRhIGl0ZW1cbiAgICAgICAgICAgIGlmICghZGF0YS5tcmFMZXZlbCkgcmV0dXJuIHJvdXRlO1xuICAgICAgICAgICAgcm91dGUgPSByb3V0ZS5wYXJlbnQ7XG4gICAgICAgIH0gd2hpbGUgKHJvdXRlKVxuICAgICAgICByZXR1cm4gdGhpcy5yb3V0ZS5yb290O1xuICAgIH1cbiAgICBcbiAgICAvKlN1YiBkZXRhaWwgc2hvdyBmbGFnKi9cbiAgICBwdWJsaWMgdG9nZ2xlQ2hlY2tlZEl0ZW0oaTpudW1iZXIpOnZvaWQge1xuICAgICAgICB0aGlzLmNoZWNrZWRJdGVtW2ldID0gIXRoaXMuY2hlY2tlZEl0ZW1baV07XG4gICAgfVxuXG4gICAgLyoqKiBBbnkgVmlldyAtIGFkZCBuZXcgY29tcG9uZW50IGluIHRoZSBjdXJyZW50IHZpZXcqL1xuICAgIHByb3RlY3RlZCBpc0FkZGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHB1YmxpYyBvbkFkZCgpIHtcbiAgICAgICAgdGhpcy5pc0FkZGluZyA9IHRydWU7XG4gICAgfVxuICAgIHB1YmxpYyB0b2dnbGVBZGQoKSB7XG4gICAgICAgIHRoaXMuaXNBZGRpbmcgPSAhdGhpcy5pc0FkZGluZztcbiAgICB9XG4gICAgcHVibGljIG9uQWRkRG9uZShyZXN1bHQ6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5pc0FkZGluZyA9IGZhbHNlO1xuICAgICAgICBpZiAocmVzdWx0KSB7IC8vYWRkIHN1Y2Nlc3NmdWwuIFJlLXBvcHVsYXRlIHRoZSBjdXJyZW50IGxpc3RcbiAgICAgICAgICBpZiAodGhpcy52aWV3ID09IFZpZXdUeXBlLkxJU1QpIHtcbiAgICAgICAgICAgIHRoaXMucG9wdWxhdGVMaXN0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgOyAvL2RvIG5vdGhpbmdcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvKkRhdGUgUmFuZ2UgU2VsZWN0aW9uICovXG4gICAgaG92ZXJlZERhdGU6IGFueTtcblxuICAgIG9uRGF0ZVNlbGVjdGlvblRvZ2dsZShmbjpzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5kZXRhaWxbZm5dWydwb3AnXSA9ICF0aGlzLmRldGFpbFtmbl1bJ3BvcCddO1xuICAgIH1cbiAgICBcbiAgICBvbkRhdGVTZWxlY3Rpb24oZm46c3RyaW5nLCBkYXRlOiBhbnkpIHtcbiAgICAgICAgaWYgKCF0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSAmJiAhdGhpcy5kZXRhaWxbZm5dWyd0byddKSB7XG4gICAgICAgICAgdGhpcy5kZXRhaWxbZm5dWydmcm9tJ10gPSBkYXRlO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZGV0YWlsW2ZuXVsnZnJvbSddICYmICF0aGlzLmRldGFpbFtmbl1bJ3RvJ10gJiYgZGF0ZS5hZnRlcih0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSkpIHtcbiAgICAgICAgICB0aGlzLmRldGFpbFtmbl1bJ3RvJ10gPSBkYXRlO1xuICAgICAgICAgIHRoaXMuZGV0YWlsW2ZuXVsncG9wJ10gPSBmYWxzZTsgLy9GaW5pc2hlZC4gaGlkZSB0aGUgc2VsZWN0aW9uIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuZGV0YWlsW2ZuXVsndG8nXSA9IG51bGw7XG4gICAgICAgICAgdGhpcy5kZXRhaWxbZm5dWydmcm9tJ10gPSBkYXRlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaXNIb3ZlcmVkKGZuOnN0cmluZywgZGF0ZTogYW55KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSAmJiAhdGhpcy5kZXRhaWxbZm5dWyd0byddICYmIHRoaXMuaG92ZXJlZERhdGUgJiYgZGF0ZS5hZnRlcih0aGlzLmRldGFpbFtmbl1bJ2Zyb20nXSkgJiYgZGF0ZS5iZWZvcmUodGhpcy5ob3ZlcmVkRGF0ZSk7XG4gICAgfVxuXG4gICAgaXNJbnNpZGUoZm46c3RyaW5nLCBkYXRlOiBhbnkpIHtcbiAgICAgICAgcmV0dXJuIGRhdGUuYWZ0ZXIodGhpcy5kZXRhaWxbZm5dWydmcm9tJ10pICYmIGRhdGUuYmVmb3JlKHRoaXMuZGV0YWlsW2ZuXVsndG8nXSk7XG4gICAgfVxuXG4gICAgaXNSYW5nZShmbjpzdHJpbmcsIGRhdGU6IGFueSkge1xuICAgICAgICByZXR1cm4gZGF0ZS5lcXVhbHModGhpcy5kZXRhaWxbZm5dWydmcm9tJ10pIHx8IGRhdGUuZXF1YWxzKHRoaXMuZGV0YWlsW2ZuXVsndG8nXSkgfHwgdGhpcy5pc0luc2lkZShmbiwgZGF0ZSkgfHwgdGhpcy5pc0hvdmVyZWQoZm4sIGRhdGUpO1xuICAgIH1cbn1cbiJdfQ==